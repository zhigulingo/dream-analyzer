const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UserInfoCard-DG_iFpR2.js","assets/main-Zfg8tELx.js","assets/main-DEbn0YGh.css","assets/Badge.vue_vue_type_script_setup_true_lang-D3e0qTQM.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/UserInfoCard-CB4eSPSP.css","assets/FactsCarouselV2-DyQkLNBe.js","assets/autoplay-DAyidg3Z.js","assets/autoplay-DV8PrLMj.css","assets/FactsCarouselV2-CTr97Abs.css","assets/DeepAnalysisCard-v7pp2ppq.js","assets/DeepAnalysisCard-CZFhRVlD.css","assets/AnalysisHistoryList-BcNpvTXD.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/AnalysisHistoryList-DHZM3cWy.css","assets/SubscriptionModal-BrfEGPp6.js","assets/SubscriptionModal-bhIIoXcB.css"])))=>i.map(i=>d[i]);
import{d as I,c as f,a as d,o as s,n as P,b as o,e as p,f as T,t as g,r as E,u as F,g as M,h as U,i as H,j as G,k as L,l as J,m as q,p as K,w as Q,q as n,s as C,v as k,_ as S,x as W}from"./main-Zfg8tELx.js";import{_ as B}from"./_plugin-vue_export-helper-DlAUqK2U.js";const X=I({__name:"LoadingSpinner",props:{size:{default:"md"},variant:{default:"primary"},label:{default:""},overlay:{type:Boolean,default:!1},centered:{type:Boolean,default:!1}},setup(v){const a=v,w={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},l={primary:"border-[#5461FF] border-t-transparent",secondary:"border-gray-400 border-t-transparent",white:"border-white border-t-transparent",dark:"border-gray-800 border-t-transparent"},m={xs:"text-xs",sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl"},y=f(()=>{const t=[];return a.overlay&&t.push("loading-overlay"),a.centered?t.push("flex flex-col items-center justify-center"):t.push("inline-flex flex-col items-center"),t.join(" ")}),r=f(()=>[w[a.size],"animate-spin rounded-full border-2",l[a.variant]].join(" ")),_=f(()=>({animationDuration:"1s"})),i=f(()=>{const t=[m[a.size],"mt-2"];return a.variant==="white"?t.push("text-white"):a.variant==="dark"?t.push("text-gray-800"):t.push("text-gray-600"),t.join(" ")});return(t,c)=>(s(),d("div",{class:P(["loading-spinner-container",y.value])},[o("div",{class:P(["loading-spinner",r.value]),style:T(_.value)},[...c[0]||(c[0]=[o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1)])],6),v.label?(s(),d("div",{key:0,class:P(["loading-label",i.value])},g(v.label),3)):p("",!0)],2))}}),Y=B(X,[["__scopeId","data-v-5b2d591a"]]),Z={class:"error-boundary"},ee={key:1,class:"error-fallback"},re={class:"error-container"},te={class:"error-message"},oe={class:"error-actions"},ne=["disabled"],se={key:0,class:"error-details"},ae={__name:"ErrorBoundary",props:{fallbackComponent:{type:String,default:null},onError:{type:Function,default:null},onRetry:{type:Function,default:null},showRetry:{type:Boolean,default:!0},showReportError:{type:Boolean,default:!0},maxRetries:{type:Number,default:3}},emits:["error","retry","recovery"],setup(v,{expose:a,emit:w}){const l=v,m=w,y=E(!1),r=E(null),_=E(null),i=E(!1),t=E(0),c=F(),A=f(()=>!1),b=f(()=>{if(!r.value)return"Произошла ошибка";const e=r.value.message||"";return e.includes("Network")||e.includes("fetch")?"Проблемы с сетью":e.includes("timeout")?"Превышено время ожидания":e.includes("Authentication")?"Ошибка авторизации":e.includes("Permission")||e.includes("Forbidden")?"Нет доступа":"Произошла ошибка"}),R=f(()=>{if(!r.value)return"Что-то пошло не так";const e=r.value.message||"";return e.includes("Network Error")||e.includes("failed to fetch")?"Проверьте подключение к интернету и попробуйте снова.":e.includes("timeout")?"Сервер не отвечает. Попробуйте позже или проверьте соединение.":e.includes("Authentication failed")?"Сессия истекла. Необходимо войти заново.":e.includes("Permission denied")||e.includes("403")?"У вас нет прав для выполнения этого действия.":e.includes("404")?"Запрашиваемый ресурс не найден.":e.includes("500")?"Ошибка сервера. Мы работаем над её устранением.":"Произошла непредвиденная ошибка. Мы работаем над её устранением."}),N=f(()=>r.value?JSON.stringify({message:r.value.message,stack:r.value.stack,name:r.value.name,cause:r.value.cause,info:_.value,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href},null,2):"");M((e,u,h)=>(console.error("ErrorBoundary caught error:",e,h),x(e,h),l.onError&&l.onError(e,h),m("error",{error:e,info:h}),!1)),U(()=>(window.addEventListener("unhandledrejection",D),window.addEventListener("error",O),()=>{window.removeEventListener("unhandledrejection",D),window.removeEventListener("error",O)}));const x=(e,u=null)=>{y.value=!0,r.value=e,_.value=u},D=e=>{console.error("Unhandled promise rejection:",e.reason),x(new Error(e.reason||"Unhandled promise rejection"))},O=e=>{console.error("Global error:",e.error),x(e.error||new Error(e.message))},$=async()=>{if(t.value>=l.maxRetries){c.error(`Превышено максимальное количество попыток (${l.maxRetries})`);return}i.value=!0,t.value++;try{l.onRetry&&await l.onRetry(),j(),m("retry",{attempt:t.value}),c.success("Операция выполнена успешно")}catch(e){console.error("Retry failed:",e),x(e),c.error("Повторная попытка не удалась")}finally{i.value=!1}},V=()=>{window.location.reload()},z=()=>{var u,h;const e={message:((u=r.value)==null?void 0:u.message)||"Unknown error",stack:((h=r.value)==null?void 0:h.stack)||"No stack trace",url:window.location.href,timestamp:new Date().toISOString(),userAgent:navigator.userAgent};console.log("Error report:",e),navigator.clipboard&&navigator.clipboard.writeText(JSON.stringify(e,null,2)).then(()=>{c.info("Информация об ошибке скопирована в буфер обмена")}).catch(()=>{c.warning("Не удалось скопировать информацию об ошибке")})},j=()=>{y.value=!1,r.value=null,_.value=null,t.value=0,m("recovery")};return a({clearError:j,setError:x,hasError:()=>y.value}),(e,u)=>(s(),d("div",Z,[y.value?(s(),d("div",ee,[o("div",re,[u[1]||(u[1]=G('<div class="error-icon" data-v-7ff4fa27><svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-7ff4fa27><circle cx="12" cy="12" r="10" data-v-7ff4fa27></circle><line x1="12" y1="8" x2="12" y2="12" data-v-7ff4fa27></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-7ff4fa27></line></svg></div>',1)),o("h3",null,g(b.value),1),o("p",te,g(R.value),1),o("div",oe,[v.showRetry?(s(),d("button",{key:0,onClick:$,disabled:i.value,class:"retry-button"},[i.value?(s(),L(Y,{key:0,size:"xs",variant:"white",class:"mr-2"})):p("",!0),J(" "+g(i.value?"Повторная попытка...":"Попробовать снова"),1)],8,ne)):p("",!0),o("button",{onClick:V,class:"reload-button"}," Перезагрузить страницу "),v.showReportError?(s(),d("button",{key:1,onClick:z,class:"report-button"}," Сообщить об ошибке ")):p("",!0)]),A.value?(s(),d("details",se,[u[0]||(u[0]=o("summary",null,"Детали ошибки (для разработчиков)",-1)),o("pre",null,g(N.value),1)])):p("",!0)])])):H(e.$slots,"default",{key:0},void 0,!0)]))}},le=B(ae,[["__scopeId","data-v-7ff4fa27"]]),ie={key:0,class:"offline-banner"},ce={key:0,class:"pending-count"},ue={class:"flex flex-col gap-6 px-4 sm:px-6 md:px-8 pb-safe-area items-center"},de={class:"account-block w-full max-w-72r"},fe={class:"account-block w-full max-w-72r mb-0"},pe={key:0,class:"account-block w-full max-w-72r"},ve={class:"account-block w-full max-w-72r"},ye=I({__name:"PersonalAccount",setup(v){const a=k(()=>S(()=>import("./UserInfoCard-DG_iFpR2.js"),__vite__mapDeps([0,1,2,3,4,5]))),w=k(()=>S(()=>import("./FactsCarouselV2-DyQkLNBe.js"),__vite__mapDeps([6,7,1,2,8,3,4,9]))),l=k(()=>S(()=>import("./DeepAnalysisCard-v7pp2ppq.js"),__vite__mapDeps([10,1,2,4,11]))),m=k(()=>S(()=>import("./AnalysisHistoryList-BcNpvTXD.js"),__vite__mapDeps([12,1,2,13,4,14]))),y=k(()=>S(()=>import("./SubscriptionModal-BrfEGPp6.js"),__vite__mapDeps([15,1,2,4,16]))),r=q(),{isOnline:_,pendingOperations:i}=K(),t=f(()=>r.history&&r.history.length>=5),c=b=>{console.error("PersonalAccount error caught by ErrorBoundary:",b),W.handleError(b.error,{component:"PersonalAccount",context:"error_boundary"})},A=async()=>{console.log("PersonalAccount retry triggered"),r.errorProfile&&!r.isLoadingProfile&&await r.retryFetchProfile(),r.errorHistory&&!r.isLoadingHistory&&await r.retryFetchHistory()};return(b,R)=>(s(),L(le,{onRetry:A,onError:c,"show-retry":!0},{default:Q(()=>[n(_)?p("",!0):(s(),d("div",ie,[R[0]||(R[0]=o("span",null,"⚠️ Нет подключения к интернету",-1)),n(i).length>0?(s(),d("span",ce," ("+g(n(i).length)+" операций в очереди) ",1)):p("",!0)])),o("main",ue,[o("section",de,[C(n(a),{"user-store":n(r)},null,8,["user-store"])]),o("section",fe,[C(n(w))]),t.value?(s(),d("section",pe,[C(n(l),{"user-store":n(r)},null,8,["user-store"])])):p("",!0),o("section",ve,[C(n(m),{"user-store":n(r)},null,8,["user-store"])]),n(r).showSubscriptionModal?(s(),L(n(y),{key:1,onClose:n(r).closeSubscriptionModal},null,8,["onClose"])):p("",!0)])]),_:1}))}}),me=B(ye,[["__scopeId","data-v-8c3fe412"]]),ge=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"}));export{Y as L,ge as P};
