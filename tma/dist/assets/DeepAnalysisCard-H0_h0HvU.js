import{d as _,r as d,E as k,a as u,o as c,b as n,e as h,s as E,t as b,C as P,n as A}from"./main-B-UfWtUm.js";import{L as T}from"./PersonalAccount-BVFSN11Z.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";const H={class:"px-8 md:px-16 py-2"},B={key:0,class:"mt-4"},N={key:1,class:"mt-4 p-4 bg-red-500/20 rounded-lg text-sm"},V={key:2,class:"mt-4 p-4 bg-green-500/20 rounded-lg text-sm"},z=_({__name:"DeepAnalysisCard",props:["userStore"],setup(i){const a=i,l=d(!1),p=d(0),m=d(0),f=d([{title:"Сбор данных",description:"Получение последних 5 снов",duration:"2-3 сек"},{title:"Анализ паттернов",description:"Поиск повторяющихся тем",duration:"8-12 сек"},{title:"Глубокая интерпретация",description:"Психологический анализ",duration:"10-15 сек"},{title:"Формирование отчета",description:"Создание персонального анализа",duration:"3-5 сек"}]);k(()=>{var e;return(e=a.userStore)==null?void 0:e.isDoingDeepAnalysis},e=>{e?(p.value=0,m.value=0,x()):setTimeout(()=>{p.value=0,m.value=0,f.value.forEach(t=>t.status="pending")},2e3)});const x=()=>{const e=(t,r)=>{m.value=t,p.value=r,f.value.forEach((s,o)=>{o<t?s.status="completed":o===t?s.status="loading":s.status="pending"})};setTimeout(()=>e(0,15),500),setTimeout(()=>e(1,35),2e3),setTimeout(()=>e(2,65),5e3),setTimeout(()=>e(3,90),12e3)},C=()=>{l.value=!l.value,window.triggerHaptic&&window.triggerHaptic("light")},D=()=>{var e,t,r,s,o;(e=a.userStore)!=null&&e.canAttemptDeepAnalysis&&(window.triggerHaptic&&window.triggerHaptic("medium"),(((r=(t=a.userStore)==null?void 0:t.profile)==null?void 0:r.deep_analysis_credits)||0)>0||(((o=(s=a.userStore)==null?void 0:s.profile)==null?void 0:o.free_deep_analysis)||0)>0?a.userStore.performDeepAnalysis():a.userStore.initiateDeepAnalysisPayment())};return(e,t)=>{var r,s,o,g,y,v,S,w;return c(),u("article",{class:A(["relative rounded-xl bg-gradient-to-br from-[#9C41FF] to-[#C03AFF] text-white overflow-hidden transition-all cursor-pointer py-6",[l.value?"pb-20":"min-h-[8rem]"]]),onClick:C},[n("div",H,[t[0]||(t[0]=n("h3",{class:"text-xl font-bold"},"Глубокий Анализ",-1)),t[1]||(t[1]=n("p",{class:"mt-1"},"Получите комплексный анализ ваших последних 5 снов.",-1)),(r=i.userStore)!=null&&r.isInitiatingDeepPayment?(c(),u("div",B,[E(T,{size:"xs",variant:"white",label:"Создаем счёт..."})])):h("",!0),(s=i.userStore)!=null&&s.deepAnalysisError?(c(),u("div",N," ⚠️ "+b(i.userStore.deepAnalysisError),1)):(o=i.userStore)!=null&&o.deepAnalysisSuccess?(c(),u("div",V," ✅ Глубокий анализ готов! Результат доступен во вкладке «Глубокий анализ» ниже. ")):h("",!0)]),n("div",{class:A(["absolute left-4 right-4 transition-all duration-300",l.value&&((g=i.userStore)!=null&&g.canAttemptDeepAnalysis)?"bottom-4 opacity-100":"-bottom-24 opacity-0 pointer-events-none"])},[n("button",{class:"w-full bg-white/20 hover:bg-white/30 text-white rounded-xl py-3 font-semibold transition-colors",onClick:P(D,["stop"])},b((((v=(y=i.userStore)==null?void 0:y.profile)==null?void 0:v.deep_analysis_credits)||0)>0||(((w=(S=i.userStore)==null?void 0:S.profile)==null?void 0:w.free_deep_analysis)||0)>0?"Выполнить анализ":"Получить анализ (1 ⭐️)"),1)],2)],2)}}}),M=F(z,[["__scopeId","data-v-7680d6f0"]]);export{M as default};
