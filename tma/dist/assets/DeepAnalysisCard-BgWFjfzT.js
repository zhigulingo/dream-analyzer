import{d as $,c as b,a as o,o as r,n as c,e as d,b as l,t as p,f as E,F as B,y as z,k as M,r as k,C as H,q as F,A as L}from"./main-CYTcTttl.js";import{L as T}from"./PersonalAccount-_MkTNyg2.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DebugInfo-hsmMo6oD.js";const V={key:0,class:"progress-header"},I={key:0,class:"progress-label"},N={key:1,class:"progress-percentage"},q={key:0,class:"progress-shimmer"},O={key:1,class:"progress-steps"},G={class:"step-indicator"},J={key:1,class:"step-check"},K={key:2,class:"step-number"},Q={class:"step-content"},R={class:"step-title"},U={key:0,class:"step-description"},W={key:1,class:"step-duration"},X={key:3,class:"progress-details"},Y={class:"detail-key"},Z={class:"detail-value"},x=$({__name:"ProgressBar",props:{progress:{default:0},label:{},variant:{default:"primary"},size:{default:"md"},animated:{type:Boolean,default:!0},showPercentage:{type:Boolean,default:!1},steps:{},currentStep:{default:0},statusMessage:{},statusType:{default:"info"},details:{},showDetails:{type:Boolean,default:!1},rounded:{type:Boolean,default:!0}},setup(u){const s=u,g=b(()=>{const e=["progress-wrapper"];return s.size&&e.push(`progress-${s.size}`),e.join(" ")}),f=b(()=>{const e=["progress-track-base"];return s.rounded&&e.push("rounded-full"),e.join(" ")}),h=b(()=>{const e=["progress-fill-base"];switch(s.rounded&&e.push("rounded-full"),s.variant){case"success":e.push("bg-green-500");break;case"warning":e.push("bg-yellow-500");break;case"error":e.push("bg-red-500");break;default:e.push("bg-[#5461FF]")}return e.join(" ")}),m=b(()=>{const e=["status-base"];switch(s.statusType){case"success":e.push("text-green-600");break;case"warning":e.push("text-yellow-600");break;case"error":e.push("text-red-600");break;default:e.push("text-gray-600")}return e.join(" ")}),v=e=>{var i,t;return s.steps?((i=s.steps[e])==null?void 0:i.status)==="loading"||s.currentStep===e&&((t=s.steps[e])==null?void 0:t.status)!=="completed":!1},y=e=>{var i;return s.steps?((i=s.steps[e])==null?void 0:i.status)==="completed"||e<s.currentStep:!1},w=e=>{var t,a;const i=["step-base"];return y(e)?i.push("step-completed"):v(e)?i.push("step-loading"):((a=(t=s.steps)==null?void 0:t[e])==null?void 0:a.status)==="error"?i.push("step-error"):i.push("step-pending"),i.join(" ")},n=e=>s.variant==="primary"?"primary":s.variant;return(e,i)=>(r(),o("div",{class:c(["progress-container",g.value])},[e.label||e.showPercentage?(r(),o("div",V,[e.label?(r(),o("div",I,p(e.label),1)):d("",!0),e.showPercentage?(r(),o("div",N,p(Math.round(e.progress))+"%",1)):d("",!0)])):d("",!0),l("div",{class:c(["progress-track",f.value])},[l("div",{class:c(["progress-fill",h.value]),style:E({width:`${e.progress}%`})},[e.animated?(r(),o("div",q)):d("",!0)],6)],2),e.steps&&e.steps.length?(r(),o("div",O,[(r(!0),o(B,null,z(e.steps,(t,a)=>(r(),o("div",{key:a,class:c(["progress-step",w(a)])},[l("div",G,[v(a)?(r(),M(T,{key:0,size:"xs",variant:n()},null,8,["variant"])):y(a)?(r(),o("div",J,"✓")):(r(),o("div",K,p(a+1),1))]),l("div",Q,[l("div",R,p(t.title),1),t.description?(r(),o("div",U,p(t.description),1)):d("",!0),t.duration&&v(a)?(r(),o("div",W," ~"+p(t.duration),1)):d("",!0)])],2))),128))])):d("",!0),e.statusMessage?(r(),o("div",{key:2,class:c(["progress-status",m.value])},p(e.statusMessage),3)):d("",!0),e.details&&e.showDetails?(r(),o("div",X,[(r(!0),o(B,null,z(e.details,(t,a)=>(r(),o("div",{key:a,class:"detail-item"},[l("span",Y,p(a)+":",1),l("span",Z,p(t),1)]))),128))])):d("",!0)],2))}}),ee=j(x,[["__scopeId","data-v-1915e01c"]]),se={class:"px-8 md:px-16 py-2"},te={key:0,class:"mt-4"},re={key:1,class:"mt-4"},ae={key:2,class:"mt-4 p-4 bg-red-500/20 rounded-lg text-sm"},oe={key:3,class:"mt-4 p-4 bg-green-500/20 rounded-lg text-sm"},ie=$({__name:"DeepAnalysisCard",props:["userStore"],setup(u){const s=u,g=k(!1),f=k(0),h=k(0),m=k([{title:"Сбор данных",description:"Получение последних 5 снов",duration:"2-3 сек"},{title:"Анализ паттернов",description:"Поиск повторяющихся тем",duration:"8-12 сек"},{title:"Глубокая интерпретация",description:"Психологический анализ",duration:"10-15 сек"},{title:"Формирование отчета",description:"Создание персонального анализа",duration:"3-5 сек"}]);H(()=>{var n;return(n=s.userStore)==null?void 0:n.isDoingDeepAnalysis},n=>{n?(f.value=0,h.value=0,v()):setTimeout(()=>{f.value=0,h.value=0,m.value.forEach(e=>e.status="pending")},2e3)});const v=()=>{const n=(e,i)=>{h.value=e,f.value=i,m.value.forEach((t,a)=>{a<e?t.status="completed":a===e?t.status="loading":t.status="pending"})};setTimeout(()=>n(0,15),500),setTimeout(()=>n(1,35),2e3),setTimeout(()=>n(2,65),5e3),setTimeout(()=>n(3,90),12e3)},y=()=>{g.value=!g.value,window.triggerHaptic&&window.triggerHaptic("light")},w=()=>{var n,e,i,t,a;(n=s.userStore)!=null&&n.canAttemptDeepAnalysis&&(window.triggerHaptic&&window.triggerHaptic("medium"),(((i=(e=s.userStore)==null?void 0:e.profile)==null?void 0:i.deep_analysis_credits)||0)>0||(((a=(t=s.userStore)==null?void 0:t.profile)==null?void 0:a.free_deep_analysis)||0)>0?s.userStore.performDeepAnalysis():s.userStore.initiateDeepAnalysisPayment())};return(n,e)=>{var i,t,a,S,_,A,C,D,P;return r(),o("article",{class:c(["relative rounded-xl bg-gradient-to-br from-[#9C41FF] to-[#C03AFF] text-white overflow-hidden transition-all cursor-pointer py-6",[g.value?"pb-20":"min-h-[8rem]"]]),onClick:y},[l("div",se,[e[0]||(e[0]=l("h3",{class:"text-xl font-bold"},"Глубокий Анализ",-1)),e[1]||(e[1]=l("p",{class:"mt-1"},"Получите комплексный анализ ваших последних 5 снов.",-1)),(i=u.userStore)!=null&&i.isInitiatingDeepPayment?(r(),o("div",te,[F(T,{size:"xs",variant:"white",label:"Создаем счёт..."})])):(t=u.userStore)!=null&&t.isDoingDeepAnalysis?(r(),o("div",re,[F(ee,{progress:f.value,label:"Глубокий анализ",steps:m.value,currentStep:h.value,variant:"white",size:"sm",showPercentage:"",animated:""},null,8,["progress","steps","currentStep"])])):d("",!0),(a=u.userStore)!=null&&a.deepAnalysisError?(r(),o("div",ae," ⚠️ "+p(u.userStore.deepAnalysisError),1)):(S=u.userStore)!=null&&S.deepAnalysisSuccess?(r(),o("div",oe," ✅ Глубокий анализ выполнен! Результат доступен во вкладке «Глубокий анализ» ниже. ")):d("",!0)]),l("div",{class:c(["absolute left-4 right-4 transition-all duration-300",g.value&&((_=u.userStore)!=null&&_.canAttemptDeepAnalysis)?"bottom-4 opacity-100":"-bottom-24 opacity-0 pointer-events-none"])},[l("button",{class:"w-full bg-white/20 hover:bg-white/30 text-white rounded-xl py-3 font-semibold transition-colors",onClick:L(w,["stop"])},p((((C=(A=u.userStore)==null?void 0:A.profile)==null?void 0:C.deep_analysis_credits)||0)>0||(((P=(D=u.userStore)==null?void 0:D.profile)==null?void 0:P.free_deep_analysis)||0)>0?"Выполнить анализ":"Получить анализ (1 ⭐️)"),1)],2)],2)}}}),pe=j(ie,[["__scopeId","data-v-d702295e"]]);export{pe as default};
