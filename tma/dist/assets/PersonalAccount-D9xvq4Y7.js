const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/UserInfoCard-BrTXRg-V.js","assets/main-CIDuWhmO.js","assets/main-CrgkVGmt.css","assets/Badge.vue_vue_type_script_setup_true_lang-ahR0hA8K.js","assets/_plugin-vue_export-helper-DlAUqK2U.js","assets/DebugInfo-BtseWVU0.js","assets/DebugInfo-86DFTwsY.css","assets/UserInfoCard-CgbiYcXA.css","assets/FactsCarouselV2-BTpJf7AS.js","assets/autoplay-Cs2pPDPQ.js","assets/autoplay-DV8PrLMj.css","assets/FactsCarouselV2-CTr97Abs.css","assets/DeepAnalysisCard-CE48iaap.js","assets/DeepAnalysisCard-CZFhRVlD.css","assets/AnalysisHistoryList-CJfJUjoz.js","assets/_commonjsHelpers-Cpj98o6Y.js","assets/SubscriptionModal-GE3SasYs.js","assets/SubscriptionModal-bhIIoXcB.css"])))=>i.map(i=>d[i]);
import{d as j,c as f,a as d,o as s,n as P,b as o,e as p,f as T,t as g,r as E,u as F,g as M,h as U,i as H,j as G,k as D,l as J,m as q,p as K,w as Q,q as k,s as n,v as S,_ as R,x as W}from"./main-CIDuWhmO.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import X from"./DebugInfo-BtseWVU0.js";const Y=j({__name:"LoadingSpinner",props:{size:{default:"md"},variant:{default:"primary"},label:{default:""},overlay:{type:Boolean,default:!1},centered:{type:Boolean,default:!1}},setup(h){const a=h,w={xs:"w-3 h-3",sm:"w-4 h-4",md:"w-6 h-6",lg:"w-8 h-8",xl:"w-12 h-12"},l={primary:"border-[#5461FF] border-t-transparent",secondary:"border-gray-400 border-t-transparent",white:"border-white border-t-transparent",dark:"border-gray-800 border-t-transparent"},y={xs:"text-xs",sm:"text-sm",md:"text-base",lg:"text-lg",xl:"text-xl"},v=f(()=>{const t=[];return a.overlay&&t.push("loading-overlay"),a.centered?t.push("flex flex-col items-center justify-center"):t.push("inline-flex flex-col items-center"),t.join(" ")}),r=f(()=>[w[a.size],"animate-spin rounded-full border-2",l[a.variant]].join(" ")),m=f(()=>({animationDuration:"1s"})),i=f(()=>{const t=[y[a.size],"mt-2"];return a.variant==="white"?t.push("text-white"):a.variant==="dark"?t.push("text-gray-800"):t.push("text-gray-600"),t.join(" ")});return(t,c)=>(s(),d("div",{class:P(["loading-spinner-container",v.value])},[o("div",{class:P(["loading-spinner",r.value]),style:T(m.value)},c[0]||(c[0]=[o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1),o("div",{class:"spinner-ring"},null,-1)]),6),t.label?(s(),d("div",{key:0,class:P(["loading-label",i.value])},g(t.label),3)):p("",!0)],2))}}),Z=L(Y,[["__scopeId","data-v-5b2d591a"]]),ee={class:"error-boundary"},re={key:1,class:"error-fallback"},te={class:"error-container"},oe={class:"error-message"},ne={class:"error-actions"},se=["disabled"],ae={key:0,class:"error-details"},le={__name:"ErrorBoundary",props:{fallbackComponent:{type:String,default:null},onError:{type:Function,default:null},onRetry:{type:Function,default:null},showRetry:{type:Boolean,default:!0},showReportError:{type:Boolean,default:!0},maxRetries:{type:Number,default:3}},emits:["error","retry","recovery"],setup(h,{expose:a,emit:w}){const l=h,y=w,v=E(!1),r=E(null),m=E(null),i=E(!1),t=E(0),c=F(),A=f(()=>!1),b=f(()=>{if(!r.value)return"Произошла ошибка";const e=r.value.message||"";return e.includes("Network")||e.includes("fetch")?"Проблемы с сетью":e.includes("timeout")?"Превышено время ожидания":e.includes("Authentication")?"Ошибка авторизации":e.includes("Permission")||e.includes("Forbidden")?"Нет доступа":"Произошла ошибка"}),C=f(()=>{if(!r.value)return"Что-то пошло не так";const e=r.value.message||"";return e.includes("Network Error")||e.includes("failed to fetch")?"Проверьте подключение к интернету и попробуйте снова.":e.includes("timeout")?"Сервер не отвечает. Попробуйте позже или проверьте соединение.":e.includes("Authentication failed")?"Сессия истекла. Необходимо войти заново.":e.includes("Permission denied")||e.includes("403")?"У вас нет прав для выполнения этого действия.":e.includes("404")?"Запрашиваемый ресурс не найден.":e.includes("500")?"Ошибка сервера. Мы работаем над её устранением.":"Произошла непредвиденная ошибка. Мы работаем над её устранением."}),N=f(()=>r.value?JSON.stringify({message:r.value.message,stack:r.value.stack,name:r.value.name,cause:r.value.cause,info:m.value,timestamp:new Date().toISOString(),userAgent:navigator.userAgent,url:window.location.href},null,2):"");M((e,u,_)=>(console.error("ErrorBoundary caught error:",e,_),x(e,_),l.onError&&l.onError(e,_),y("error",{error:e,info:_}),!1)),U(()=>(window.addEventListener("unhandledrejection",B),window.addEventListener("error",O),()=>{window.removeEventListener("unhandledrejection",B),window.removeEventListener("error",O)}));const x=(e,u=null)=>{v.value=!0,r.value=e,m.value=u},B=e=>{console.error("Unhandled promise rejection:",e.reason),x(new Error(e.reason||"Unhandled promise rejection"))},O=e=>{console.error("Global error:",e.error),x(e.error||new Error(e.message))},$=async()=>{if(t.value>=l.maxRetries){c.error(`Превышено максимальное количество попыток (${l.maxRetries})`);return}i.value=!0,t.value++;try{l.onRetry&&await l.onRetry(),I(),y("retry",{attempt:t.value}),c.success("Операция выполнена успешно")}catch(e){console.error("Retry failed:",e),x(e),c.error("Повторная попытка не удалась")}finally{i.value=!1}},V=()=>{window.location.reload()},z=()=>{var u,_;const e={message:((u=r.value)==null?void 0:u.message)||"Unknown error",stack:((_=r.value)==null?void 0:_.stack)||"No stack trace",url:window.location.href,timestamp:new Date().toISOString(),userAgent:navigator.userAgent};console.log("Error report:",e),navigator.clipboard&&navigator.clipboard.writeText(JSON.stringify(e,null,2)).then(()=>{c.info("Информация об ошибке скопирована в буфер обмена")}).catch(()=>{c.warning("Не удалось скопировать информацию об ошибке")})},I=()=>{v.value=!1,r.value=null,m.value=null,t.value=0,y("recovery")};return a({clearError:I,setError:x,hasError:()=>v.value}),(e,u)=>(s(),d("div",ee,[v.value?(s(),d("div",re,[o("div",te,[u[1]||(u[1]=G('<div class="error-icon" data-v-7ff4fa27><svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" data-v-7ff4fa27><circle cx="12" cy="12" r="10" data-v-7ff4fa27></circle><line x1="12" y1="8" x2="12" y2="12" data-v-7ff4fa27></line><line x1="12" y1="16" x2="12.01" y2="16" data-v-7ff4fa27></line></svg></div>',1)),o("h3",null,g(b.value),1),o("p",oe,g(C.value),1),o("div",ne,[h.showRetry?(s(),d("button",{key:0,onClick:$,disabled:i.value,class:"retry-button"},[i.value?(s(),D(Z,{key:0,size:"xs",variant:"white",class:"mr-2"})):p("",!0),J(" "+g(i.value?"Повторная попытка...":"Попробовать снова"),1)],8,se)):p("",!0),o("button",{onClick:V,class:"reload-button"}," Перезагрузить страницу "),h.showReportError?(s(),d("button",{key:1,onClick:z,class:"report-button"}," Сообщить об ошибке ")):p("",!0)]),A.value?(s(),d("details",ae,[u[0]||(u[0]=o("summary",null,"Детали ошибки (для разработчиков)",-1)),o("pre",null,g(N.value),1)])):p("",!0)])])):H(e.$slots,"default",{key:0},void 0,!0)]))}},ie=L(le,[["__scopeId","data-v-7ff4fa27"]]),ce={key:0,class:"offline-banner"},ue={key:0,class:"pending-count"},de={class:"flex flex-col gap-6 px-4 sm:px-6 md:px-8 pb-safe-area items-center"},fe={class:"account-block w-full max-w-72r"},pe={class:"account-block w-full max-w-72r mb-0"},ve={key:0,class:"account-block w-full max-w-72r"},ye={class:"account-block w-full max-w-72r"},me=j({__name:"PersonalAccount",setup(h){const a=S(()=>R(()=>import("./UserInfoCard-BrTXRg-V.js"),__vite__mapDeps([0,1,2,3,4,5,6,7]))),w=S(()=>R(()=>import("./FactsCarouselV2-BTpJf7AS.js"),__vite__mapDeps([8,9,1,2,10,3,4,11]))),l=S(()=>R(()=>import("./DeepAnalysisCard-CE48iaap.js"),__vite__mapDeps([12,1,2,4,5,6,13]))),y=S(()=>R(()=>import("./AnalysisHistoryList-CJfJUjoz.js"),__vite__mapDeps([14,1,2,15]))),v=S(()=>R(()=>import("./SubscriptionModal-GE3SasYs.js"),__vite__mapDeps([16,1,2,4,17]))),r=q(),{isOnline:m,pendingOperations:i}=K(),t=f(()=>r.history&&r.history.length>=5),c=b=>{console.error("PersonalAccount error caught by ErrorBoundary:",b),W.handleError(b.error,{component:"PersonalAccount",context:"error_boundary"})},A=async()=>{console.log("PersonalAccount retry triggered"),r.errorProfile&&!r.isLoadingProfile&&await r.retryFetchProfile(),r.errorHistory&&!r.isLoadingHistory&&await r.retryFetchHistory()};return(b,C)=>(s(),D(ie,{onRetry:A,onError:c,"show-retry":!0},{default:Q(()=>[k(X),n(m)?p("",!0):(s(),d("div",ce,[C[0]||(C[0]=o("span",null,"⚠️ Нет подключения к интернету",-1)),n(i).length>0?(s(),d("span",ue," ("+g(n(i).length)+" операций в очереди) ",1)):p("",!0)])),o("main",de,[o("section",fe,[k(n(a),{"user-store":n(r)},null,8,["user-store"])]),o("section",pe,[k(n(w))]),t.value?(s(),d("section",ve,[k(n(l),{"user-store":n(r)},null,8,["user-store"])])):p("",!0),o("section",ye,[k(n(y),{"user-store":n(r)},null,8,["user-store"])]),n(r).showSubscriptionModal?(s(),D(n(v),{key:1,onClose:n(r).closeSubscriptionModal},null,8,["onClose"])):p("",!0)])]),_:1}))}}),_e=L(me,[["__scopeId","data-v-be2df33e"]]),be=Object.freeze(Object.defineProperty({__proto__:null,default:_e},Symbol.toStringTag,{value:"Module"}));export{Z as L,be as P};
