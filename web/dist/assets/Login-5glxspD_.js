import{_ as w,r as i,c as d,o as u,a as s,b,w as p,v as c,t as y,d as _}from"./main-BNTqaH8O.js";const L={class:"login-container card"},h={class:"form-group"},I={class:"form-group"},k=["disabled"],T={key:0,class:"error-message"},D={__name:"Login",emits:["login-success"],setup(S,{emit:g}){const m=g,a=i(""),n=i(""),r=i(!1),t=i(null),f=async()=>{if(r.value=!0,t.value=null,!a.value||!n.value){t.value="Please enter both Telegram ID and password.",r.value=!1;return}try{const o="https://sparkling-cupcake-940504.netlify.app/.netlify/functions/web-login",e=await fetch(o,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({tg_id:parseInt(a.value,10),password:n.value})});if(!e.ok){const v=await e.json();throw new Error(v.error||"Login failed.")}if(!(await e.json()).success)throw new Error("Login failed.");console.log("Login successful, tokens set in httpOnly cookies."),m("login-success")}catch(o){console.error("Login error:",o),t.value=o.message}finally{r.value=!1}};return(o,e)=>(u(),d("div",L,[e[5]||(e[5]=s("h2",null,"Web Login",-1)),s("form",{onSubmit:_(f,["prevent"])},[s("div",h,[e[2]||(e[2]=s("label",{for:"telegramId"},"Telegram ID:",-1)),p(s("input",{type:"number",id:"telegramId","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l),required:""},null,512),[[c,a.value]])]),s("div",I,[e[3]||(e[3]=s("label",{for:"password"},"Password:",-1)),p(s("input",{type:"password",id:"password","onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),required:""},null,512),[[c,n.value]])]),s("button",{type:"submit",disabled:r.value},"Login",8,k),t.value?(u(),d("div",T,y(t.value),1)):b("",!0),e[4]||(e[4]=s("p",{class:"hint"},"Set your password using the /setpassword command in the Telegram bot.",-1))],32)]))}},N=w(D,[["__scopeId","data-v-314b6329"]]);export{N as default};
