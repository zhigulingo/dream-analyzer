import{d as ze,r as ie,c as b,a as o,o as r,b as s,s as Oe,M as bt,w as wt,e as N,t as j,F as X,A as ne,n as fe,m as kt,u as $t,N as Mt,C as ce,k as Be,q as Ye,l as we,D as Qe,z as Pe,f as Xe,O as St,P as Dt,h as Tt,E as Ct,G as jt,j as Ot}from"./main-LLgDMSqc.js";import{g as Fe,c as He}from"./_commonjsHelpers-Cpj98o6Y.js";import{_ as Ie}from"./_plugin-vue_export-helper-DlAUqK2U.js";var et={exports:{}};(function(V,q){(function(a,P){V.exports=P()})(He,function(){var a=1e3,P=6e4,J=36e5,G="millisecond",C="second",Y="minute",_="hour",F="day",E="week",I="month",$="quarter",W="year",g="date",f="Invalid Date",O=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,A=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,l={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var v=["th","st","nd","rd"],d=T%100;return"["+T+(v[(d-20)%10]||v[d]||v[0])+"]"}},y=function(T,v,d){var p=String(T);return!p||p.length>=v?T:""+Array(v+1-p.length).join(d)+T},w={s:y,z:function(T){var v=-T.utcOffset(),d=Math.abs(v),p=Math.floor(d/60),m=d%60;return(v<=0?"+":"-")+y(p,2,"0")+":"+y(m,2,"0")},m:function T(v,d){if(v.date()<d.date())return-T(d,v);var p=12*(d.year()-v.year())+(d.month()-v.month()),m=v.clone().add(p,I),B=d-m<0,z=v.clone().add(p+(B?-1:1),I);return+(-(p+(d-m)/(B?m-z:z-m))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:I,y:W,w:E,d:F,D:g,h:_,m:Y,s:C,ms:G,Q:$}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},x="en",c={};c[x]=l;var h="$isDayjsObject",M=function(T){return T instanceof ve||!(!T||!T[h])},L=function T(v,d,p){var m;if(!v)return x;if(typeof v=="string"){var B=v.toLowerCase();c[B]&&(m=B),d&&(c[B]=d,m=B);var z=v.split("-");if(!m&&z.length>1)return T(z[0])}else{var R=v.name;c[R]=v,m=R}return!p&&m&&(x=m),m||!p&&x},U=function(T,v){if(M(T))return T.clone();var d=typeof v=="object"?v:{};return d.date=T,d.args=arguments,new ve(d)},S=w;S.l=L,S.i=M,S.w=function(T,v){return U(T,{locale:v.$L,utc:v.$u,x:v.$x,$offset:v.$offset})};var ve=function(){function T(d){this.$L=L(d.locale,null,!0),this.parse(d),this.$x=this.$x||d.x||{},this[h]=!0}var v=T.prototype;return v.parse=function(d){this.$d=function(p){var m=p.date,B=p.utc;if(m===null)return new Date(NaN);if(S.u(m))return new Date;if(m instanceof Date)return new Date(m);if(typeof m=="string"&&!/Z$/i.test(m)){var z=m.match(O);if(z){var R=z[2]-1||0,K=(z[7]||"0").substring(0,3);return B?new Date(Date.UTC(z[1],R,z[3]||1,z[4]||0,z[5]||0,z[6]||0,K)):new Date(z[1],R,z[3]||1,z[4]||0,z[5]||0,z[6]||0,K)}}return new Date(m)}(d),this.init()},v.init=function(){var d=this.$d;this.$y=d.getFullYear(),this.$M=d.getMonth(),this.$D=d.getDate(),this.$W=d.getDay(),this.$H=d.getHours(),this.$m=d.getMinutes(),this.$s=d.getSeconds(),this.$ms=d.getMilliseconds()},v.$utils=function(){return S},v.isValid=function(){return this.$d.toString()!==f},v.isSame=function(d,p){var m=U(d);return this.startOf(p)<=m&&m<=this.endOf(p)},v.isAfter=function(d,p){return U(d)<this.startOf(p)},v.isBefore=function(d,p){return this.endOf(p)<U(d)},v.$g=function(d,p,m){return S.u(d)?this[p]:this.set(m,d)},v.unix=function(){return Math.floor(this.valueOf()/1e3)},v.valueOf=function(){return this.$d.getTime()},v.startOf=function(d,p){var m=this,B=!!S.u(p)||p,z=S.p(d),R=function(ye,re){var he=S.w(m.$u?Date.UTC(m.$y,re,ye):new Date(m.$y,re,ye),m);return B?he:he.endOf(F)},K=function(ye,re){return S.w(m.toDate()[ye].apply(m.toDate("s"),(B?[0,0,0,0]:[23,59,59,999]).slice(re)),m)},se=this.$W,te=this.$M,oe=this.$D,ue="set"+(this.$u?"UTC":"");switch(z){case W:return B?R(1,0):R(31,11);case I:return B?R(1,te):R(0,te+1);case E:var de=this.$locale().weekStart||0,be=(se<de?se+7:se)-de;return R(B?oe-be:oe+(6-be),te);case F:case g:return K(ue+"Hours",0);case _:return K(ue+"Minutes",1);case Y:return K(ue+"Seconds",2);case C:return K(ue+"Milliseconds",3);default:return this.clone()}},v.endOf=function(d){return this.startOf(d,!1)},v.$set=function(d,p){var m,B=S.p(d),z="set"+(this.$u?"UTC":""),R=(m={},m[F]=z+"Date",m[g]=z+"Date",m[I]=z+"Month",m[W]=z+"FullYear",m[_]=z+"Hours",m[Y]=z+"Minutes",m[C]=z+"Seconds",m[G]=z+"Milliseconds",m)[B],K=B===F?this.$D+(p-this.$W):p;if(B===I||B===W){var se=this.clone().set(g,1);se.$d[R](K),se.init(),this.$d=se.set(g,Math.min(this.$D,se.daysInMonth())).$d}else R&&this.$d[R](K);return this.init(),this},v.set=function(d,p){return this.clone().$set(d,p)},v.get=function(d){return this[S.p(d)]()},v.add=function(d,p){var m,B=this;d=Number(d);var z=S.p(p),R=function(te){var oe=U(B);return S.w(oe.date(oe.date()+Math.round(te*d)),B)};if(z===I)return this.set(I,this.$M+d);if(z===W)return this.set(W,this.$y+d);if(z===F)return R(1);if(z===E)return R(7);var K=(m={},m[Y]=P,m[_]=J,m[C]=a,m)[z]||1,se=this.$d.getTime()+d*K;return S.w(se,this)},v.subtract=function(d,p){return this.add(-1*d,p)},v.format=function(d){var p=this,m=this.$locale();if(!this.isValid())return m.invalidDate||f;var B=d||"YYYY-MM-DDTHH:mm:ssZ",z=S.z(this),R=this.$H,K=this.$m,se=this.$M,te=m.weekdays,oe=m.months,ue=m.meridiem,de=function(re,he,ke,ge){return re&&(re[he]||re(p,B))||ke[he].slice(0,ge)},be=function(re){return S.s(R%12||12,re,"0")},ye=ue||function(re,he,ke){var ge=re<12?"AM":"PM";return ke?ge.toLowerCase():ge};return B.replace(A,function(re,he){return he||function(ke){switch(ke){case"YY":return String(p.$y).slice(-2);case"YYYY":return S.s(p.$y,4,"0");case"M":return se+1;case"MM":return S.s(se+1,2,"0");case"MMM":return de(m.monthsShort,se,oe,3);case"MMMM":return de(oe,se);case"D":return p.$D;case"DD":return S.s(p.$D,2,"0");case"d":return String(p.$W);case"dd":return de(m.weekdaysMin,p.$W,te,2);case"ddd":return de(m.weekdaysShort,p.$W,te,3);case"dddd":return te[p.$W];case"H":return String(R);case"HH":return S.s(R,2,"0");case"h":return be(1);case"hh":return be(2);case"a":return ye(R,K,!0);case"A":return ye(R,K,!1);case"m":return String(K);case"mm":return S.s(K,2,"0");case"s":return String(p.$s);case"ss":return S.s(p.$s,2,"0");case"SSS":return S.s(p.$ms,3,"0");case"Z":return z}return null}(re)||z.replace(":","")})},v.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},v.diff=function(d,p,m){var B,z=this,R=S.p(p),K=U(d),se=(K.utcOffset()-this.utcOffset())*P,te=this-K,oe=function(){return S.m(z,K)};switch(R){case W:B=oe()/12;break;case I:B=oe();break;case $:B=oe()/3;break;case E:B=(te-se)/6048e5;break;case F:B=(te-se)/864e5;break;case _:B=te/J;break;case Y:B=te/P;break;case C:B=te/a;break;default:B=te}return m?B:S.a(B)},v.daysInMonth=function(){return this.endOf(I).$D},v.$locale=function(){return c[this.$L]},v.locale=function(d,p){if(!d)return this.$L;var m=this.clone(),B=L(d,p,!0);return B&&(m.$L=B),m},v.clone=function(){return S.w(this.$d,this)},v.toDate=function(){return new Date(this.valueOf())},v.toJSON=function(){return this.isValid()?this.toISOString():null},v.toISOString=function(){return this.$d.toISOString()},v.toString=function(){return this.$d.toUTCString()},T}(),_e=ve.prototype;return U.prototype=_e,[["$ms",G],["$s",C],["$m",Y],["$H",_],["$W",F],["$M",I],["$y",W],["$D",g]].forEach(function(T){_e[T[1]]=function(v){return this.$g(v,T[0],T[1])}}),U.extend=function(T,v){return T.$i||(T(v,ve,U),T.$i=!0),U},U.locale=L,U.isDayjs=M,U.unix=function(T){return U(1e3*T)},U.en=c[x],U.Ls=c,U.p={},U})})(et);var tt=et.exports;const ae=Fe(tt);var st={exports:{}};(function(V,q){(function(a,P){V.exports=P()})(He,function(){return function(a,P,J){a=a||{};var G=P.prototype,C={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function Y(F,E,I,$){return G.fromToBase(F,E,I,$)}J.en.relativeTime=C,G.fromToBase=function(F,E,I,$,W){for(var g,f,O,A=I.$locale().relativeTime||C,l=a.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],y=l.length,w=0;w<y;w+=1){var x=l[w];x.d&&(g=$?J(F).diff(I,x.d,!0):I.diff(F,x.d,!0));var c=(a.rounding||Math.round)(Math.abs(g));if(O=g>0,c<=x.r||!x.r){c<=1&&w>0&&(x=l[w-1]);var h=A[x.l];W&&(c=W(""+c)),f=typeof h=="string"?h.replace("%d",c):h(c,E,x.l,O);break}}if(E)return f;var M=O?A.future:A.past;return typeof M=="function"?M(f):M.replace("%s",f)},G.to=function(F,E){return Y(F,E,this,!0)},G.from=function(F,E){return Y(F,E,this)};var _=function(F){return F.$u?J.utc():J()};G.toNow=function(F){return this.to(_(this),F)},G.fromNow=function(F){return this.from(_(this),F)}}})})(st);var Ht=st.exports;const At=Fe(Ht);var nt={exports:{}};(function(V,q){(function(a,P){V.exports=P()})(He,function(){var a="minute",P=/[+-]\d\d(?::?\d\d)?/g,J=/([+-]|\d\d)/g;return function(G,C,Y){var _=C.prototype;Y.utc=function(f){var O={date:f,utc:!0,args:arguments};return new C(O)},_.utc=function(f){var O=Y(this.toDate(),{locale:this.$L,utc:!0});return f?O.add(this.utcOffset(),a):O},_.local=function(){return Y(this.toDate(),{locale:this.$L,utc:!1})};var F=_.parse;_.parse=function(f){f.utc&&(this.$u=!0),this.$utils().u(f.$offset)||(this.$offset=f.$offset),F.call(this,f)};var E=_.init;_.init=function(){if(this.$u){var f=this.$d;this.$y=f.getUTCFullYear(),this.$M=f.getUTCMonth(),this.$D=f.getUTCDate(),this.$W=f.getUTCDay(),this.$H=f.getUTCHours(),this.$m=f.getUTCMinutes(),this.$s=f.getUTCSeconds(),this.$ms=f.getUTCMilliseconds()}else E.call(this)};var I=_.utcOffset;_.utcOffset=function(f,O){var A=this.$utils().u;if(A(f))return this.$u?0:A(this.$offset)?I.call(this):this.$offset;if(typeof f=="string"&&(f=function(x){x===void 0&&(x="");var c=x.match(P);if(!c)return null;var h=(""+c[0]).match(J)||["-",0,0],M=h[0],L=60*+h[1]+ +h[2];return L===0?0:M==="+"?L:-L}(f),f===null))return this;var l=Math.abs(f)<=16?60*f:f;if(l===0)return this.utc(O);var y=this.clone();if(O)return y.$offset=l,y.$u=!1,y;var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();return(y=this.local().add(l+w,a)).$offset=l,y.$x.$localOffset=w,y};var $=_.format;_.format=function(f){var O=f||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return $.call(this,O)},_.valueOf=function(){var f=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*f},_.isUTC=function(){return!!this.$u},_.toISOString=function(){return this.toDate().toISOString()},_.toString=function(){return this.toDate().toUTCString()};var W=_.toDate;_.toDate=function(f){return f==="s"&&this.$offset?Y(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():W.call(this)};var g=_.diff;_.diff=function(f,O,A){if(f&&this.$u===f.$u)return g.call(this,f,O,A);var l=this.local(),y=Y(f).local();return g.call(l,y,O,A)}}})})(nt);var Lt=nt.exports;const it=Fe(Lt);var rt={exports:{}};(function(V,q){(function(a,P){V.exports=P()})(He,function(){var a={year:0,month:1,day:2,hour:3,minute:4,second:5},P={};return function(J,G,C){var Y,_=function($,W,g){g===void 0&&(g={});var f=new Date($),O=function(A,l){l===void 0&&(l={});var y=l.timeZoneName||"short",w=A+"|"+y,x=P[w];return x||(x=new Intl.DateTimeFormat("en-US",{hour12:!1,timeZone:A,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",timeZoneName:y}),P[w]=x),x}(W,g);return O.formatToParts(f)},F=function($,W){for(var g=_($,W),f=[],O=0;O<g.length;O+=1){var A=g[O],l=A.type,y=A.value,w=a[l];w>=0&&(f[w]=parseInt(y,10))}var x=f[3],c=x===24?0:x,h=f[0]+"-"+f[1]+"-"+f[2]+" "+c+":"+f[4]+":"+f[5]+":000",M=+$;return(C.utc(h).valueOf()-(M-=M%1e3))/6e4},E=G.prototype;E.tz=function($,W){$===void 0&&($=Y);var g,f=this.utcOffset(),O=this.toDate(),A=O.toLocaleString("en-US",{timeZone:$}),l=Math.round((O-new Date(A))/1e3/60),y=15*-Math.round(O.getTimezoneOffset()/15)-l;if(!Number(y))g=this.utcOffset(0,W);else if(g=C(A,{locale:this.$L}).$set("millisecond",this.$ms).utcOffset(y,!0),W){var w=g.utcOffset();g=g.add(f-w,"minute")}return g.$x.$timezone=$,g},E.offsetName=function($){var W=this.$x.$timezone||C.tz.guess(),g=_(this.valueOf(),W,{timeZoneName:$}).find(function(f){return f.type.toLowerCase()==="timezonename"});return g&&g.value};var I=E.startOf;E.startOf=function($,W){if(!this.$x||!this.$x.$timezone)return I.call(this,$,W);var g=C(this.format("YYYY-MM-DD HH:mm:ss:SSS"),{locale:this.$L});return I.call(g,$,W).tz(this.$x.$timezone,!0)},C.tz=function($,W,g){var f=g&&W,O=g||W||Y,A=F(+C(),O);if(typeof $!="string")return C($).tz(O);var l=function(c,h,M){var L=c-60*h*1e3,U=F(L,M);if(h===U)return[L,h];var S=F(L-=60*(U-h)*1e3,M);return U===S?[L,U]:[c-60*Math.min(U,S)*1e3,Math.max(U,S)]}(C.utc($,f).valueOf(),A,O),y=l[0],w=l[1],x=C(y).utcOffset(w);return x.$x.$timezone=O,x},C.tz.guess=function(){return Intl.DateTimeFormat().resolvedOptions().timeZone},C.tz.setDefault=function($){Y=$}}})})(rt);var Yt=rt.exports;const ot=Fe(Yt);var Bt={exports:{}};(function(V,q){(function(a,P){V.exports=P(tt)})(He,function(a){function P(g){return g&&typeof g=="object"&&"default"in g?g:{default:g}}var J=P(a),G="—è–Ω–≤–∞—Ä—è_—Ñ–µ–≤—Ä–∞–ª—è_–º–∞—Ä—Ç–∞_–∞–ø—Ä–µ–ª—è_–º–∞—è_–∏—é–Ω—è_–∏—é–ª—è_–∞–≤–≥—É—Å—Ç–∞_—Å–µ–Ω—Ç—è–±—Ä—è_–æ–∫—Ç—è–±—Ä—è_–Ω–æ—è–±—Ä—è_–¥–µ–∫–∞–±—Ä—è".split("_"),C="—è–Ω–≤–∞—Ä—å_—Ñ–µ–≤—Ä–∞–ª—å_–º–∞—Ä—Ç_–∞–ø—Ä–µ–ª—å_–º–∞–π_–∏—é–Ω—å_–∏—é–ª—å_–∞–≤–≥—É—Å—Ç_—Å–µ–Ω—Ç—è–±—Ä—å_–æ–∫—Ç—è–±—Ä—å_–Ω–æ—è–±—Ä—å_–¥–µ–∫–∞–±—Ä—å".split("_"),Y="—è–Ω–≤._—Ñ–µ–≤—Ä._–º–∞—Ä._–∞–ø—Ä._–º–∞—è_–∏—é–Ω—è_–∏—é–ª—è_–∞–≤–≥._—Å–µ–Ω—Ç._–æ–∫—Ç._–Ω–æ—è–±._–¥–µ–∫.".split("_"),_="—è–Ω–≤._—Ñ–µ–≤—Ä._–º–∞—Ä—Ç_–∞–ø—Ä._–º–∞–π_–∏—é–Ω—å_–∏—é–ª—å_–∞–≤–≥._—Å–µ–Ω—Ç._–æ–∫—Ç._–Ω–æ—è–±._–¥–µ–∫.".split("_"),F=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function E(g,f,O){var A,l;return O==="m"?f?"–º–∏–Ω—É—Ç–∞":"–º–∏–Ω—É—Ç—É":g+" "+(A=+g,l={mm:f?"–º–∏–Ω—É—Ç–∞_–º–∏–Ω—É—Ç—ã_–º–∏–Ω—É—Ç":"–º–∏–Ω—É—Ç—É_–º–∏–Ω—É—Ç—ã_–º–∏–Ω—É—Ç",hh:"—á–∞—Å_—á–∞—Å–∞_—á–∞—Å–æ–≤",dd:"–¥–µ–Ω—å_–¥–Ω—è_–¥–Ω–µ–π",MM:"–º–µ—Å—è—Ü_–º–µ—Å—è—Ü–∞_–º–µ—Å—è—Ü–µ–≤",yy:"–≥–æ–¥_–≥–æ–¥–∞_–ª–µ—Ç"}[O].split("_"),A%10==1&&A%100!=11?l[0]:A%10>=2&&A%10<=4&&(A%100<10||A%100>=20)?l[1]:l[2])}var I=function(g,f){return F.test(f)?G[g.month()]:C[g.month()]};I.s=C,I.f=G;var $=function(g,f){return F.test(f)?Y[g.month()]:_[g.month()]};$.s=_,$.f=Y;var W={name:"ru",weekdays:"–≤–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ_–ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫_–≤—Ç–æ—Ä–Ω–∏–∫_—Å—Ä–µ–¥–∞_—á–µ—Ç–≤–µ—Ä–≥_–ø—è—Ç–Ω–∏—Ü–∞_—Å—É–±–±–æ—Ç–∞".split("_"),weekdaysShort:"–≤—Å–∫_–ø–Ω–¥_–≤—Ç—Ä_—Å—Ä–¥_—á—Ç–≤_–ø—Ç–Ω_—Å–±—Ç".split("_"),weekdaysMin:"–≤—Å_–ø–Ω_–≤—Ç_—Å—Ä_—á—Ç_–ø—Ç_—Å–±".split("_"),months:I,monthsShort:$,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY –≥.",LLL:"D MMMM YYYY –≥., H:mm",LLLL:"dddd, D MMMM YYYY –≥., H:mm"},relativeTime:{future:"—á–µ—Ä–µ–∑ %s",past:"%s –Ω–∞–∑–∞–¥",s:"–Ω–µ—Å–∫–æ–ª—å–∫–æ —Å–µ–∫—É–Ω–¥",m:E,mm:E,h:"—á–∞—Å",hh:E,d:"–¥–µ–Ω—å",dd:E,M:"–º–µ—Å—è—Ü",MM:E,y:"–≥–æ–¥",yy:E},ordinal:function(g){return g},meridiem:function(g){return g<4?"–Ω–æ—á–∏":g<12?"—É—Ç—Ä–∞":g<17?"–¥–Ω—è":"–≤–µ—á–µ—Ä–∞"}};return J.default.locale(W,null,!0),W})})(Bt);const zt={class:"dynamics-chart-container"},Ft={class:"text-sm font-semibold mb-2 flex items-center justify-between"},It={class:"text-xs opacity-70"},Nt={class:"chart-svg-container"},Ut={class:"y-axis-labels"},Et={class:"y-label"},Wt={class:"y-label"},Pt={class:"y-label"},Rt={class:"chart-svg-wrapper"},Zt=["viewBox"],Vt=["y1","y2"],Gt=["y"],qt=["y1","y2"],Jt=["points"],Xt=["cx","cy"],Kt={key:0,class:"mt-4"},Qt={class:"dynamics-analysis"},es={class:"analysis-text"},ts={key:0,class:"insight-box"},ss={class:"insight-text"},ns={key:1,class:"mt-3 text-xs opacity-80 leading-relaxed"},is={class:"pagination-dots"},rs=["onClick"],Ce=300,je=80,De=6,os=ze({__name:"DynamicsChart",props:{dynamics:{},userAge:{},userGender:{}},setup(V){const q=V,a=ie(0),P=ie(0),J=ie(0),G=ie("slide-left"),C=b(()=>q.dynamics[a.value]||{metric:"",values:[],interpretation:""}),Y=b(()=>C.value.values||[]),_=b(()=>{if(!q.dynamics||q.dynamics.length===0)return{min:0,max:10,labels:[10,5,0]};const l=[];if(q.dynamics.forEach(c=>{Array.isArray(c.values)&&l.push(...c.values)}),l.length===0)return{min:0,max:10,labels:[10,5,0]};const y=Math.floor(Math.min(...l)),w=Math.ceil(Math.max(...l)),x=[w,Math.round((w+y)/2),y];return{min:y,max:w,labels:x}}),F=b(()=>{var c;const l=C.value.metric;if(!q.userAge||!q.userGender)return null;const w=(c={–ü–µ—Ä—Å–æ–Ω–∞–∂–∏:{"18-24":{male:6.5,female:7},"25-34":{male:6,female:6.5},"35-44":{male:5.5,female:6},"45+":{male:5,female:5.5}},–≠–º–æ—Ü–∏–∏:{"18-24":{male:6,female:7},"25-34":{male:5.5,female:6.5},"35-44":{male:5,female:6},"45+":{male:4.5,female:5.5}},–î–µ–π—Å—Ç–≤–∏—è:{"18-24":{male:7,female:6.5},"25-34":{male:6.5,female:6},"35-44":{male:6,female:5.5},"45+":{male:5.5,female:5}},–°—Ü–µ–Ω—ã:{"18-24":{male:6.5,female:6.5},"25-34":{male:6,female:6},"35-44":{male:5.5,female:5.5},"45+":{male:5,female:5}}}[l])==null?void 0:c[q.userAge];if(!w)return null;const x=w[q.userGender];return x===void 0?null:x}),E=b(()=>{const l=F.value;if(l===null)return null;const{min:y,max:w}=_.value,x=je-De*2,c=(l-y)/(w-y);return De+x-c*x}),I=b(()=>{const l=Y.value;if(l.length===0)return[];const{min:y,max:w}=_.value,x=Ce-De*2,c=je-De*2,h=l.length>1?x/(l.length-1):0;return l.map((M,L)=>{const U=(M-y)/(w-y);return{x:De+L*h,y:De+c-U*c}})}),$=b(()=>I.value.map(l=>`${l.x},${l.y}`).join(" "));function W(l){P.value=l.touches[0].clientX}function g(l){J.value=l.touches[0].clientX}function f(){const l=P.value-J.value;Math.abs(l)>50&&(l>0&&a.value<q.dynamics.length-1?(G.value="slide-left",a.value++,A()):l<0&&a.value>0&&(G.value="slide-right",a.value--,A())),P.value=0,J.value=0}function O(l){l!==a.value&&(G.value=l>a.value?"slide-left":"slide-right",a.value=l,A())}function A(){window.triggerHaptic&&window.triggerHaptic("light")}return(l,y)=>(r(),o("div",zt,[s("div",{class:"chart-wrapper",onTouchstart:W,onTouchmove:g,onTouchend:f},[Oe(bt,{name:G.value,mode:"out-in"},{default:wt(()=>[(r(),o("div",{key:a.value,class:"chart-content"},[s("div",Ft,[s("span",null,j(C.value.category||C.value.metric),1),s("span",It,j(Y.value[Y.value.length-1]),1)]),s("div",Nt,[s("div",Ut,[s("span",Et,j(_.value.labels[0]),1),s("span",Wt,j(_.value.labels[1]),1),s("span",Pt,j(_.value.labels[2]),1)]),s("div",Rt,[(r(),o("svg",{viewBox:`0 0 ${Ce} ${je}`,class:"chart-svg",preserveAspectRatio:"xMidYMid meet"},[(r(),o(X,null,ne(3,w=>s("line",{key:`grid-${w}`,x1:0,x2:Ce,y1:je/2*(w-1),y2:je/2*(w-1),stroke:"white","stroke-opacity":"0.15","stroke-width":"1"},null,8,Vt)),64)),E.value!==null?(r(),o("rect",{key:0,x:0,y:E.value-8,width:Ce,height:16,fill:"yellow",opacity:"0.15"},null,8,Gt)):N("",!0),E.value!==null?(r(),o("line",{key:1,x1:0,x2:Ce,y1:E.value,y2:E.value,stroke:"yellow","stroke-opacity":"0.6","stroke-width":"1.5","stroke-dasharray":"4,3"},null,8,qt)):N("",!0),s("polyline",{points:$.value,fill:"none",stroke:"white","stroke-width":"2.5","stroke-linejoin":"round","stroke-linecap":"round"},null,8,Jt),(r(!0),o(X,null,ne(I.value,(w,x)=>(r(),o("circle",{key:`point-${x}`,cx:w.x,cy:w.y,r:"4",fill:"white","vector-effect":"non-scaling-stroke"},null,8,Xt))),128))],8,Zt))])]),C.value.analysis?(r(),o("div",Kt,[s("div",Qt,[s("p",es,j(C.value.analysis),1),C.value.insight?(r(),o("div",ts,[y[0]||(y[0]=s("span",{class:"insight-icon"},"üí°",-1)),s("p",ss,j(C.value.insight),1)])):N("",!0)])])):C.value.interpretation?(r(),o("div",ns,j(C.value.interpretation),1)):N("",!0)]))]),_:1},8,["name"])],32),s("div",is,[(r(!0),o(X,null,ne(V.dynamics,(w,x)=>(r(),o("button",{key:`dot-${x}`,class:fe(["dot",{active:x===a.value}]),onClick:c=>O(x)},null,10,rs))),128))])]))}}),Ke=Ie(os,[["__scopeId","data-v-ac484404"]]),as=[{keys:["–≤–æ–¥–∞","–º–æ—Ä–µ","—Ä–µ–∫–∞","–≤–æ–ª–Ω–∞","–¥–æ–∂–¥","–æ–∫–µ–∞–Ω"],emoji:"üåä"},{keys:["–ª–µ—Ç","–ø–æ–ª–µ—Ç","–ø–æ–ª–µ—Ç–∞—Ç—å","–ª–µ—Ç–∞—Ç—å","–Ω–µ–±–æ","–ø—Ç–∏—Ü","—Å–∞–º–æ–ª–µ—Ç"],emoji:"üïäÔ∏è"},{keys:["–ø–æ–≥–æ–Ω","—É–±–µ–≥","–¥–æ–≥–æ–Ω","–ø—Ä–µ—Å–ª–µ–¥"],emoji:"üèÉ‚Äç‚ôÇÔ∏è"},{keys:["—ç–∫–∑–∞–º","–∫–æ–Ω—Ç—Ä–æ–ª","—Ç–µ—Å—Ç","—É—Ä–æ–∫","—à–∫–æ–ª","—É—á–µ–±","—É–Ω–∏–≤–µ—Ä"],emoji:"üìù"},{keys:["–¥–µ–Ω—å–≥","–∫–æ—à–µ–ª–µ–∫","–∫–æ—à–µ–ª—å","–∫–æ—à–µ–ª—ë–∫","–±–∞–Ω–∫","–∫—Ä–µ–¥–∏—Ç"],emoji:"üí∞"},{keys:["–ª—é–±–æ–≤","–ø–æ—Ü–µ–ª","—Ä–æ–º–∞–Ω","–ø–∞—Ä","—Å–µ—Ä–¥"],emoji:"‚ù§Ô∏è"},{keys:["–¥–æ–º","–∫–≤–∞—Ä—Ç–∏—Ä","–∫–æ–º–Ω–∞—Ç","–¥–≤–æ—Ä","–∂–∏–ª—å"],emoji:"üè†"},{keys:["—Ä–∞–±–æ—Ç","–æ—Ñ–∏—Å","–Ω–∞—á–∞–ª—å","–∫–æ–ª–ª–µ–≥"],emoji:"üíº"},{keys:["—à–∫–æ–ª","–∫–ª–∞—Å—Å","—É—Ä–æ–∫"],emoji:"üè´"},{keys:["–∫–æ—Ç","–∫–æ—à–∫–∞"],emoji:"üê±"},{keys:["—Å–æ–±–∞–∫","–ø—ë—Å","–ø–µ—Å"],emoji:"üê∂"},{keys:["–∑—É–±","–∑—É–±—ã"],emoji:"ü¶∑"},{keys:["—Ç–µ–º–Ω–æ—Ç","–Ω–æ—á","—Ç—å–º–∞"],emoji:"üåë"},{keys:["—Å–º–µ—Ä—Ç","–ø–æ—Ö–æ—Ä–æ–Ω","–∫–ª–∞–¥–±–∏—â"],emoji:"üïØÔ∏è"},{keys:["—Ä–æ–∂–¥","–º–ª–∞–¥–µ–Ω","—Ä–µ–±–µ–Ω","–º–∞–ª—ã—à","–¥–µ—Ç"],emoji:"üë∂"},{keys:["–ª–µ—Å","–¥–µ—Ä–µ–≤","–ø–∞—Ä–∫","–ø—Ä–∏—Ä–æ–¥"],emoji:"üå≤"},{keys:["–æ–≥–æ–Ω—å","–ø–æ–∂–∞—Ä","–∂–∞—Ä"],emoji:"üî•"},{keys:["–∑–º–µ","–¥—Ä–∞–∫–æ–Ω"],emoji:"üêç"},{keys:["–ø—É—Ç–µ—à–µ—Å—Ç–≤","–¥–æ—Ä–æ–≥","–ø—É—Ç—å","—Ç—Ä–æ–ø"],emoji:"üß≠"}];function ls(V){try{const q=String(V||"").toLowerCase();for(const a of as)if(a.keys.some(P=>q.includes(P)))return a.emoji;return"üí§"}catch{return"üí§"}}const cs={key:0,class:"flex items-center gap-3 py-1 min-h-[2.5rem]"},us={class:"text-2xl shrink-0"},ds={class:"flex-1 min-w-0"},fs={class:"truncate font-semibold leading-tight"},hs={class:"text-xs opacity-80 leading-tight mt-1"},ms={key:1,class:"mt-4 space-y-6 fade-seq is-open"},ps={key:0,class:"space-y-2"},vs={class:"text-3xl font-bold leading-tight"},ys={class:"text-base opacity-80"},gs={key:0,class:"flex flex-wrap gap-2 pt-2"},xs={key:0,class:"space-y-4"},_s={class:"text-white/90 space-y-5"},bs={key:0,class:"text-lg opacity-90 leading-relaxed pb-4 border-b border-white/10"},ws={class:"flex items-baseline gap-2"},ks={class:"font-bold text-xl"},$s={class:"text-xs opacity-60 bg-white/15 px-2 py-0.5 rounded-full"},Ms={class:"text-lg opacity-90 leading-relaxed"},Ss={class:"text-sm opacity-60 leading-relaxed bg-white/5 rounded-lg px-3 py-2"},Ds={key:1,class:"space-y-4"},Ts={class:"text-white/90"},Cs={key:2,class:"space-y-4"},js={class:"text-white/90 space-y-5"},Os={key:0,class:"text-lg opacity-90 leading-relaxed"},Hs={key:1,class:"text-lg opacity-90 leading-relaxed"},As={key:2,class:"text-lg opacity-90 leading-relaxed"},Ls={key:3,class:"bg-white/10 rounded-lg p-4 space-y-3 mt-5"},Ys={class:"font-bold text-xl opacity-95 flex items-center gap-2"},Bs={class:"text-lg opacity-90 leading-relaxed"},zs={key:0,class:"text-sm opacity-60 leading-relaxed"},Fs={class:"rounded-lg bg-white/10"},Is={class:"px-3 pb-3 text-white/90 leading-snug space-y-2"},Ns=["innerHTML"],Us={key:0,class:"rounded-lg bg-white/10"},Es={class:"px-3 pb-3"},Ws={class:"flex flex-wrap gap-2"},Ps={key:1,class:"rounded-lg bg-white/10"},Rs={class:"px-3 pb-3 text-white/90 leading-snug"},Zs={key:2,class:"rounded-lg bg-white/10"},Vs={class:"px-3 pb-3 text-white/90 leading-snug"},Gs={class:"list-decimal pl-5 space-y-2"},qs={key:3,class:"rounded-lg bg-white/10"},Js={class:"px-3 pb-3 text-white/90 leading-snug"},Xs={class:"list-decimal pl-5 space-y-3"},Ks={key:0},Qs={class:"font-semibold mb-1"},en={class:"opacity-90"},tn={key:0,class:"opacity-80 mt-1 italic"},sn={key:1},nn={key:0,class:"rounded-lg bg-white/10"},rn={class:"px-3 pb-3 text-white/90 leading-snug"},on={class:"list-decimal pl-5 space-y-2"},an={key:1,class:"rounded-lg bg-white/10"},ln={class:"px-3 pb-3 text-white/90 leading-snug"},cn={class:"list-decimal pl-5 space-y-3"},un={key:0},dn={class:"font-semibold mb-1"},fn={class:"opacity-90"},hn={key:0,class:"opacity-80 mt-1 italic"},mn={key:1},pn={class:"relative border-l-4 border-pink-400 pl-4 space-y-2"},vn={class:"text-white/90"},yn={class:"flex justify-end pt-1"},gn={class:"space-y-3"},xn={key:0,class:"rounded-lg bg-white/10"},_n={class:"px-4 pb-4 text-white/90 space-y-4"},bn={class:"space-y-4"},wn={class:"flex justify-between text-base leading-normal"},kn={class:"font-medium"},$n={class:"opacity-90"},Mn={class:"relative h-2 w-full bg-white/10 rounded overflow-hidden"},Sn={class:"pt-1 text-sm opacity-80 flex flex-wrap items-center gap-3"},Dn={class:"inline-flex items-center gap-2"},Tn={class:"leading-normal"},Cn={key:0,class:"rounded-lg bg-white/10"},jn={class:"text-lg font-semibold px-4 py-3"},On={class:"px-4 pb-4 text-white/90 space-y-3"},Hn=["innerHTML"],An={key:0,class:"mt-3 pt-3 border-t border-white/10"},Ln={class:"text-xl"},Yn=["innerHTML"],Bn={class:"space-y-3"},zn={key:0,class:"rounded-lg bg-white/10"},Fn={class:"text-lg font-semibold px-4 py-3"},In={class:"px-4 pb-4 text-white/90"},Nn=["innerHTML"],Un={class:"mt-4 flex gap-2"},En={key:3,class:"mt-3 text-xs bg-black/20 rounded-lg p-2 font-mono whitespace-pre-wrap break-words"},Wn={class:"mt-2 flex justify-end"},Pn={key:0,class:"space-y-3"},Rn={class:"grid grid-cols-2 gap-2"},Zn=["onClick"],Vn={class:"flex justify-end gap-2 pt-2"},Gn=["disabled"],qn={key:1,class:"space-y-3"},Jn={class:"grid grid-cols-2 gap-2"},Xn={class:"flex justify-end gap-2 pt-2"},Kn=["disabled"],Qn=48,ei=ze({__name:"DreamCard",props:{dream:{},active:{type:Boolean},overlayMode:{type:Boolean}},emits:["toggle","open"],setup(V,{emit:q}){ae.extend(At),ae.locale("ru"),ae.extend(it),ae.extend(ot);const a=V,P=q,J=ie(null),G=()=>{const e=(()=>{var t;try{return Math.round(((t=J.value)==null?void 0:t.getBoundingClientRect().top)??0)}catch{return 0}})();P("open",{y:e})},C=()=>{a.overlayMode||(G(),window.triggerHaptic&&window.triggerHaptic("light"))},Y=kt(),_=$t(),F=b(()=>{var e;return!!((e=a.dream)!=null&&e.is_deep_analysis)}),E=b(()=>ls(c.value)),I=b({get:()=>{var e,t,i;return((e=a.dream)==null?void 0:e.user_feedback)??((i=(t=a.dream)==null?void 0:t.deep_source)==null?void 0:i.user_feedback)??0},set:e=>{a.dream&&(a.dream.user_feedback=e,a.dream.deep_source||(a.dream.deep_source={}),a.dream.deep_source.user_feedback=e)}}),$={like:!1,dislike:!1,delete:!1},W=async e=>{if($.like||$.dislike)return;const t=e===1?I.value===1?0:1:I.value===2?0:2,i=I.value;I.value=t;try{window.triggerHaptic&&window.triggerHaptic("medium"),e===1?$.like=!0:$.dislike=!0,await Pe.postAnalysisFeedback(a.dream.id,t),t===0?_.info("–û—Ü–µ–Ω–∫–∞ —Å–Ω—è—Ç–∞"):t===1?_.success("–î–æ–±–∞–≤–ª–µ–Ω–æ: –Ω—Ä–∞–≤–∏—Ç—Å—è"):t===2&&_.success("–î–æ–±–∞–≤–ª–µ–Ω–æ: –Ω–µ –Ω—Ä–∞–≤–∏—Ç—Å—è")}catch(u){I.value=i,console.error("Feedback error",u),_.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –æ—Ü–µ–Ω–∫—É")}finally{$.like=$.dislike=!1}},g=()=>W(1),f=()=>W(2),O=async()=>{var i;if($.delete)return;const e=(i=window.Telegram)==null?void 0:i.WebApp;if(await new Promise(u=>{e!=null&&e.showPopup?e.showPopup({title:"–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?",message:"–î–µ–π—Å—Ç–≤–∏–µ –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ",buttons:[{id:"yes",type:"destructive",text:"–£–¥–∞–ª–∏—Ç—å"},{id:"no",type:"cancel",text:"–û—Ç–º–µ–Ω–∞"}]},D=>u(D==="yes")):u(window.confirm("–£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å?"))}))try{$.delete=!0,window.triggerHaptic&&window.triggerHaptic("heavy"),await Pe.deleteAnalysis(a.dream.id);const u=Y.history.findIndex(D=>D.id===a.dream.id);u>-1&&Y.history.splice(u,1),Y.fetchProfile(),_.success("–ó–∞–ø–∏—Å—å —É–¥–∞–ª–µ–Ω–∞")}catch(u){console.error("Delete error",u),_.error("–ù–µ —É–¥–∞–ª–æ—Å—å —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å")}finally{$.delete=!1}},A=new Set(["–∏","–≤","–≤–æ","–Ω–µ","—á—Ç–æ","–æ–Ω","–Ω–∞","—è","—Å","—Å–æ","–∫–∞–∫","–∞","—Ç–æ","–≤—Å–µ","–æ–Ω–∞","—Ç–∞–∫","–µ–≥–æ","–Ω–æ","–¥–∞","—Ç—ã","–∫","—É","–∂–µ","–≤—ã","–∑–∞","–±—ã","–ø–æ","–µ–µ","–º–Ω–µ","–±—ã–ª–æ","–≤–æ—Ç","–æ—Ç","–º–µ–Ω—è","–µ—â–µ","–Ω–µ—Ç","–æ","–∏–∑","–µ–º—É","—Ç–µ–ø–µ—Ä—å","–∫–æ–≥–¥–∞","–¥–∞–∂–µ","–Ω—É","–≤–¥—Ä—É–≥","–ª–∏","–µ—Å–ª–∏","—É–∂–µ","–∏–ª–∏","–Ω–∏","–±—ã—Ç—å","–±—ã–ª","–Ω–µ–≥–æ","–¥–æ","–≤–∞—Å","–Ω–∏–±—É–¥—å","–æ–ø—è—Ç—å","—É–∂","–≤–∞–º","–≤–µ–¥—å","—Ç–∞–º","–ø–æ—Ç–æ–º","—Å–µ–±—è","–Ω–∏—á–µ–≥–æ","–µ–π","–º–æ–∂–µ—Ç","–æ–Ω–∏","—Ç—É—Ç","–≥–¥–µ","–µ—Å—Ç—å","–Ω–∞–¥–æ","–Ω–µ–π","–¥–ª—è","–º—ã","—Ç–µ–±—è","–∏—Ö","—á–µ–º","–±—ã–ª–∞","—Å–∞–º","—á—Ç–æ–±","–±–µ–∑","–±—É–¥—Ç–æ","—á–µ–≥–æ","—Ä–∞–∑","—Ç–æ–∂–µ","—Å–µ–±–µ","–ø–æ–¥","–±—É–¥–µ—Ç","–∂","—Ç–æ–≥–¥–∞","–∫—Ç–æ","—ç—Ç–æ—Ç","—Ç–æ–≥–æ","–ø–æ—Ç–æ–º—É","—ç—Ç–æ–≥–æ","–∫–∞–∫–æ–π","—Å–æ–≤—Å–µ–º","–Ω–∏–º","–∑–¥–µ—Å—å","—ç—Ç–æ–º","–æ–¥–∏–Ω","–ø–æ—á—Ç–∏","–º–æ–π","—Ç–µ–º","—á—Ç–æ–±—ã","–Ω–µ–µ","–∫–∞–∂–µ—Ç—Å—è","—Å–µ–π—á–∞—Å","–±—ã–ª–∏","–∫—É–¥–∞","–∑–∞—á–µ–º","–≤—Å–µ—Ö","–Ω–∏–∫–æ–≥–¥–∞","–º–æ–∂–Ω–æ","–ø—Ä–∏","–Ω–∞–∫–æ–Ω–µ—Ü","–¥–≤–∞","–æ–±","–¥—Ä—É–≥–æ–π","—Ö–æ—Ç—å","–ø–æ—Å–ª–µ","–Ω–∞–¥","–±–æ–ª—å—à–µ","—Ç–æ—Ç","—á–µ—Ä–µ–∑","—ç—Ç–∏","–Ω–∞—Å","–ø—Ä–æ","–≤—Å–µ–≥–æ","–Ω–∏—Ö","–∫–∞–∫–∞—è","–º–Ω–æ–≥–æ","—Ä–∞–∑–≤–µ","—Ç—Ä–∏","—ç—Ç—É","–º–æ—è","–≤–ø—Ä–æ—á–µ–º","—Ö–æ—Ä–æ—à–æ","—Å–≤–æ—é","—ç—Ç–æ–π","–ø–µ—Ä–µ–¥","–∏–Ω–æ–≥–¥–∞","–ª—É—á—à–µ","—á—É—Ç—å","—Ç–æ–º","–Ω–µ–ª—å–∑—è","—Ç–∞–∫–æ–π","–∏–º","–±–æ–ª–µ–µ","–≤—Å–µ–≥–¥–∞","–∫–æ–Ω–µ—á–Ω–æ","–≤—Å—é","–º–µ–∂–¥—É"]);function l(e){return e.replace(/\s+/g," ").trim().split(" ").map(t=>t.charAt(0).toUpperCase()+t.slice(1)).join(" ")}function y(e){if(!e)return"";const t=String(e).split(/[.!?\n]/)[0],u=t.toLowerCase().replace(/[^\p{L}\p{N}\s-]/gu,"").split(/\s+/).filter(D=>D&&!A.has(D)&&D.length>3).slice(0,3);return u.length===0?t.slice(0,40):l(u.join(" "))}function w(e){if(!e)return"";let t=String(e).toLowerCase().replace(/["'¬´¬ª]/g,"").trim();t=t.replace(/^(–ø—Ä–∏—Å–Ω–∏–ª–æ—Å—å|—Å–Ω–∏–ª–æ—Å—å|—Å–æ–Ω –æ|—Å–æ–Ω –ø—Ä–æ|—Å–æ–Ω|–º–Ω–µ —Å–Ω–∏—Ç—Å—è|–º–Ω–µ –ø—Ä–∏—Å–Ω–∏–ª–æ—Å—å)\s+/i,""),t=t.replace(/\s+/g," ").trim();const i=t.split(" ").filter(Boolean).slice(0,3);return i.length?i.join(" "):""}function x(e){if(!e)return"";const t=String(e).toLowerCase();return t.charAt(0).toUpperCase()+t.slice(1)}const c=b(()=>{var H,n,k,Z,ee;const e=w((n=(H=a.dream)==null?void 0:H.deep_source)==null?void 0:n.title);if(e)return x(e);const t=(((Z=(k=a.dream)==null?void 0:k.deep_source)==null?void 0:Z.tags)||[]).filter(Boolean),i=me=>{var pe;let le=String(me||"").trim();return le=((pe=le.split(/[\\/,(;:‚Äî‚Äì-]/)[0])==null?void 0:pe.trim())||"",le?le.charAt(0).toUpperCase()+le.slice(1).toLowerCase():""},u=t.map(i).filter(Boolean);if(u.length){const me=u.slice(0,2).join(" –∏ ");return x(me||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")}const D=w(y((ee=a.dream)==null?void 0:ee.dream_text));return x(D||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")}),h=b(()=>{var i,u;const e=(u=(i=a.dream)==null?void 0:i.deep_source)==null?void 0:u.tags;if(!Array.isArray(e))return[];const t=D=>{var n;let H=String(D||"").trim();return H=((n=H.split(/[\\/,(;:‚Äî‚Äì-]/)[0])==null?void 0:n.trim())||"",H?H.charAt(0).toUpperCase()+H.slice(1).toLowerCase():""};return e.map(t).filter(Boolean).slice(0,5)});function M(e){return String(e||"").replace(/^```[\s\S]*?\n/,"").replace(/```$/,"").replace(/\(\s*\d+\s*\)/g,"").replace(/\s\[\s*\d+\s*\]/g,"").replace(/[\u00B9\u00B2\u00B3\u2070-\u2079]/g,"")}ie("context");const L=b(()=>{var e;return M(((e=a.dream)==null?void 0:e.analysis)||"")}),U=b(()=>{var e,t;return((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.overallContext)||{}});b(()=>{const e=U.value;return!!(e!=null&&e.narrative||e!=null&&e.psychologicalFunction||e!=null&&e.emotionalJourney)});const S=b(()=>{var e,t;return((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.symbolsIntro)||""}),ve=b(()=>{var t,i;const e=(i=(t=a.dream)==null?void 0:t.deep_source)==null?void 0:i.recurringSymbols;return Array.isArray(e)?e:[]}),_e=b(()=>ve.value.filter(e=>e.frequency>=2)),T=b(()=>_e.value.length>0),v=b(()=>{var t,i;const e=(i=(t=a.dream)==null?void 0:t.deep_source)==null?void 0:i.dynamicsContext;return Array.isArray(e)?e:[]}),d=b(()=>v.value.length>0),p=b(()=>{var e,t;return((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.conclusion)||{}}),m=b(()=>{const e=p.value;return!!(e!=null&&e.periodThemes||e!=null&&e.dreamFunctionsAnalysis||e!=null&&e.psychologicalSupport||e!=null&&e.integrationExercise)}),B=b(()=>{var t,i;const e=(i=(t=a.dream)==null?void 0:t.deep_source)==null?void 0:i.dynamics;return Array.isArray(e)&&e.length>0?e:[]});b(()=>B.value.length>0);const z=b(()=>{var t,i;const e=(i=(t=a.dream)==null?void 0:t.deep_source)==null?void 0:i.conclusions;return Array.isArray(e)&&e.length>0?e:[]});b(()=>z.value.length>0);const R=b(()=>{var n,k;const e=(k=(n=a.dream)==null?void 0:n.deep_source)==null?void 0:k.recommendations;if(Array.isArray(e)&&e.length>0&&typeof e[0]=="object")return e;if(Array.isArray(e)&&e.length>0)return e.map((Z,ee)=>({title:`–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è ${ee+1}`,description:String(Z),rationale:""}));const t=ue.value;if(t.length===0)return[];const i=[0,0,0,0];for(const Z of t)for(let ee=0;ee<4;ee++)i[ee]+=Z[ee];const u=Math.max(1,t.length);for(let Z=0;Z<4;Z++)i[Z]=Math.round(i[Z]/u);const D=[["–ü–µ—Ä—Å–æ–Ω–∞–∂–∏","–û–±—Ä–∞—Ç–∏ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –æ—Ç–Ω–æ—à–µ–Ω–∏—è –∏ —Ä–æ–ª–∏; –ø—Ä–∞–∫—Ç–∏–∫—É–π —á–µ—Å—Ç–Ω—É—é –∫–æ–º–º—É–Ω–∏–∫–∞—Ü–∏—é."],["–≠–º–æ—Ü–∏–∏","–î–æ–±–∞–≤—å –µ–∂–µ–¥–Ω–µ–≤–Ω—É—é —Ä–µ–≥—É–ª—è—Ü–∏—é —ç–º–æ—Ü–∏–π (–¥—ã—Ö–∞–Ω–∏–µ, –¥–Ω–µ–≤–Ω–∏–∫, –ø—Ä–æ–≥—É–ª–∫–∞)."],["–î–µ–π—Å—Ç–≤–∏—è","–û–ø—Ä–µ–¥–µ–ª–∏ 1 –º–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥ –Ω–∞ –Ω–µ–¥–µ–ª—é –∏ –∑–∞–≤–µ—Ä—à–∏ –µ–≥–æ."],["–°—Ü–µ–Ω—ã","–ü—Ä–æ–≤–µ—Ä—å –≥—Ä–∞–Ω–∏—Ü—ã –∏ —Ä–µ–∂–∏–º: –º–µ—Å—Ç–æ/–≤—Ä–µ–º—è, –≥–¥–µ —Ç–µ–±–µ —Å–ø–æ–∫–æ–π–Ω–µ–µ."]],H=i.map((Z,ee)=>({i:ee,v:Z})).sort((Z,ee)=>ee.v-Z.v).map(Z=>Z.i);return[{title:D[H[0]][0],description:D[H[0]][1],rationale:""},{title:D[H[1]][0],description:D[H[1]][1],rationale:""}]});b(()=>R.value.length>0);function K(e,t){var i;try{let u=e;const D=Array.from(new Set((t||[]).filter(Boolean))).sort((H,n)=>n.length-H.length);for(const H of D){const n=(i=String(H).split(/[\\/,(;:‚Äî‚Äì-]/)[0])==null?void 0:i.trim();if(!n)continue;const k=new RegExp(`(\b${n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}\b)`,"gi");u=u.replace(k,'<mark class="bg-white/20 px-1 rounded">$1</mark>')}return u.replace(/\n\n+/g,'</p><p class="mt-2">').replace(/\n/g,"<br>").replace(/^(.+)$/,"<p>$1")}catch{return e}}const se=b(()=>{var e,t;return K(L.value,((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.tags)||[])});function te(e){try{return new Date(e).getTime()||0}catch{return 0}}const oe=b(()=>(Y.history||[]).filter(e=>{var t;return!e.is_deep_analysis&&((t=e==null?void 0:e.deep_source)==null?void 0:t.hvdc)&&(e==null?void 0:e.created_at)}).sort((e,t)=>te(e.created_at)>te(t.created_at)?-1:1)),ue=b(()=>{var u;const e=te(((u=a.dream)==null?void 0:u.created_at)||""),t=oe.value.filter(D=>!F.value||(e?te(D.created_at)<=e:!0)).slice(0,5).reverse(),i=["characters","emotions","actions","settings"];return t.map(D=>i.map(H=>{var n,k;return Number(((k=(n=D.deep_source.hvdc)==null?void 0:n.distribution)==null?void 0:k[H])||0)}))}),de=b(()=>ue.value.length),be=b(()=>de.value>=2),ye=b(()=>Math.max(60,(de.value-1)*28+8));function re(e){const t=e.length,i=ye.value,u=Qn,D=t>1?(i-8)/(t-1):0,H=[];for(let k=0;k<t;k++){const Z=k*D,ee=u-Math.round(e[k]/100*u);H.push({x:Z,y:ee})}return{str:H.map(k=>`${k.x},${k.y}`).join(" "),pts:H}}b(()=>{const e=[{key:"characters",label:"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏",idx:0,opacity:.95},{key:"emotions",label:"–≠–º–æ—Ü–∏–∏",idx:1,opacity:.75},{key:"actions",label:"–î–µ–π—Å—Ç–≤–∏—è",idx:2,opacity:.55},{key:"settings",label:"–°—Ü–µ–Ω—ã",idx:3,opacity:.35}],t=[],i=ue.value;for(const u of e){const D=i.map(k=>k[u.idx]),{str:H,pts:n}=re(D);t.push({key:u.key,label:u.label,values:D,points:H,pointList:n,opacity:u.opacity})}return t});const he=b(()=>{if(!be.value)return[];if(d.value)return v.value.map(i=>({metric:i.category||i.metric,values:i.values||[],interpretation:i.analysis||i.interpretation||"",insight:i.insight||""}));const e=[{key:"characters",label:"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏",idx:0},{key:"emotions",label:"–≠–º–æ—Ü–∏–∏",idx:1},{key:"actions",label:"–î–µ–π—Å—Ç–≤–∏—è",idx:2},{key:"settings",label:"–°—Ü–µ–Ω—ã",idx:3}],t=ue.value;return e.map(i=>({metric:i.label,values:t.map(u=>u[i.idx]),interpretation:`–î–∏–Ω–∞–º–∏–∫–∞ "${i.label}" –ø–æ –ø–æ—Å–ª–µ–¥–Ω–∏–º ${de.value} —Å–Ω–∞–º`}))});function ke(e){const i=e.split(/\n+/).map(u=>u.trim()).filter(Boolean).filter(u=>/^\d+\./.test(u)).map(u=>u.replace(/^\d+\.\s*/,"")).slice(0,3);return i.length?i:e.split(/[.!?]\s+/).map(u=>u.trim()).filter(Boolean).slice(0,3)}const ge=b(()=>ke(L.value));function at(e){try{const t=String(e||"").toLowerCase(),i=$e=>$e.reduce((We,_t)=>We+(t.includes(_t)?1:0),0),u=["—Å—Ç—Ä–∞—Ö","—É–∂–∞—Å","–ø–∞–Ω–∏–∫","—Ç—Ä–µ–≤–æ–≥","—Å—Ç—ã–¥","–≥–Ω–µ–≤","–ø–ª–∞–∫","—Å–ª–µ–∑","–∫–æ—à–º–∞—Ä","—Ç–æ—Å–∫–∞","–≥—Ä—É—Å—Ç—å"],D=["—ç–∫–∑–∞–º","–≤—ã—Å—Ç—É–ø–ª","—Å–æ–±–µ—Å–µ–¥","–∑–∞—â–∏—Ç","–ø—Ä–æ–µ–∫—Ç","–ø–æ–¥–≥–æ—Ç–æ–≤","–∑–∞–≤—Ç—Ä–∞","–æ–∂–∏–¥–∞–Ω","–≤–æ–ª–Ω–µ–Ω","–ø–æ–µ–∑–¥–∫","–ø—É—Ç–µ—à–µ—Å—Ç–≤","–Ω–æ–≤","–∏–Ω—Ç–µ—Ä–≤—å—é"],H=["–≤—á–µ—Ä–∞","—Å–µ–≥–æ–¥–Ω—è","—Ä–∞–±–æ—Ç","—à–∫–æ–ª","—É–Ω–∏–≤–µ—Ä","–¥–æ–º","—É–ª–∏—Ü","–¥—Ä—É–≥","—Ä–æ–¥–∏—Ç–µ–ª","–∫–æ–ª–ª–µ–≥","–≥–æ—Ä–æ–¥"],n=i(u),k=i(D),Z=i(H);let ee=n>0?Math.min(1,n/3):0,me=k>0?Math.min(1,k/3):0,le=Z>0?Math.min(1,.5+Z/5):0;ee===0&&me===0&&le===0&&(le=.6,ee=.2,me=.2);const pe={schema:"dream_type_v1",scores:{memory:+le.toFixed(2),emotion:+ee.toFixed(2),anticipation:+me.toFixed(2)}},Q=[["memory",pe.scores.memory],["emotion",pe.scores.emotion],["anticipation",pe.scores.anticipation]];Q.sort(($e,We)=>We[1]-$e[1]);const xe=+Math.max(0,Q[0][1]-Q[1][1]).toFixed(2);return{...pe,dominant:Q[0][0],confidence:xe}}catch{return null}}const lt=b(()=>{var e,t,i;return((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.dream_type)||at((i=a.dream)==null?void 0:i.dream_text)||null});function ct(){const e=lt.value;if(!e||!e.dominant)return['<div class="space-y-2 text-lg">','<ul class="list-disc pl-5 space-y-2">','<li><span class="font-semibold">–ó–∞–º–µ—Ç—å:</span> –ö–∞–∫–∏–µ 2‚Äì3 –æ–±—Ä–∞–∑–∞ –∏–∑ —Å–Ω–∞ —Å–∞–º—ã–µ —Å–∏–ª—å–Ω—ã–µ? –ó–∞–ø–∏—à–∏ –∏—Ö –∫–æ—Ä–æ—Ç–∫–æ.</li>','<li><span class="font-semibold">–®–∞–≥:</span> –í—ã–±–µ—Ä–∏ –æ–¥–∏–Ω –º–∞–ª–µ–Ω—å–∫–∏–π —à–∞–≥ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–¥–¥–µ—Ä–∂–∏—Ç —Ç–µ–±—è –ø–æ —Ç–µ–º–µ —Å–Ω–∞.</li>',"</ul>","</div>"].join("");const t=String(e.dominant).toLowerCase();return t==="memory"?['<div class="space-y-2 text-lg">','<div class="font-semibold">üåô –°–æ–Ω-–ü–∞–º—è—Ç—å</div>','<p class="opacity-90">–ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ–¥–∞–≤–Ω–µ–≥–æ –æ–ø—ã—Ç–∞, —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å –ø—Ä–æ—à–ª—ã–º.</p>','<ul class="list-disc pl-5 space-y-2">','<li><span class="font-semibold">–û—Ç—Ä–∞–∑–∏:</span> –í—Å–ø–æ–º–Ω–∏, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 1‚Äì2 –¥–Ω—è. –ö–∞–∫–∏–µ —Å–æ–±—ã—Ç–∏—è –º–æ–≥–ª–∏ –ø–æ–ø–∞—Å—Ç—å –≤ —Å–æ–Ω?</li>','<li><span class="font-semibold">–°–æ–µ–¥–∏–Ω–∏:</span> –û—Ç–º–µ—Ç—å, –∫–∞–∫–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã —Å–Ω–∞ –ø–µ—Ä–µ–∫–ª–∏–∫–∞—é—Ç—Å—è —Å —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—å—é ‚Äî —ç—Ç–æ –∑–∞–≤–µ—Ä—à–∞–µ—Ç ¬´–∞—Ä—Ö–∏–≤–∞—Ü–∏—é¬ª –æ–ø—ã—Ç–∞.</li>',"</ul>","</div>"].join(""):t==="emotion"?['<div class="space-y-2 text-lg">','<div class="font-semibold">‚ö°Ô∏è –°–æ–Ω-–≠–º–æ—Ü–∏—è</div>','<p class="opacity-90">–ü—Ä–æ–∂–∏–≤–∞–Ω–∏–µ –∏ –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è —Å–∏–ª—å–Ω—ã—Ö —á—É–≤—Å—Ç–≤.</p>','<ul class="list-disc pl-5 space-y-2">','<li><span class="font-semibold">–ü–æ—á—É–≤—Å—Ç–≤—É–π:</span> –û–ø—Ä–µ–¥–µ–ª–∏, –∫–∞–∫–∞—è —ç–º–æ—Ü–∏—è –±—ã–ª–∞ —Å–∞–º–æ–π —Å–∏–ª—å–Ω–æ–π –≤–æ —Å–Ω–µ. –ì–¥–µ –æ–Ω–∞ —á—É–≤—Å—Ç–≤—É–µ—Ç—Å—è –≤ —Ç–µ–ª–µ —Å–µ–π—á–∞—Å?</li>','<li><span class="font-semibold">–£—Å–ª—ã—à—å:</span> –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ –≥–ª–∞–≤–Ω—ã–π –ø–µ—Ä—Å–æ–Ω–∞–∂ —Å–Ω–∞ –≥–æ–≤–æ—Ä–∏—Ç —Ç–µ–±–µ —á—Ç–æ-—Ç–æ. –ß—Ç–æ –æ–Ω —Ö–æ—á–µ—Ç, —á—Ç–æ–±—ã —Ç—ã –ø–æ–Ω—è–ª?</li>',"</ul>","</div>"].join(""):['<div class="space-y-2 text-lg">','<div class="font-semibold">üîÆ –°–æ–Ω-–ü—Ä–µ–¥–≤–æ—Å—Ö–∏—â–µ–Ω–∏–µ</div>','<p class="opacity-90">–¢—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ –±—É–¥—É—â–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π –∏ —Ä–µ–∞–∫—Ü–∏–π.</p>','<ul class="list-disc pl-5 space-y-2">','<li><span class="font-semibold">–ü—Ä–µ–¥—Å—Ç–∞–≤—å:</span> –ö–∞–∫ –±—ã —Ç—ã —Ö–æ—Ç–µ–ª –ø–æ–≤–µ—Å—Ç–∏ —Å–µ–±—è, –µ—Å–ª–∏ –±—ã —ç—Ç–æ –ø—Ä–æ–∏–∑–æ—à–ª–æ –≤ —Ä–µ–∞–ª—å–Ω–æ—Å—Ç–∏?</li>','<li><span class="font-semibold">–†–∞—Å—à–∏—Ñ—Ä—É–π:</span> –ö–∞–∫–æ–π —Å–∏–º–≤–æ–ª –∫–∞–∂–µ—Ç—Å—è –∫–ª—é—á–µ–≤—ã–º? –ß—Ç–æ –æ–Ω –º–æ–∂–µ—Ç –≥–æ–≤–æ—Ä–∏—Ç—å –æ —Ç–≤–æ–∏—Ö —Å—Ç—Ä–∞—Ö–∞—Ö –∏–ª–∏ –Ω–∞–º–µ—Ä–µ–Ω–∏—è—Ö?</li>',"</ul>","</div>"].join("")}const Ze=b(()=>{var me,le,pe;const e=M(((me=a.dream)==null?void 0:me.analysis)||"");if(!e)return[];const t={arch:{key:"arch",title:"–ê—Ä—Ö–µ—Ç–∏–ø–∏—á–µ—Å–∫–∞—è –∏—Å—Ç–æ—Ä–∏—è",text:""},func:{key:"func",title:"–í–æ–∑–º–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–Ω–∞",text:""},freud:{key:"freud",title:"–ü–æ –§—Ä–µ–π–¥—É",text:""},jung:{key:"jung",title:"–ü–æ –Æ–Ω–≥—É",text:""}},i=[],u=/\*\*([^*]+)\*\*/g;let D;for(;D=u.exec(e);)i.push({title:D[1].trim(),start:D.index,end:D.index+D[0].length});const H=((le=i[0])==null?void 0:le.start)??e.length;t.arch.text=e.slice(0,H).trim();for(let Q=0;Q<i.length;Q++){const xe=i[Q].title.toLowerCase(),$e=e.slice(i[Q].end,((pe=i[Q+1])==null?void 0:pe.start)??e.length).trim();xe.includes("–≤–æ–∑–º–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è")?t.func.text=$e:xe.includes("–ø–æ —Ñ—Ä–µ–π–¥—É")?t.freud.text=$e:xe.includes("–ø–æ —é–Ω–≥—É")&&(t.jung.text=$e)}const n=Q=>Q.replace(/\n\n+/g,'</p><p class="mt-2">').replace(/\n/g,"<br>").replace(/^(.+)$/,"<p>$1"),k=Object.values(t).map(Q=>({...Q,html:n(Q.text||"")}));k.some(Q=>Q.key==="func")||k.push({key:"func",title:"–í–æ–∑–º–æ–∂–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Å–Ω–∞",text:"",html:""});const Z=k.findIndex(Q=>Q.key==="arch");Z!==-1&&k.splice(Z+1,0,{key:"hvdc",title:"–ö–æ–Ω—Ç–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑",text:"",html:""});const ee=ct();if(ee){const Q=k.findIndex(xe=>xe.key==="func");if(Q!==-1){const xe=['<div class="mt-3 pt-2 border-t border-white/10 space-y-1">','<div class="font-semibold">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ</div>',ee,"</div>"].join("");k[Q].html=(k[Q].html||"")+xe}}return k}),Me=Mt({arch:!0,hvdc:!1,func:!1,freud:!1,jung:!1,symbols:!0,dynamics:!0,conclusion:!0,dreamText:!1,funcExercise:!1});function Ve(e){Me[e]=!Me[e]}function ut(e){const t=e.indexOf('<div class="mt-3 pt-2 border-t');return t===-1?e:e.substring(0,t)}function Ge(e){const t=e.indexOf('<div class="mt-3 pt-2 border-t');if(t===-1)return"";let i=e.substring(t,e.lastIndexOf("</div>")+6);return i=i.replace(/<div class="font-semibold">–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ<\/div>/g,""),i}const qe=b(()=>{try{return new URLSearchParams(window.location.search).get("debug")==="1"||localStorage.getItem("da_debug")==="1"}catch{return!1}});function dt(){var e,t,i,u,D;try{const H=JSON.stringify(Ne.value,null,2);(e=navigator.clipboard)==null||e.writeText(H),(t=_==null?void 0:_.success)==null||t.call(_,"–°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ")}catch{try{(D=(u=(i=window.Telegram)==null?void 0:i.WebApp)==null?void 0:u.showPopup)==null||D.call(u,{title:"Debug",message:"–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∏–∑ –±–ª–æ–∫–∞ –Ω–∏–∂–µ –≤—Ä—É—á–Ω—É—é",buttons:[{id:"ok",type:"default",text:"OK"}]})}catch{}}}function ft(e){var i;let t=String(e||"").trim();return t=((i=t.split(/[\\/,(;:‚Äî‚Äì-]/)[0])==null?void 0:i.trim())||"",t?t.charAt(0).toUpperCase()+t.slice(1).toLowerCase():""}const Ne=b(()=>{var i,u,D,H;if(!qe.value)return null;const e=a.dream||{},t=Array.isArray((i=e==null?void 0:e.deep_source)==null?void 0:i.tags)?e.deep_source.tags:[];return{id:e.id,created_at:e.created_at,is_deep_analysis:!!e.is_deep_analysis,title_raw:((u=e==null?void 0:e.deep_source)==null?void 0:u.title)||null,tags_raw:t,tags_norm:t.map(ft),dream_type:((D=e==null?void 0:e.deep_source)==null?void 0:D.dream_type)||null,hvdc_present:!!((H=e==null?void 0:e.deep_source)!=null&&H.hvdc)}}),Ue=ie(!1),Je=ie(1),ht=["0-20","20-30","30-40","40-50","50+"],Ae=ie(""),Se=ie("");function Ee(){Ue.value=!1}async function mt(){try{await Pe.setDemographics(Ae.value,Se.value);try{await Y.fetchProfile()}catch{}_.success("–ì–æ—Ç–æ–≤–æ! –î–∞–ª—å–Ω–µ–π—à–∏–µ –∞–Ω–∞–ª–∏–∑—ã –±—É–¥—É—Ç —É—á–∏—Ç—ã–≤–∞—Ç—å —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ"),Ue.value=!1}catch{_.error("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å")}}b(()=>{const e=Y.profile||{};return!!(e.age_range&&e.gender)});const Te=b(()=>{var e,t;return((t=(e=a.dream)==null?void 0:e.deep_source)==null?void 0:t.hvdc)||null}),pt=b(()=>{var D,H,n;const e=[{key:"characters",label:"–ü–µ—Ä—Å–æ–Ω–∞–∂–∏"},{key:"emotions",label:"–≠–º–æ—Ü–∏–∏"},{key:"actions",label:"–î–µ–π—Å—Ç–≤–∏—è"},{key:"settings",label:"–°—Ü–µ–Ω—ã"}],t=((D=Te.value)==null?void 0:D.distribution)||{},i=((H=Te.value)==null?void 0:H.norm)||null,u=((n=Te.value)==null?void 0:n.comparison)||null;return e.map(k=>({key:k.key,label:k.label,value:Number(t[k.key]??0),norm:i?Number(i[k.key]??0):null,delta:u?Number(u[k.key]??0):null}))}),vt=b(()=>{var n;const e=((n=Te.value)==null?void 0:n.norm_group)||null;if(!e)return"–æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞";const t=String(e.gender||"").toLowerCase(),i=t==="male"?"–º—É–∂.":t==="female"?"–∂–µ–Ω.":"",u=e.age_range||"",D=u?`${u} –ª–µ—Ç`:"",H=[i,D].filter(Boolean).join(" ");return H?`–æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞* –¥–ª—è ${H}`:"–æ–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞"});function Le(e,t){const i=Math.abs(e)%100,u=i%10;return i>10&&i<20?t[2]:u>1&&u<5?t[1]:u===1?t[0]:t[2]}const yt=b(()=>{if(!a.dream.created_at)return"";try{const e=Intl.DateTimeFormat().resolvedOptions().timeZone||ae.tz.guess(),t=ae.utc(a.dream.created_at).tz(e).startOf("day"),u=ae().tz(e).startOf("day").diff(t,"day");if(u===0)return"—Å–µ–≥–æ–¥–Ω—è";if(u===1)return"–≤—á–µ—Ä–∞";if(u<7){const Z=Le(u,["–¥–µ–Ω—å","–¥–Ω—è","–¥–Ω–µ–π"]);return`${u} ${Z} –Ω–∞–∑–∞–¥`}const D=Math.floor(u/7);if(u<30){const Z=Le(D,["–Ω–µ–¥–µ–ª—è","–Ω–µ–¥–µ–ª–∏","–Ω–µ–¥–µ–ª—å"]);return`${D} ${Z} –Ω–∞–∑–∞–¥`}const H=Math.floor(u/30);if(u<365){const Z=Le(H,["–º–µ—Å—è—Ü","–º–µ—Å—è—Ü–∞","–º–µ—Å—è—Ü–µ–≤"]);return`${H} ${Z} –Ω–∞–∑–∞–¥`}const n=Math.floor(u/365),k=Le(n,["–≥–æ–¥","–≥–æ–¥–∞","–ª–µ—Ç"]);return`${n} ${k} –Ω–∞–∑–∞–¥`}catch{return a.dream.created_at}}),gt=b(()=>{var t;const e=(t=a.dream)==null?void 0:t.created_at;if(!e)return"";try{const i=Intl.DateTimeFormat().resolvedOptions().timeZone||ae.tz.guess();return ae.utc(e).tz(i).format("D MMMM YYYY, HH:mm")}catch{return e}}),xt=b(()=>{var e;return(e=a.dream)!=null&&e.is_deep_analysis?"from-[#9C41FF] to-[#C03AFF]":"from-[#4A58FF] to-[#5664FF]"});return(e,t)=>{var i,u,D,H;return r(),o("article",{ref_key:"rootRef",ref:J,class:fe(["rounded-xl bg-gradient-to-br text-white px-8 md:px-16 transition-all overflow-hidden py-4",[xt.value,V.overlayMode?"":"cursor-pointer min-h-[4.5rem]"]]),onClick:C},[V.overlayMode?N("",!0):(r(),o("div",cs,[s("div",us,j(E.value),1),s("div",ds,[s("div",fs,j(c.value),1),s("div",hs,j(yt.value),1)]),s("button",{class:"shrink-0 w-6 h-6 opacity-80 hover:opacity-100 flex items-center justify-center",onClick:t[0]||(t[0]=ce(n=>G(),["stop"])),"aria-label":"–û—Ç–∫—Ä—ã—Ç—å"},[...t[9]||(t[9]=[s("span",{class:"text-lg font-semibold leading-none select-none"},">",-1)])])])),V.active?(r(),o("div",ms,[V.overlayMode?(r(),o("div",ps,[s("h2",vs,j(c.value),1),s("div",ys,j(gt.value),1),h.value.length&&!F.value?(r(),o("div",gs,[(r(!0),o(X,null,ne(h.value,n=>(r(),o("span",{key:n,class:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-white/20 text-white"},j(n),1))),128))])):N("",!0)])):N("",!0),F.value?(r(),o(X,{key:1},[T.value?(r(),o("div",xs,[t[11]||(t[11]=s("h3",{class:"text-2xl font-bold"},"–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã",-1)),s("div",_s,[S.value?(r(),o("p",bs,j(S.value),1)):N("",!0),(r(!0),o(X,null,ne(_e.value,(n,k)=>(r(),o("div",{key:`symbol-${k}`,class:"space-y-3"},[s("div",ws,[s("h4",ks,j(n.symbol),1),s("span",$s,"√ó"+j(n.frequency),1)]),s("p",Ms,j(n.description),1),s("div",Ss,[t[10]||(t[10]=s("span",{class:"font-medium opacity-80"},"–í –≤–∞—à–∏—Ö —Å–Ω–∞—Ö:",-1)),we(" "+j(n.userContext),1)])]))),128))])])):N("",!0),d.value?(r(),o("div",Ds,[t[12]||(t[12]=s("h3",{class:"text-2xl font-bold"},"–î–∏–Ω–∞–º–∏–∫–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞",-1)),s("div",Ts,[Oe(Ke,{dynamics:v.value,userAge:(i=Ye(Y).profile)==null?void 0:i.age_range,userGender:(u=Ye(Y).profile)==null?void 0:u.gender},null,8,["dynamics","userAge","userGender"])])])):N("",!0),m.value?(r(),o("div",Cs,[t[14]||(t[14]=s("h3",{class:"text-2xl font-bold"},"–ó–∞–∫–ª—é—á–µ–Ω–∏–µ",-1)),s("div",js,[p.value.periodThemes?(r(),o("p",Os,j(p.value.periodThemes),1)):N("",!0),p.value.dreamFunctionsAnalysis?(r(),o("p",Hs,j(p.value.dreamFunctionsAnalysis),1)):N("",!0),p.value.psychologicalSupport?(r(),o("p",As,j(p.value.psychologicalSupport),1)):N("",!0),p.value.integrationExercise?(r(),o("div",Ls,[s("h4",Ys,[t[13]||(t[13]=s("span",null,"üí´",-1)),s("span",null,j(p.value.integrationExercise.title||"–ü—Ä–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ"),1)]),s("p",Bs,j(p.value.integrationExercise.description),1),p.value.integrationExercise.rationale?(r(),o("p",zs,j(p.value.integrationExercise.rationale),1)):N("",!0)])):N("",!0)])])):N("",!0),!T.value&&!d.value&&!m.value?(r(),o(X,{key:3},[s("div",Fs,[t[15]||(t[15]=s("div",{class:"px-3 py-2 font-semibold"},"–û–±—â–∏–π –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å–µ—Ä–∏–∏",-1)),s("div",Is,[s("div",{innerHTML:se.value},null,8,Ns)])]),h.value.length?(r(),o("div",Us,[t[16]||(t[16]=s("div",{class:"px-3 py-2 font-semibold"},"–ü–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å–∏–º–≤–æ–ª—ã",-1)),s("div",Es,[s("div",Ws,[(r(!0),o(X,null,ne(h.value,n=>(r(),o("span",{key:"deep-"+n,class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-white/15 text-white"},j(n),1))),128))])])])):N("",!0),be.value?(r(),o("div",Ps,[t[17]||(t[17]=s("div",{class:"px-3 py-2 font-semibold"},"–î–∏–Ω–∞–º–∏–∫–∞",-1)),s("div",Rs,[Oe(Ke,{dynamics:he.value,userAge:(D=Ye(Y).profile)==null?void 0:D.age_range,userGender:(H=Ye(Y).profile)==null?void 0:H.gender},null,8,["dynamics","userAge","userGender"])])])):N("",!0),ge.value.length?(r(),o("div",Zs,[t[18]||(t[18]=s("div",{class:"px-3 py-2 font-semibold"},"–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã",-1)),s("div",Vs,[s("ol",Gs,[(r(!0),o(X,null,ne(ge.value,(n,k)=>(r(),o("li",{key:"in"+k,class:"text-xs leading-relaxed"},j(n),1))),128))])])])):N("",!0),R.value.length?(r(),o("div",qs,[t[19]||(t[19]=s("div",{class:"px-3 py-2 font-semibold"},"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",-1)),s("div",Js,[s("ol",Xs,[(r(!0),o(X,null,ne(R.value,(n,k)=>(r(),o("li",{key:"rec"+k,class:"text-xs leading-relaxed"},[typeof n=="object"&&n.title?(r(),o("div",Ks,[s("div",Qs,j(n.title),1),s("div",en,j(n.description),1),n.rationale?(r(),o("div",tn,j(n.rationale),1)):N("",!0)])):(r(),o("div",sn,j(typeof n=="string"?n:n.title),1))]))),128))])])])):N("",!0)],64)):N("",!0),(T.value||d.value)&&!m.value?(r(),o(X,{key:4},[ge.value.length?(r(),o("div",nn,[t[20]||(t[20]=s("div",{class:"px-3 py-2 font-semibold"},"–ö–ª—é—á–µ–≤—ã–µ –∏–Ω—Å–∞–π—Ç—ã",-1)),s("div",rn,[s("ol",on,[(r(!0),o(X,null,ne(ge.value,(n,k)=>(r(),o("li",{key:"in"+k,class:"text-xs leading-relaxed"},j(n),1))),128))])])])):N("",!0),R.value.length?(r(),o("div",an,[t[21]||(t[21]=s("div",{class:"px-3 py-2 font-semibold"},"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏",-1)),s("div",ln,[s("ol",cn,[(r(!0),o(X,null,ne(R.value,(n,k)=>(r(),o("li",{key:"rec"+k,class:"text-xs leading-relaxed"},[typeof n=="object"&&n.title?(r(),o("div",un,[s("div",dn,j(n.title),1),s("div",fn,j(n.description),1),n.rationale?(r(),o("div",hn,j(n.rationale),1)):N("",!0)])):(r(),o("div",mn,j(typeof n=="string"?n:n.title),1))]))),128))])])])):N("",!0)],64)):N("",!0)],64)):(r(),o(X,{key:2},[s("div",pn,[t[22]||(t[22]=s("div",{class:"flex items-start justify-between gap-3"},[s("h3",{class:"text-2xl font-bold leading-tight"},"–°–æ–Ω"),s("span",{class:"opacity-70 text-pink-300 text-4xl leading-none",style:{"font-family":"Georgia, ui-serif"}},'"')],-1)),s("div",vn,[s("p",{class:fe(["text-lg leading-relaxed transition-all",Me.dreamText?"":"line-clamp-3"])},j(V.dream.dream_text),3)]),s("div",yn,[s("button",{onClick:t[1]||(t[1]=ce(n=>Ve("dreamText"),["stop"])),class:"text-sm opacity-70 hover:opacity-100 transition-opacity"},j(Me.dreamText?"–°–≤–µ—Ä–Ω—É—Ç—å ‚Üë":"–†–∞–∑–≤–µ—Ä–Ω—É—Ç—å ‚Üì"),1)])]),s("div",gn,[t[29]||(t[29]=s("h2",{class:"text-2xl font-bold"},"–ù–∞—É—á–Ω—ã–π –ø–æ–¥—Ö–æ–¥",-1)),Te.value?(r(),o("div",xn,[t[27]||(t[27]=s("h3",{class:"text-lg font-semibold px-4 py-3"},"–ö–æ–Ω—Ç–µ–Ω—Ç –∞–Ω–∞–ª–∏–∑",-1)),s("div",_n,[s("div",bn,[(r(!0),o(X,null,ne(pt.value,n=>(r(),o("div",{key:n.key,class:"space-y-1"},[s("div",wn,[s("span",kn,j(n.label),1),s("span",$n,[we(j(n.value)+"% ",1),n.norm!==null?(r(),o(X,{key:0},[we(" / "+j(n.norm)+"%",1)],64)):N("",!0),n.delta!==null?(r(),o("span",{key:1,class:fe(n.delta>0?"text-green-300":n.delta<0?"text-red-300":"text-white/70")}," ("+j(n.delta>0?"+"+n.delta:n.delta)+"pp) ",3)):N("",!0)])]),s("div",Mn,[n.norm!==null?(r(),o("div",{key:0,class:"absolute inset-y-0 left-0 bg-white/20",style:Xe({width:n.norm+"%"})},null,4)):N("",!0),s("div",{class:"relative h-full bg-white/70",style:Xe({width:n.value+"%"})},null,4)])]))),128)),s("div",Sn,[t[25]||(t[25]=s("span",{class:"inline-flex items-center gap-2"},[s("span",{class:"w-2.5 h-2.5 rounded-full inline-block bg-white/70 shrink-0"}),we(),s("span",{class:"leading-normal"},"–≤–∞—à —Å–æ–Ω")],-1)),s("span",Dn,[t[23]||(t[23]=s("span",{class:"w-2.5 h-2.5 rounded-full inline-block bg-white/20 shrink-0"},null,-1)),t[24]||(t[24]=we()),s("span",Tn,j(vt.value),1)])]),t[26]||(t[26]=s("div",{class:"text-sm opacity-70 flex items-start gap-2 leading-relaxed"},[s("span",{class:"inline-flex items-center justify-center w-4 h-4 rounded-full bg-white/20 text-white text-[10px] shrink-0 aspect-square mt-0.5"},"i"),s("span",null,"–ö–æ–Ω—Ç–µ–Ω—Ç‚Äë–∞–Ω–∞–ª–∏–∑ –ø–æ —Å—Ö–µ–º–µ HVdC; —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –¥–µ–º–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–º–∏ –Ω–æ—Ä–º–∞–º–∏ (DreamBank, SDDB).")],-1))])])])):N("",!0),(r(!0),o(X,null,ne(Ze.value,(n,k)=>(r(),o(X,{key:n.key},[n.key==="func"?(r(),o("div",Cn,[s("h3",jn,j(n.title),1),s("div",On,[s("div",{innerHTML:ut(n.html),class:"text-base leading-relaxed"},null,8,Hn),Ge(n.html)?(r(),o("div",An,[s("button",{onClick:t[2]||(t[2]=ce(Z=>Ve("funcExercise"),["stop"])),class:"w-full flex items-center justify-between text-left font-semibold hover:opacity-80 transition-opacity"},[t[28]||(t[28]=s("span",null,"–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ–µ —É–ø—Ä–∞–∂–Ω–µ–Ω–∏–µ",-1)),s("span",Ln,j(Me.funcExercise?"‚àí":"+"),1)]),St(s("div",{class:"mt-3",innerHTML:Ge(n.html)},null,8,Yn),[[Dt,Me.funcExercise]])])):N("",!0)])])):N("",!0)],64))),128))]),s("div",Bn,[t[30]||(t[30]=s("h2",{class:"text-2xl font-bold"},"–ü—Å–∏—Ö–æ–∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥",-1)),(r(!0),o(X,null,ne(Ze.value,(n,k)=>(r(),o(X,{key:`psycho-${n.key}`},[["arch","freud","jung"].includes(n.key)?(r(),o("div",zn,[s("h3",Fn,j(n.title),1),s("div",In,[s("div",{innerHTML:n.html,class:"text-base leading-relaxed space-y-2"},null,8,Nn)])])):N("",!0)],64))),128))])],64)),s("div",Un,[s("button",{class:fe(["flex-1 rounded-xl py-2 text-sm font-medium text-center transition-colors",I.value===1?"bg-green-500/30 text-white ring-2 ring-green-400/60":"bg-white/20 hover:bg-white/30 text-white"]),onClick:ce(g,["stop"])}," üëç ",2),s("button",{class:fe(["flex-1 rounded-xl py-2 text-sm font-medium text-center transition-colors",I.value===2?"bg-red-500/30 text-white ring-2 ring-red-400/60":"bg-white/20 hover:bg-white/30 text-white"]),onClick:ce(f,["stop"])}," üëé ",2),s("button",{class:"flex-1 bg-red-500/20 hover:bg-red-500/30 text-white rounded-xl py-2 text-sm font-medium text-center transition-colors",onClick:ce(O,["stop"])}," üóëÔ∏è ")]),qe.value&&Ne.value?(r(),o("div",En,[t[31]||(t[31]=s("div",{class:"mb-2 opacity-80"},"Debug payload",-1)),we(" "+j(JSON.stringify(Ne.value,null,2))+" ",1),s("div",Wn,[s("button",{class:"px-3 py-1 rounded bg-white/10 hover:bg-white/20",onClick:ce(dt,["stop"])},"–°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å")])])):N("",!0),(r(),Be(Qe,{to:"body"},[Ue.value?(r(),o("div",{key:0,class:"fixed inset-0 z-[9999] flex items-center justify-center bg-black/70",onClick:ce(Ee,["self"]),onWheel:t[7]||(t[7]=ce(()=>{},["prevent"])),onTouchmove:t[8]||(t[8]=ce(()=>{},["prevent"]))},[s("div",{class:"w-[92vw] max-w-[440px] rounded-2xl bg-[var(--tg-theme-secondary-bg-color,#0c110c)] text-white p-4 shadow-2xl border border-white/10",onClick:t[6]||(t[6]=ce(()=>{},["stop"]))},[t[34]||(t[34]=s("h3",{class:"text-lg font-semibold mb-2"},"–£—Ç–æ—á–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ",-1)),Je.value===1?(r(),o("div",Pn,[t[32]||(t[32]=s("p",{class:"opacity-90"},"–í–∞—à –≤–æ–∑—Ä–∞—Å—Ç–Ω–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω:",-1)),s("div",Rn,[(r(),o(X,null,ne(ht,n=>s("button",{key:n,class:fe(["px-4 py-3 rounded-xl text-sm",Ae.value===n?"bg-white/25":"bg-white/10 hover:bg-white/15"]),onClick:k=>Ae.value=n},j(n),11,Zn)),64))]),s("div",Vn,[s("button",{class:"px-4 py-2 rounded-xl bg-white/10",onClick:Ee},"–û—Ç–º–µ–Ω–∞"),s("button",{class:"px-4 py-2 rounded-xl bg-white/20",disabled:!Ae.value,onClick:t[3]||(t[3]=n=>Je.value=2)},"–î–∞–ª–µ–µ",8,Gn)])])):(r(),o("div",qn,[t[33]||(t[33]=s("p",{class:"opacity-90"},"–í–∞—à –ø–æ–ª:",-1)),s("div",Jn,[s("button",{class:fe(["px-4 py-3 rounded-xl text-sm",Se.value==="male"?"bg-white/25":"bg-white/10 hover:bg-white/15"]),onClick:t[4]||(t[4]=n=>Se.value="male")},"–ú—É–∂—Å–∫–æ–π",2),s("button",{class:fe(["px-4 py-3 rounded-xl text-sm",Se.value==="female"?"bg-white/25":"bg-white/10 hover:bg-white/15"]),onClick:t[5]||(t[5]=n=>Se.value="female")},"–ñ–µ–Ω—Å–∫–∏–π",2)]),s("div",Xn,[s("button",{class:"px-4 py-2 rounded-xl bg-white/10",onClick:Ee},"–û—Ç–º–µ–Ω–∞"),s("button",{class:"px-4 py-2 rounded-xl bg-white/20",disabled:!Se.value,onClick:mt},"–°–æ—Ö—Ä–∞–Ω–∏—Ç—å",8,Kn)])]))])],32)):N("",!0)]))])):N("",!0)],2)}}}),Re=Ie(ei,[["__scopeId","data-v-53982e54"]]),ti={class:"pb-6 overlay-pad"},si=ze({__name:"DreamOverlay",props:{dream:{},anchorY:{}},emits:["close"],setup(V,{emit:q}){ae.locale("ru"),ae.extend(it),ae.extend(ot);const a=V,P=q,J=new Set(["–∏","–≤","–≤–æ","–Ω–µ","—á—Ç–æ","–æ–Ω","–Ω–∞","—è","—Å","—Å–æ","–∫–∞–∫","–∞","—Ç–æ","–≤—Å–µ","–æ–Ω–∞","—Ç–∞–∫","–µ–≥–æ","–Ω–æ","–¥–∞","—Ç—ã","–∫","—É","–∂–µ","–≤—ã","–∑–∞","–±—ã","–ø–æ","–µ–µ","–º–Ω–µ","–±—ã–ª–æ","–≤–æ—Ç","–æ—Ç","–º–µ–Ω—è","–µ—â–µ","–Ω–µ—Ç","–æ","–∏–∑","–µ–º—É","—Ç–µ–ø–µ—Ä—å","–∫–æ–≥–¥–∞","–¥–∞–∂–µ","–Ω—É","–≤–¥—Ä—É–≥","–ª–∏","–µ—Å–ª–∏","—É–∂–µ","–∏–ª–∏","–Ω–∏","–±—ã—Ç—å","–±—ã–ª","–Ω–µ–≥–æ","–¥–æ","–≤–∞—Å","–Ω–∏–±—É–¥—å","–æ–ø—è—Ç—å","—É–∂","–≤–∞–º","–≤–µ–¥—å","—Ç–∞–º","–ø–æ—Ç–æ–º","—Å–µ–±—è","–Ω–∏—á–µ–≥–æ","–µ–π","–º–æ–∂–µ—Ç","–æ–Ω–∏","—Ç—É—Ç","–≥–¥–µ","–µ—Å—Ç—å","–Ω–∞–¥–æ","–Ω–µ–π","–¥–ª—è","–º—ã","—Ç–µ–±—è","–∏—Ö","—á–µ–º","–±—ã–ª–∞","—Å–∞–º","—á—Ç–æ–±","–±–µ–∑","–±—É–¥—Ç–æ","—á–µ–≥–æ","—Ä–∞–∑","—Ç–æ–∂–µ","—Å–µ–±–µ","–ø–æ–¥","–±—É–¥–µ—Ç","–∂","—Ç–æ–≥–¥–∞","–∫—Ç–æ","—ç—Ç–æ—Ç","—Ç–æ–≥–æ","–ø–æ—Ç–æ–º—É","—ç—Ç–æ–≥–æ","–∫–∞–∫–æ–π","—Å–æ–≤—Å–µ–º","–Ω–∏–º","–∑–¥–µ—Å—å","—ç—Ç–æ–º","–æ–¥–∏–Ω","–ø–æ—á—Ç–∏","–º–æ–π","—Ç–µ–º","—á—Ç–æ–±—ã","–Ω–µ–µ","–∫–∞–∂–µ—Ç—Å—è","—Å–µ–π—á–∞—Å","–±—ã–ª–∏","–∫—É–¥–∞","–∑–∞—á–µ–º","–≤—Å–µ—Ö","–Ω–∏–∫–æ–≥–¥–∞","–º–æ–∂–Ω–æ","–ø—Ä–∏","–Ω–∞–∫–æ–Ω–µ—Ü","–¥–≤–∞","–æ–±","–¥—Ä—É–≥–æ–π","—Ö–æ—Ç—å","–ø–æ—Å–ª–µ","–Ω–∞–¥","–±–æ–ª—å—à–µ","—Ç–æ—Ç","—á–µ—Ä–µ–∑","—ç—Ç–∏","–Ω–∞—Å","–ø—Ä–æ","–≤—Å–µ–≥–æ","–Ω–∏—Ö","–∫–∞–∫–∞—è","–º–Ω–æ–≥–æ","—Ä–∞–∑–≤–µ","—Ç—Ä–∏","—ç—Ç—É","–º–æ—è","–≤–ø—Ä–æ—á–µ–º","—Ö–æ—Ä–æ—à–æ","—Å–≤–æ—é","—ç—Ç–æ–π","–ø–µ—Ä–µ–¥","–∏–Ω–æ–≥–¥–∞","–ª—É—á—à–µ","—á—É—Ç—å","—Ç–æ–º","–Ω–µ–ª—å–∑—è","—Ç–∞–∫–æ–π","–∏–º","–±–æ–ª–µ–µ","–≤—Å–µ–≥–¥–∞","–∫–æ–Ω–µ—á–Ω–æ","–≤—Å—é","–º–µ–∂–¥—É"]),G=c=>String(c||"").replace(/\s+/g," ").trim().split(" ").map(h=>h.charAt(0).toUpperCase()+h.slice(1)).join(" "),C=c=>{if(!c)return"";const h=String(c).split(/[.!?\n]/)[0],L=h.toLowerCase().replace(/[^\p{L}\p{N}\s-]/gu,"").split(/\s+/).filter(U=>U&&!J.has(U)&&U.length>3).slice(0,3);return L.length===0?h.slice(0,40):G(L.join(" "))},Y=c=>{if(!c)return"";let h=String(c).toLowerCase().replace(/["'¬´¬ª]/g,"").trim();h=h.replace(/^(–ø—Ä–∏—Å–Ω–∏–ª–æ—Å—å|—Å–Ω–∏–ª–æ—Å—å|—Å–æ–Ω –æ|—Å–æ–Ω –ø—Ä–æ|—Å–æ–Ω|–º–Ω–µ —Å–Ω–∏—Ç—Å—è|–º–Ω–µ –ø—Ä–∏—Å–Ω–∏–ª–æ—Å—å)\s+/i,""),h=h.replace(/\s+/g," ").trim();const M=h.split(" ").filter(Boolean).slice(0,3);return M.length?M.join(" "):""},_=c=>{if(!c)return"";const h=String(c).toLowerCase();return h.charAt(0).toUpperCase()+h.slice(1)};b(()=>{var S,ve,_e,T,v;const c=Y(String(((ve=(S=a.dream)==null?void 0:S.deep_source)==null?void 0:ve.title)||""));if(c)return _(c);const h=(((T=(_e=a.dream)==null?void 0:_e.deep_source)==null?void 0:T.tags)||[]).filter(Boolean),M=d=>{var m;let p=String(d||"").trim();return p=((m=p.split(/[\\/,(;:‚Äî‚Äì-]/)[0])==null?void 0:m.trim())||"",p?p.charAt(0).toUpperCase()+p.slice(1).toLowerCase():""},L=h.map(M).filter(Boolean);if(L.length){const d=L.slice(0,2).join(" –∏ ");return _(d||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")}const U=Y(C(String(((v=a.dream)==null?void 0:v.dream_text)||"")));return _(U||"–ë–µ–∑ –Ω–∞–∑–≤–∞–Ω–∏—è")}),b(()=>{var h;const c=(h=a.dream)==null?void 0:h.created_at;if(!c)return"";try{const M=Intl.DateTimeFormat().resolvedOptions().timeZone||ae.tz.guess();return ae.utc(c).tz(M).format("D MMMM YYYY, HH:mm")}catch{return c}});function F(){var c,h,M,L,U;try{const S=(c=window==null?void 0:window.Telegram)==null?void 0:c.WebApp;(M=(h=S==null?void 0:S.BackButton)==null?void 0:h.show)==null||M.call(h),(U=(L=S==null?void 0:S.BackButton)==null?void 0:L.onClick)==null||U.call(L,I)}catch{}}function E(){var c,h,M,L,U;try{const S=(c=window==null?void 0:window.Telegram)==null?void 0:c.WebApp;(M=(h=S==null?void 0:S.BackButton)==null?void 0:h.hide)==null||M.call(h),(U=(L=S==null?void 0:S.BackButton)==null?void 0:L.offClick)==null||U.call(L,I)}catch{}}function I(){P("close")}const $=ie(null);function W(c){const h=$.value;h&&h.contains(c.target)||P("close")}Tt(()=>{Ct(()=>a.dream,c=>{if(c){try{document.body.style.overflow="hidden"}catch{}F()}else{E();try{document.body.style.overflow=""}catch{}}},{immediate:!0})}),jt(()=>{E();try{document.body.style.overflow=""}catch{}});const g=ie(null);let f=0,O=!1,A=!1,l=0;function y(c){try{const h=g.value;if(!h||(A=h.scrollTop<=0,!A))return;f=c.touches[0].clientY,l=0,O=!0}catch{}}function w(c){if(!O||!A)return;const h=c.touches[0].clientY;if(l=Math.max(0,h-f),l>0){c.preventDefault();const M=$.value;M&&(M.style.transform=`translateY(${Math.min(120,l)}px)`)}}function x(){if(O&&A&&l>=120)P("close");else{const c=$.value;c&&(c.style.transform="")}O=!1,A=!1,f=0,l=0}return(c,h)=>(r(),Be(Qe,{to:"body"},[V.dream?(r(),o("div",{key:0,class:"fixed inset-0 z-[9998] bg-black/70",onClick:W},[s("div",{class:"absolute inset-0 overflow-y-auto",ref_key:"scrollerRef",ref:g,onTouchstart:y,onTouchmove:w,onTouchend:x},[s("div",ti,[s("div",{ref_key:"cardRef",ref:$,onClick:h[0]||(h[0]=ce(()=>{},["stop"]))},[Oe(Re,{dream:V.dream,active:!0,overlayMode:!0},null,8,["dream"])],512)])],544)])):N("",!0)]))}}),ni=Ie(si,[["__scopeId","data-v-19174b42"]]),ii={class:"flex items-center gap-8 mb-6 border-b border-white/10"},ri={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-white rounded-full"},oi={key:0,class:"absolute bottom-0 left-0 right-0 h-0.5 bg-white rounded-full"},ai={key:0,class:"flex flex-col gap-4 pb-[5vh]"},li={key:1,class:"text-center text-red-400 py-8"},ci={key:2},ui={key:0,class:"text-center text-white/60 py-8"},di={key:1,class:"flex flex-col gap-4 pb-[5vh]"},fi={key:3},hi={key:0,class:"text-center text-white/60 py-8"},mi={key:1,class:"flex flex-col gap-4 pb-[5vh]"},pi=ze({__name:"AnalysisHistoryList",props:["userStore"],setup(V){const q=V,a=ie(null),P=ie(null),J=ie(5),G=ie(5),C=ie("history"),Y=b(()=>{var l;return(l=q.userStore)!=null&&l.history?q.userStore.history.filter(y=>!y.is_deep_analysis):[]}),_=b(()=>{var l;return(l=q.userStore)!=null&&l.history?q.userStore.history.filter(y=>y.is_deep_analysis):[]}),F=b(()=>Y.value.slice(0,J.value)),E=b(()=>_.value.slice(0,G.value)),I=b(()=>Y.value.length>J.value),$=b(()=>_.value.length>G.value),W=()=>{window.triggerHaptic&&window.triggerHaptic("light"),J.value+=5},g=()=>{window.triggerHaptic&&window.triggerHaptic("light"),G.value+=5},f=l=>{window.triggerHaptic&&window.triggerHaptic("light"),C.value=l,a.value=null},O=(l,y)=>{var w,x,c,h,M;a.value=l,P.value=typeof(y==null?void 0:y.y)=="number"?Math.max(0,Math.round(y.y)):null;try{const L=(w=window==null?void 0:window.Telegram)==null?void 0:w.WebApp;(c=(x=L==null?void 0:L.BackButton)==null?void 0:x.onClick)==null||c.call(x,()=>A()),(M=(h=L==null?void 0:L.BackButton)==null?void 0:h.show)==null||M.call(h)}catch{}},A=()=>{var l,y,w;try{const x=(l=window==null?void 0:window.Telegram)==null?void 0:l.WebApp;(w=(y=x==null?void 0:x.BackButton)==null?void 0:y.hide)==null||w.call(y)}catch{}a.value=null,P.value=null};return(l,y)=>{var w,x,c,h;return r(),o("div",null,[s("div",ii,[s("button",{onClick:y[0]||(y[0]=M=>f("history")),class:fe(["relative pb-3 text-lg font-semibold transition-all duration-200",[C.value==="history"?"text-white":"text-white/40 hover:text-white/60"]])},[y[2]||(y[2]=we(" –î–Ω–µ–≤–Ω–∏–∫ —Å–Ω–æ–≤ ",-1)),C.value==="history"?(r(),o("div",ri)):N("",!0)],2),s("button",{onClick:y[1]||(y[1]=M=>f("deep")),class:fe(["relative pb-3 text-lg font-semibold transition-all duration-200",[C.value==="deep"?"text-white":"text-white/40 hover:text-white/60"]])},[y[3]||(y[3]=we(" –ì–ª—É–±–æ–∫–∏–π –∞–Ω–∞–ª–∏–∑ ",-1)),C.value==="deep"?(r(),o("div",oi)):N("",!0)],2)]),(w=V.userStore)!=null&&w.isLoadingHistory?(r(),o("div",ai,[(r(),o(X,null,ne(3,M=>s("div",{key:M,class:"rounded-xl bg-white/10 px-8 md:px-16 py-6"},[...y[4]||(y[4]=[Ot('<div class="flex justify-between items-center py-2 min-h-[2.5rem]" data-v-cb63dade><div class="shimmer h-4 w-32 rounded" data-v-cb63dade></div><div class="shimmer h-4 w-12 rounded" data-v-cb63dade></div></div><div class="mt-4 space-y-2" data-v-cb63dade><div class="shimmer h-3 w-full rounded" data-v-cb63dade></div><div class="shimmer h-3 w-5/6 rounded" data-v-cb63dade></div><div class="shimmer h-3 w-2/3 rounded" data-v-cb63dade></div></div><div class="mt-4 grid grid-cols-3 gap-2" data-v-cb63dade><div class="shimmer h-6 rounded-full" data-v-cb63dade></div><div class="shimmer h-6 rounded-full" data-v-cb63dade></div><div class="shimmer h-6 rounded-full" data-v-cb63dade></div></div>',3)])])),64))])):(x=V.userStore)!=null&&x.errorHistory?(r(),o("div",li," –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: "+j(V.userStore.errorHistory),1)):C.value==="history"?(r(),o("div",ci,[(c=Y.value)!=null&&c.length?(r(),o("div",di,[(r(!0),o(X,null,ne(F.value,M=>(r(),Be(Re,{key:M.id,dream:M,onOpen:L=>O(M,L)},null,8,["dream","onOpen"]))),128)),I.value?(r(),o("button",{key:0,class:"self-center rounded-full px-4 py-2 text-sm font-medium transition-colors my-2 themed-button",onClick:W}," –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë ")):N("",!0)])):(r(),o("div",ui," –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –∞–Ω–∞–ª–∏–∑–æ–≤ "))])):C.value==="deep"?(r(),o("div",fi,[(h=_.value)!=null&&h.length?(r(),o("div",mi,[(r(!0),o(X,null,ne(E.value,M=>(r(),Be(Re,{key:M.id,dream:M,onOpen:L=>O(M,L)},null,8,["dream","onOpen"]))),128)),$.value?(r(),o("button",{key:0,class:"self-center rounded-full px-4 py-2 text-sm font-medium transition-colors my-2 themed-button",onClick:g}," –ó–∞–≥—Ä—É–∑–∏—Ç—å –µ—â—ë ")):N("",!0)])):(r(),o("div",hi," –ü–æ–∫–∞ –Ω–µ—Ç –≥–ª—É–±–æ–∫–∏—Ö –∞–Ω–∞–ª–∏–∑–æ–≤ "))])):N("",!0),Oe(ni,{dream:a.value,"anchor-y":P.value,onClose:A},null,8,["dream","anchor-y"])])}}}),xi=Ie(pi,[["__scopeId","data-v-cb63dade"]]);export{xi as default};
