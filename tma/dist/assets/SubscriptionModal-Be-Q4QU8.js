import{r as P,o as h,J as S,a as g,e as l,f as c,g as n,u as e,n as _,F as b,v,h as B,t as d,p as y,y as x}from"./main-D9q8tcSZ.js";import{u as w}from"./PersonalAccount-BEqHWPDV.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./notifications-C2JzekkY.js";const V={class:"modal-content"},$={class:"tabs"},A={class:"duration-options"},F=["value","checked","onChange"],I={class:"duration-card"},N={class:"months"},E={key:0,class:"price"},T={key:1,class:"total-price"},U={class:"features-list"},z={__name:"SubscriptionModal",emits:["close"],setup(H,{emit:k}){var f;const s=w(),{getPlanDetails:u}=s,t=(f=window.Telegram)==null?void 0:f.WebApp,C=k,m=P(!1);h(()=>{m.value=!0,console.log("[SubscriptionModal] Component mounted")});const p=()=>{C("close")},r=()=>{var a;console.log("[SubscriptionModal] Main Button clicked!"),(a=t==null?void 0:t.MainButton)!=null&&a.isActive?s.initiatePayment():console.warn("[SubscriptionModal] Main Button clicked but it was inactive.")};return S(()=>{var i;if(!t||!m.value){(i=t==null?void 0:t.MainButton)!=null&&i.isVisible&&(console.log("[SubscriptionModal] Hiding Main Button (not mounted or no tg)"),t.MainButton.hide(),t.MainButton.offClick(r));return}const a=s.selectedInvoiceAmount;a?(console.log(`[SubscriptionModal] Setting Main Button: Pay ${a} Stars`),t.MainButton.setParams({text:`Оплатить ${a} ⭐`,color:t.themeParams.button_color||"#2481CC",text_color:t.themeParams.button_text_color||"#ffffff",is_active:!0,is_visible:!0}),t.MainButton.offClick(r),t.MainButton.onClick(r)):(console.log("[SubscriptionModal] Setting Main Button: Inactive (no amount)"),t.MainButton.setParams({text:"Выберите план",is_active:!1,is_visible:!0}),t.MainButton.offClick(r))}),g(()=>{var a;(a=t==null?void 0:t.MainButton)!=null&&a.isVisible&&(t.MainButton.hide(),t.MainButton.offClick(r),console.log("[SubscriptionModal] Main Button hidden on modal unmount.")),m.value=!1}),(a,i)=>(c(),l("div",{class:"modal-overlay",onClick:x(p,["self"])},[n("div",V,[n("button",{class:"close-button",onClick:p},"×"),i[4]||(i[4]=n("h2",null,"Выберите план подписки",-1)),n("div",$,[n("button",{class:_({active:e(s).selectedPlan==="basic"}),onClick:i[0]||(i[0]=o=>e(s).selectPlan("basic"))}," Basic ",2),n("button",{class:_({active:e(s).selectedPlan==="premium"}),onClick:i[1]||(i[1]=o=>e(s).selectPlan("premium"))}," Premium ",2)]),n("div",A,[(c(),l(b,null,v([1,3,12],o=>n("label",{key:o,class:"duration-label"},[n("input",{type:"radio",name:"duration",value:o,checked:e(s).selectedDuration===o,onChange:M=>e(s).selectDuration(o)},null,40,F),n("div",I,[n("span",N,d(o)+" "+d(o>1?o<5?"месяца":"месяцев":"месяц"),1),e(u)(e(s).selectedPlan,o).price?(c(),l("span",E,d((e(u)(e(s).selectedPlan,o).price/o).toFixed(0))+" / мес ",1)):B("",!0),e(u)(e(s).selectedPlan,o).price?(c(),l("span",T,[y(" Всего: "+d(e(u)(e(s).selectedPlan,o).price)+" ",1),i[2]||(i[2]=n("span",{class:"stars-icon"},"⭐",-1))])):B("",!0)])])),64))]),n("div",U,[i[3]||(i[3]=n("h3",null,"Что вы получаете:",-1)),n("ul",null,[(c(!0),l(b,null,v(e(u)(e(s).selectedPlan,e(s).selectedDuration).features,(o,M)=>(c(),l("li",{key:M}," ✔️ "+d(o),1))),128))])])])]))}},q=D(z,[["__scopeId","data-v-b1fd3978"]]);export{q as default};
