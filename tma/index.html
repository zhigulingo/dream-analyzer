<!-- tma/index.html -->
<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ viewport –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ fullscreen -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no, viewport-fit=cover, shrink-to-fit=no" />

    <!-- –ú–æ–±–∏–ª—å–Ω—ã–µ web app –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-touch-fullscreen" content="yes" />

    <!-- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ fullscreen –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ -->
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    <meta name="theme-color" content="#121a12" />
    <title>Dream Analyzer - –õ–∏—á–Ω—ã–π –ö–∞–±–∏–Ω–µ—Ç</title>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —Å–∫—Ä–∏–ø—Ç Telegram WebApp –±–µ–∑ defer, —á—Ç–æ–±—ã –æ–Ω –±—ã–ª –¥–æ—Å—Ç—É–ø–µ–Ω –¥–æ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>

    <!-- –†–∞–Ω–Ω—è—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è fullscreen –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ -->
    <script>
      (function() {
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –º–æ–±–∏–ª—å–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ
        const isMobile = /android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini|mobile|tablet/i.test(navigator.userAgent) ||
                        (window.innerWidth <= 768 && window.innerHeight <= 1024) ||
                        ('ontouchstart' in window);

        if (isMobile) {
          console.log('üì± Mobile device detected, preparing early fullscreen setup');

          // –§—É–Ω–∫—Ü–∏—è —Ä–∞–Ω–Ω–µ–≥–æ fullscreen —Å Telegram API
          const earlyFullscreenSetup = function() {
            try {
              console.log('üöÄ Early fullscreen setup starting...');

              // –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–±—É–µ–º Telegram WebApp fullscreen
              if (window.Telegram?.WebApp?.requestFullscreen) {
                console.log('üéØ Trying early Telegram fullscreen...');
                window.Telegram.WebApp.requestFullscreen();
                console.log('‚úÖ Early Telegram fullscreen called');
                return;
              }

              // –ï—Å–ª–∏ Telegram –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω, –ø—Ä–æ–±—É–µ–º –±—Ä–∞—É–∑–µ—Ä–Ω—ã–π API
              const doc = document.documentElement;

              if (doc.requestFullscreen) {
                doc.requestFullscreen().then(function() {
                  console.log('üéØ Early browser fullscreen activated');
                }).catch(function(err) {
                  console.log('Early browser fullscreen failed:', err);
                });
              } else if (doc.webkitRequestFullscreen) {
                doc.webkitRequestFullscreen();
                console.log('üéØ Early webkit fullscreen activated');
              }

              // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
              const retryFullscreen = function() {
                console.log('üîÑ Retrying fullscreen...');

                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –∞–∫—Ç–∏–≤–µ–Ω –ª–∏ —É–∂–µ fullscreen
                if (document.fullscreenElement || document.webkitFullscreenElement) {
                  console.log('‚úÖ Fullscreen already active');
                  return;
                }

                // –ü–æ–≤—Ç–æ—Ä—è–µ–º –ø–æ–ø—ã—Ç–∫—É Telegram
                if (window.Telegram?.WebApp?.requestFullscreen) {
                  window.Telegram.WebApp.requestFullscreen();
                  console.log('üîÑ Telegram fullscreen retried');
                  return;
                }

                // –ü–æ–≤—Ç–æ—Ä—è–µ–º –±—Ä–∞—É–∑–µ—Ä–Ω—É—é –ø–æ–ø—ã—Ç–∫—É
                if (doc.requestFullscreen) {
                  doc.requestFullscreen().catch(function() {
                    console.log('Browser fullscreen retry failed');
                  });
                } else if (doc.webkitRequestFullscreen) {
                  doc.webkitRequestFullscreen();
                  console.log('üîÑ Webkit fullscreen retried');
                }
              };

              // –ü–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –ø—Ä–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Å–æ–±—ã—Ç–∏—è—Ö
              document.addEventListener('touchstart', retryFullscreen, { once: true });
              document.addEventListener('click', retryFullscreen, { once: true });
              document.addEventListener('DOMContentLoaded', retryFullscreen);

              console.log('üéØ Early fullscreen setup completed');

            } catch (error) {
              console.log('‚ùå Early fullscreen setup failed:', error);
            }
          };

          // –ó–∞–ø—É—Å–∫–∞–µ–º —Ä–∞–Ω–Ω—é—é –Ω–∞—Å—Ç—Ä–æ–π–∫—É
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', earlyFullscreenSetup);
          } else {
            earlyFullscreenSetup();
          }

          // –¢–∞–∫–∂–µ –∑–∞–ø—É—Å–∫–∞–µ–º —á–µ—Ä–µ–∑ –Ω–µ–±–æ–ª—å—à—É—é –∑–∞–¥–µ—Ä–∂–∫—É
          setTimeout(earlyFullscreenSetup, 100);
        } else {
          console.log('üíª Desktop device, skipping early fullscreen setup');
        }
      })();
    </script>
  </head>
  <body>
    <!-- –ö–æ—Ä–Ω–µ–≤–æ–π —ç–ª–µ–º–µ–Ω—Ç, –∫—É–¥–∞ –±—É–¥–µ—Ç –º–æ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å—Å—è Vue –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ -->
    <div id="app"></div>
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≥–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –≤–∞—à–µ–≥–æ Vue –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è -->
    <!-- type="module" –≤–∞–∂–µ–Ω –¥–ª—è Vite -->
    <script type="module" src="/src/main.js"></script>
  </body>
</html>
