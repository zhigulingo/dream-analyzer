import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as T,c as n,a as o,o as u,b as s,n as i,t as a,e as g,l as p}from"./main-m3XtP3uI.js";const S={key:0,class:"debug-info"},_={class:"debug-section"},E={class:"debug-item"},O={class:"debug-section"},W={class:"debug-item"},x={class:"debug-item"},R={key:0,class:"debug-item"},$={key:1,class:"debug-item"},B={key:2,class:"debug-item"},H={key:3,class:"debug-item"},L={key:4,class:"debug-item"},Y={class:"debug-section"},V={class:"debug-item"},j={class:"debug-item"},z={class:"debug-item"},G={class:"debug-section"},J=["disabled"],K={key:0,class:"debug-item"},X={__name:"DebugInfo",setup(q){const b=T(!1),m=T(!1),l=T(null),v=n(()=>"https://sparkling-cupcake-940504.netlify.app/.netlify/functions"),h=n(()=>{var t;return!!((t=window.Telegram)!=null&&t.WebApp)}),r=n(()=>{var t,e;return!!((e=(t=window.Telegram)==null?void 0:t.WebApp)!=null&&e.initData)}),I=n(()=>{var t,e,d;return((d=(e=(t=window.Telegram)==null?void 0:t.WebApp)==null?void 0:e.initData)==null?void 0:d.length)||0}),c=n(()=>{if(!r.value)return null;try{return new URLSearchParams(window.Telegram.WebApp.initData)}catch{return null}}),D=n(()=>c.value?!!c.value.get("hash"):!1),k=n(()=>c.value?!!c.value.get("user"):!1),f=n(()=>{if(!k.value)return null;try{const t=c.value.get("user");return JSON.parse(decodeURIComponent(t))}catch{return null}}),y=n(()=>"production"),P=n(()=>navigator.platform),A=n(()=>navigator.userAgent.includes("Telegram")||window.TelegramWebviewProxy!==void 0),C=async()=>{m.value=!0,l.value=null;try{if(console.log("[DebugInfo] Testing API connection..."),!v.value){l.value={success:!1,message:"API Base URL not configured ❌"};return}const t=`${v.value}/health-check`;console.log("[DebugInfo] Testing health-check:",t);const e=await fetch(t,{method:"GET",headers:{"Content-Type":"application/json"}});if(!e.ok){l.value={success:!1,message:`Health check failed: ${e.status} ❌`};return}if(r.value){console.log("[DebugInfo] Testing user-profile with real initData...");const d=`${v.value}/user-profile`,w=await fetch(d,{method:"POST",headers:{"Content-Type":"application/json","X-Telegram-Init-Data":window.Telegram.WebApp.initData}});if(w.ok)l.value={success:!0,message:"API connection and auth working! ✅"};else{const N=await w.text();l.value={success:!1,message:`Auth failed: ${N} ❌`}}}else l.value={success:!1,message:"Health check OK but no initData for auth test ⚠️"}}catch(t){console.error("[DebugInfo] API test error:",t),l.value={success:!1,message:`Network error: ${t.message} ❌`}}finally{m.value=!1}};return(t,e)=>b.value?(u(),o("div",S,[e[18]||(e[18]=s("h3",null,"🔍 Debug Information",-1)),s("div",_,[e[3]||(e[3]=s("h4",null,"📡 API Configuration",-1)),s("div",E,[e[2]||(e[2]=s("strong",null,"API Base URL:",-1)),s("span",{class:i(v.value?"status-ok":"status-error")},a(v.value||"NOT SET ❌"),3)])]),s("div",O,[e[11]||(e[11]=s("h4",null,"🤖 Telegram WebApp",-1)),s("div",W,[e[4]||(e[4]=s("strong",null,"WebApp Available:",-1)),s("span",{class:i(h.value?"status-ok":"status-error")},a(h.value?"YES ✅":"NO ❌"),3)]),s("div",x,[e[5]||(e[5]=s("strong",null,"InitData Available:",-1)),s("span",{class:i(r.value?"status-ok":"status-error")},a(r.value?"YES ✅":"NO ❌"),3)]),r.value?(u(),o("div",R,[e[6]||(e[6]=s("strong",null,"InitData Length:",-1)),p(" "+a(I.value),1)])):g("",!0),r.value?(u(),o("div",$,[e[7]||(e[7]=s("strong",null,"Has Hash:",-1)),s("span",{class:i(D.value?"status-ok":"status-error")},a(D.value?"YES ✅":"NO ❌"),3)])):g("",!0),r.value?(u(),o("div",B,[e[8]||(e[8]=s("strong",null,"Has User Data:",-1)),s("span",{class:i(k.value?"status-ok":"status-error")},a(k.value?"YES ✅":"NO ❌"),3)])):g("",!0),f.value?(u(),o("div",H,[e[9]||(e[9]=s("strong",null,"User ID:",-1)),p(" "+a(f.value.id),1)])):g("",!0),f.value?(u(),o("div",L,[e[10]||(e[10]=s("strong",null,"Username:",-1)),p(" "+a(f.value.username||"N/A"),1)])):g("",!0)]),s("div",Y,[e[15]||(e[15]=s("h4",null,"🌍 Environment",-1)),s("div",V,[e[12]||(e[12]=s("strong",null,"Environment:",-1)),p(" "+a(y.value),1)]),s("div",j,[e[13]||(e[13]=s("strong",null,"Platform:",-1)),p(" "+a(P.value),1)]),s("div",z,[e[14]||(e[14]=s("strong",null,"In Telegram:",-1)),s("span",{class:i(A.value?"status-ok":"status-warning")},a(A.value?"YES ✅":"NO ⚠️"),3)])]),s("div",G,[e[17]||(e[17]=s("h4",null,"🔗 API Test",-1)),s("button",{onClick:C,disabled:m.value,class:"test-button"},a(m.value?"Testing...":"Test API Connection"),9,J),l.value?(u(),o("div",K,[e[16]||(e[16]=s("strong",null,"API Test:",-1)),s("span",{class:i(l.value.success?"status-ok":"status-error")},a(l.value.message),3)])):g("",!0)]),s("button",{onClick:e[0]||(e[0]=d=>b.value=!1),class:"close-debug"},"Close Debug")])):(u(),o("button",{key:1,onClick:e[1]||(e[1]=d=>b.value=!0),class:"show-debug"},"🔍 Debug"))}},Q=U(X,[["__scopeId","data-v-e9c30779"]]);export{Q as default};
