import{m as P,r as h,h as C,Q as S,y as g,a as c,o as r,b as o,q as t,n as p,F as f,A as v,t as d,l as x,C as y}from"./main-P60yZklw.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const F={class:"modal-content rounded-xl bg-gradient-to-br from-[#5461FF] to-[#4857FF] text-white"},D={class:"tabs"},$={class:"duration-options"},A=["value","checked","disabled","onChange"],V={class:"months"},I={class:"price"},E={class:"total-price"},N={key:1,class:"price"},T={class:"features-list"},U={__name:"SubscriptionModal",emits:["close"],setup(q,{emit:B}){var M;const n=P(),{getPlanDetails:a}=n,e=(M=window.Telegram)==null?void 0:M.WebApp,k=B,m=h(!1);C(()=>{m.value=!0,console.log("[SubscriptionModal] Component mounted")});const b=()=>{k("close")},u=()=>{var l;console.log("[SubscriptionModal] Main Button clicked!"),(l=e==null?void 0:e.MainButton)!=null&&l.isActive?n.initiatePayment():console.warn("[SubscriptionModal] Main Button clicked but it was inactive.")};return S(()=>{var i;if(!e||!m.value){(i=e==null?void 0:e.MainButton)!=null&&i.isVisible&&(console.log("[SubscriptionModal] Hiding Main Button (not mounted or no tg)"),e.MainButton.hide(),e.MainButton.offClick(u));return}const l=n.selectedInvoiceAmount;l?(console.log(`[SubscriptionModal] Setting Main Button: Pay ${l} Stars`),e.MainButton.setParams({text:`Оплатить ${l} ⭐`,color:e.themeParams.button_color||"#2481CC",text_color:e.themeParams.button_text_color||"#ffffff",is_active:!0,is_visible:!0}),e.MainButton.offClick(u),e.MainButton.onClick(u)):(console.log("[SubscriptionModal] Setting Main Button: Inactive (no amount)"),e.MainButton.setParams({text:"Выберите план",is_active:!1,is_visible:!0}),e.MainButton.offClick(u))}),g(()=>{var l;(l=e==null?void 0:e.MainButton)!=null&&l.isVisible&&(e.MainButton.hide(),e.MainButton.offClick(u),console.log("[SubscriptionModal] Main Button hidden on modal unmount.")),m.value=!1}),(l,i)=>(r(),c("div",{class:"modal-overlay",onClick:y(b,["self"])},[o("div",F,[o("button",{class:"close-button",onClick:b},"×"),i[4]||(i[4]=o("h2",{class:"text-2xl font-bold mb-6"},"Выберите план подписки",-1)),o("div",D,[o("button",{class:p({active:t(n).selectedPlan==="basic"}),onClick:i[0]||(i[0]=s=>t(n).selectPlan("basic"))}," Basic ",2),o("button",{class:p({active:t(n).selectedPlan==="premium"}),onClick:i[1]||(i[1]=s=>t(n).selectPlan("premium"))}," Premium ",2)]),o("div",$,[(r(),c(f,null,v([1,3,12],s=>o("label",{key:s,class:"duration-label"},[o("input",{type:"radio",name:"duration",value:s,checked:t(n).selectedDuration===s,disabled:!t(a)(t(n).selectedPlan,s).price,onChange:_=>t(n).selectDuration(s)},null,40,A),o("div",{class:p(["duration-card",{disabled:!t(a)(t(n).selectedPlan,s).price}])},[o("span",V,d(s)+" "+d(s>1?s<5?"месяца":"месяцев":"месяц"),1),t(a)(t(n).selectedPlan,s).price?(r(),c(f,{key:0},[o("span",I,d((t(a)(t(n).selectedPlan,s).price/s).toFixed(0))+" / мес ",1),o("span",E,[x(" Всего: "+d(t(a)(t(n).selectedPlan,s).price)+" ",1),i[2]||(i[2]=o("span",{class:"stars-icon"},"⭐",-1))])],64)):(r(),c("span",N,"Не настроено"))],2)])),64))]),o("div",T,[i[3]||(i[3]=o("h3",null,"Что вы получаете:",-1)),o("ul",null,[(r(!0),c(f,null,v(t(a)(t(n).selectedPlan,t(n).selectedDuration).features,(s,_)=>(r(),c("li",{key:_}," ✔️ "+d(s),1))),128))])])])]))}},L=w(U,[["__scopeId","data-v-0a4b7b5c"]]);export{L as default};
