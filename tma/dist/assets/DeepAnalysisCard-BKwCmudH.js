import{d as P,r as c,E as T,a as l,o as d,b as n,e as h,s as x,t as A,C as F,n as C}from"./main-BzUusOzE.js";import{L as D}from"./PersonalAccount-CI8AfEN2.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const z={class:"px-8 md:px-16 py-2"},B={key:0,class:"mt-4"},N={key:1,class:"mt-4 p-4 bg-blue-500/20 rounded-lg text-sm flex items-center gap-2"},V={key:2,class:"mt-4 p-4 bg-red-500/20 rounded-lg text-sm"},I={key:3,class:"mt-4 p-4 bg-green-500/20 rounded-lg text-sm"},L=P({__name:"DeepAnalysisCard",props:["userStore"],setup(s){const a=s,u=c(!1),p=c(0),m=c(0),g=c([{title:"Сбор данных",description:"Получение последних 5 снов",duration:"2-3 сек"},{title:"Анализ паттернов",description:"Поиск повторяющихся тем",duration:"8-12 сек"},{title:"Глубокая интерпретация",description:"Психологический анализ",duration:"10-15 сек"},{title:"Формирование отчета",description:"Создание персонального анализа",duration:"3-5 сек"}]);T(()=>{var t;return(t=a.userStore)==null?void 0:t.isDoingDeepAnalysis},t=>{t?(p.value=0,m.value=0,k()):setTimeout(()=>{p.value=0,m.value=0,g.value.forEach(e=>e.status="pending")},2e3)});const k=()=>{const t=(e,r)=>{m.value=e,p.value=r,g.value.forEach((i,o)=>{o<e?i.status="completed":o===e?i.status="loading":i.status="pending"})};setTimeout(()=>t(0,15),500),setTimeout(()=>t(1,35),2e3),setTimeout(()=>t(2,65),5e3),setTimeout(()=>t(3,90),12e3)},_=()=>{u.value=!u.value,window.triggerHaptic&&window.triggerHaptic("light")},E=()=>{var t,e,r,i,o;(t=a.userStore)!=null&&t.canAttemptDeepAnalysis&&(window.triggerHaptic&&window.triggerHaptic("medium"),(((r=(e=a.userStore)==null?void 0:e.profile)==null?void 0:r.deep_analysis_credits)||0)>0||(((o=(i=a.userStore)==null?void 0:i.profile)==null?void 0:o.free_deep_analysis)||0)>0?a.userStore.performDeepAnalysis():a.userStore.initiateDeepAnalysisPayment())};return(t,e)=>{var r,i,o,f,y,v,S,w,b;return d(),l("article",{class:C(["relative rounded-xl bg-gradient-to-br from-[#9C41FF] to-[#C03AFF] text-white overflow-hidden transition-all cursor-pointer py-6",[u.value?"pb-20":"min-h-[8rem]"]]),onClick:_},[n("div",z,[e[1]||(e[1]=n("h3",{class:"text-xl font-bold"},"Глубокий Анализ",-1)),e[2]||(e[2]=n("p",{class:"mt-1"},"Получите комплексный анализ ваших последних 5 снов.",-1)),(r=s.userStore)!=null&&r.isInitiatingDeepPayment?(d(),l("div",B,[x(D,{size:"xs",variant:"white",label:"Создаем счёт..."})])):h("",!0),(i=s.userStore)!=null&&i.deepAnalysisProcessing?(d(),l("div",N,[x(D,{size:"xs",variant:"white"}),e[0]||(e[0]=n("span",null,"Анализ запущен! Вы получите уведомление в боте, когда анализ будет готов. Обычно это занимает 1-2 минуты.",-1))])):(o=s.userStore)!=null&&o.deepAnalysisError?(d(),l("div",V," ⚠️ "+A(s.userStore.deepAnalysisError),1)):(f=s.userStore)!=null&&f.deepAnalysisSuccess?(d(),l("div",I," ✅ Глубокий анализ готов! Результат доступен во вкладке «Глубокий анализ» ниже. ")):h("",!0)]),n("div",{class:C(["absolute left-4 right-4 transition-all duration-300",u.value&&((y=s.userStore)!=null&&y.canAttemptDeepAnalysis)?"bottom-4 opacity-100":"-bottom-24 opacity-0 pointer-events-none"])},[n("button",{class:"w-full bg-white/20 hover:bg-white/30 text-white rounded-xl py-3 font-semibold transition-colors",onClick:F(E,["stop"])},A((((S=(v=s.userStore)==null?void 0:v.profile)==null?void 0:S.deep_analysis_credits)||0)>0||(((b=(w=s.userStore)==null?void 0:w.profile)==null?void 0:b.free_deep_analysis)||0)>0?"Выполнить анализ":"Получить анализ (1 ⭐️)"),1)],2)],2)}}}),j=H(L,[["__scopeId","data-v-9dd29088"]]);export{j as default};
