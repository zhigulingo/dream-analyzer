import{m as P,r as C,h,Q as S,y as g,a as c,o as u,b as n,q as t,n as p,F as f,A as v,t as d,l as y,C as x}from"./main-CIkE7lWC.js";import{_ as w}from"./_plugin-vue_export-helper-DlAUqK2U.js";const D={class:"modal-content"},$={class:"tabs"},A={class:"duration-options"},V=["value","checked","disabled","onChange"],F={class:"months"},I={class:"price"},E={class:"total-price"},N={key:1,class:"price"},T={class:"features-list"},U={__name:"SubscriptionModal",emits:["close"],setup(q,{emit:B}){var b;const o=P(),{getPlanDetails:a}=o,e=(b=window.Telegram)==null?void 0:b.WebApp,k=B,m=C(!1);h(()=>{m.value=!0,console.log("[SubscriptionModal] Component mounted")});const M=()=>{k("close")},r=()=>{var l;console.log("[SubscriptionModal] Main Button clicked!"),(l=e==null?void 0:e.MainButton)!=null&&l.isActive?o.initiatePayment():console.warn("[SubscriptionModal] Main Button clicked but it was inactive.")};return S(()=>{var i;if(!e||!m.value){(i=e==null?void 0:e.MainButton)!=null&&i.isVisible&&(console.log("[SubscriptionModal] Hiding Main Button (not mounted or no tg)"),e.MainButton.hide(),e.MainButton.offClick(r));return}const l=o.selectedInvoiceAmount;l?(console.log(`[SubscriptionModal] Setting Main Button: Pay ${l} Stars`),e.MainButton.setParams({text:`Оплатить ${l} ⭐`,color:e.themeParams.button_color||"#2481CC",text_color:e.themeParams.button_text_color||"#ffffff",is_active:!0,is_visible:!0}),e.MainButton.offClick(r),e.MainButton.onClick(r)):(console.log("[SubscriptionModal] Setting Main Button: Inactive (no amount)"),e.MainButton.setParams({text:"Выберите план",is_active:!1,is_visible:!0}),e.MainButton.offClick(r))}),g(()=>{var l;(l=e==null?void 0:e.MainButton)!=null&&l.isVisible&&(e.MainButton.hide(),e.MainButton.offClick(r),console.log("[SubscriptionModal] Main Button hidden on modal unmount.")),m.value=!1}),(l,i)=>(u(),c("div",{class:"modal-overlay",onClick:x(M,["self"])},[n("div",D,[n("button",{class:"close-button",onClick:M},"×"),i[4]||(i[4]=n("h2",null,"Выберите план подписки",-1)),n("div",$,[n("button",{class:p({active:t(o).selectedPlan==="basic"}),onClick:i[0]||(i[0]=s=>t(o).selectPlan("basic"))}," Basic ",2),n("button",{class:p({active:t(o).selectedPlan==="premium"}),onClick:i[1]||(i[1]=s=>t(o).selectPlan("premium"))}," Premium ",2)]),n("div",A,[(u(),c(f,null,v([1,3,12],s=>n("label",{key:s,class:"duration-label"},[n("input",{type:"radio",name:"duration",value:s,checked:t(o).selectedDuration===s,disabled:!t(a)(t(o).selectedPlan,s).price,onChange:_=>t(o).selectDuration(s)},null,40,V),n("div",{class:p(["duration-card",{disabled:!t(a)(t(o).selectedPlan,s).price}])},[n("span",F,d(s)+" "+d(s>1?s<5?"месяца":"месяцев":"месяц"),1),t(a)(t(o).selectedPlan,s).price?(u(),c(f,{key:0},[n("span",I,d((t(a)(t(o).selectedPlan,s).price/s).toFixed(0))+" / мес ",1),n("span",E,[y(" Всего: "+d(t(a)(t(o).selectedPlan,s).price)+" ",1),i[2]||(i[2]=n("span",{class:"stars-icon"},"⭐",-1))])],64)):(u(),c("span",N,"Не настроено"))],2)])),64))]),n("div",T,[i[3]||(i[3]=n("h3",null,"Что вы получаете:",-1)),n("ul",null,[(u(!0),c(f,null,v(t(a)(t(o).selectedPlan,t(o).selectedDuration).features,(s,_)=>(u(),c("li",{key:_}," ✔️ "+d(s),1))),128))])])])]))}},L=w(U,[["__scopeId","data-v-81f4318f"]]);export{L as default};
