import{b as dt,c as E,e as j,f as k,n as nt,g as O,h as rt,t as G,y as it,r as tt,F as at,v as ut,m as lt}from"./main-D9q8tcSZ.js";var st=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ft($){return $&&$.__esModule&&Object.prototype.hasOwnProperty.call($,"default")?$.default:$}var ht={exports:{}};(function($,B){(function(d,y){$.exports=y()})(st,function(){var d=1e3,y=6e4,C=36e5,v="millisecond",w="second",M="minute",H="hour",l="day",u="week",c="month",_="quarter",x="year",a="date",p="Invalid Date",S=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,T=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,F={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var r=["th","st","nd","rd"],t=i%100;return"["+i+(r[(t-20)%10]||r[t]||r[0])+"]"}},I=function(i,r,t){var n=String(i);return!n||n.length>=r?i:""+Array(r+1-n.length).join(t)+i},N={s:I,z:function(i){var r=-i.utcOffset(),t=Math.abs(r),n=Math.floor(t/60),e=t%60;return(r<=0?"+":"-")+I(n,2,"0")+":"+I(e,2,"0")},m:function i(r,t){if(r.date()<t.date())return-i(t,r);var n=12*(t.year()-r.year())+(t.month()-r.month()),e=r.clone().add(n,c),s=t-e<0,o=r.clone().add(n+(s?-1:1),c);return+(-(n+(t-e)/(s?e-o:o-e))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:c,y:x,w:u,d:l,D:a,h:H,m:M,s:w,ms:v,Q:_}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},f="en",Y={};Y[f]=F;var P="$isDayjsObject",U=function(i){return i instanceof K||!(!i||!i[P])},Q=function i(r,t,n){var e;if(!r)return f;if(typeof r=="string"){var s=r.toLowerCase();Y[s]&&(e=s),t&&(Y[s]=t,e=s);var o=r.split("-");if(!e&&o.length>1)return i(o[0])}else{var m=r.name;Y[m]=r,e=m}return!n&&e&&(f=e),e||!n&&f},b=function(i,r){if(U(i))return i.clone();var t=typeof r=="object"?r:{};return t.date=i,t.args=arguments,new K(t)},h=N;h.l=Q,h.i=U,h.w=function(i,r){return b(i,{locale:r.$L,utc:r.$u,x:r.$x,$offset:r.$offset})};var K=function(){function i(t){this.$L=Q(t.locale,null,!0),this.parse(t),this.$x=this.$x||t.x||{},this[P]=!0}var r=i.prototype;return r.parse=function(t){this.$d=function(n){var e=n.date,s=n.utc;if(e===null)return new Date(NaN);if(h.u(e))return new Date;if(e instanceof Date)return new Date(e);if(typeof e=="string"&&!/Z$/i.test(e)){var o=e.match(S);if(o){var m=o[2]-1||0,g=(o[7]||"0").substring(0,3);return s?new Date(Date.UTC(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,g)):new Date(o[1],m,o[3]||1,o[4]||0,o[5]||0,o[6]||0,g)}}return new Date(e)}(t),this.init()},r.init=function(){var t=this.$d;this.$y=t.getFullYear(),this.$M=t.getMonth(),this.$D=t.getDate(),this.$W=t.getDay(),this.$H=t.getHours(),this.$m=t.getMinutes(),this.$s=t.getSeconds(),this.$ms=t.getMilliseconds()},r.$utils=function(){return h},r.isValid=function(){return this.$d.toString()!==p},r.isSame=function(t,n){var e=b(t);return this.startOf(n)<=e&&e<=this.endOf(n)},r.isAfter=function(t,n){return b(t)<this.startOf(n)},r.isBefore=function(t,n){return this.endOf(n)<b(t)},r.$g=function(t,n,e){return h.u(t)?this[n]:this.set(e,t)},r.unix=function(){return Math.floor(this.valueOf()/1e3)},r.valueOf=function(){return this.$d.getTime()},r.startOf=function(t,n){var e=this,s=!!h.u(n)||n,o=h.p(t),m=function(J,A){var z=h.w(e.$u?Date.UTC(e.$y,A,J):new Date(e.$y,A,J),e);return s?z:z.endOf(l)},g=function(J,A){return h.w(e.toDate()[J].apply(e.toDate("s"),(s?[0,0,0,0]:[23,59,59,999]).slice(A)),e)},D=this.$W,L=this.$M,W=this.$D,Z="set"+(this.$u?"UTC":"");switch(o){case x:return s?m(1,0):m(31,11);case c:return s?m(1,L):m(0,L+1);case u:var V=this.$locale().weekStart||0,R=(D<V?D+7:D)-V;return m(s?W-R:W+(6-R),L);case l:case a:return g(Z+"Hours",0);case H:return g(Z+"Minutes",1);case M:return g(Z+"Seconds",2);case w:return g(Z+"Milliseconds",3);default:return this.clone()}},r.endOf=function(t){return this.startOf(t,!1)},r.$set=function(t,n){var e,s=h.p(t),o="set"+(this.$u?"UTC":""),m=(e={},e[l]=o+"Date",e[a]=o+"Date",e[c]=o+"Month",e[x]=o+"FullYear",e[H]=o+"Hours",e[M]=o+"Minutes",e[w]=o+"Seconds",e[v]=o+"Milliseconds",e)[s],g=s===l?this.$D+(n-this.$W):n;if(s===c||s===x){var D=this.clone().set(a,1);D.$d[m](g),D.init(),this.$d=D.set(a,Math.min(this.$D,D.daysInMonth())).$d}else m&&this.$d[m](g);return this.init(),this},r.set=function(t,n){return this.clone().$set(t,n)},r.get=function(t){return this[h.p(t)]()},r.add=function(t,n){var e,s=this;t=Number(t);var o=h.p(n),m=function(L){var W=b(s);return h.w(W.date(W.date()+Math.round(L*t)),s)};if(o===c)return this.set(c,this.$M+t);if(o===x)return this.set(x,this.$y+t);if(o===l)return m(1);if(o===u)return m(7);var g=(e={},e[M]=y,e[H]=C,e[w]=d,e)[o]||1,D=this.$d.getTime()+t*g;return h.w(D,this)},r.subtract=function(t,n){return this.add(-1*t,n)},r.format=function(t){var n=this,e=this.$locale();if(!this.isValid())return e.invalidDate||p;var s=t||"YYYY-MM-DDTHH:mm:ssZ",o=h.z(this),m=this.$H,g=this.$m,D=this.$M,L=e.weekdays,W=e.months,Z=e.meridiem,V=function(A,z,q,X){return A&&(A[z]||A(n,s))||q[z].slice(0,X)},R=function(A){return h.s(m%12||12,A,"0")},J=Z||function(A,z,q){var X=A<12?"AM":"PM";return q?X.toLowerCase():X};return s.replace(T,function(A,z){return z||function(q){switch(q){case"YY":return String(n.$y).slice(-2);case"YYYY":return h.s(n.$y,4,"0");case"M":return D+1;case"MM":return h.s(D+1,2,"0");case"MMM":return V(e.monthsShort,D,W,3);case"MMMM":return V(W,D);case"D":return n.$D;case"DD":return h.s(n.$D,2,"0");case"d":return String(n.$W);case"dd":return V(e.weekdaysMin,n.$W,L,2);case"ddd":return V(e.weekdaysShort,n.$W,L,3);case"dddd":return L[n.$W];case"H":return String(m);case"HH":return h.s(m,2,"0");case"h":return R(1);case"hh":return R(2);case"a":return J(m,g,!0);case"A":return J(m,g,!1);case"m":return String(g);case"mm":return h.s(g,2,"0");case"s":return String(n.$s);case"ss":return h.s(n.$s,2,"0");case"SSS":return h.s(n.$ms,3,"0");case"Z":return o}return null}(A)||o.replace(":","")})},r.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},r.diff=function(t,n,e){var s,o=this,m=h.p(n),g=b(t),D=(g.utcOffset()-this.utcOffset())*y,L=this-g,W=function(){return h.m(o,g)};switch(m){case x:s=W()/12;break;case c:s=W();break;case _:s=W()/3;break;case u:s=(L-D)/6048e5;break;case l:s=(L-D)/864e5;break;case H:s=L/C;break;case M:s=L/y;break;case w:s=L/d;break;default:s=L}return e?s:h.a(s)},r.daysInMonth=function(){return this.endOf(c).$D},r.$locale=function(){return Y[this.$L]},r.locale=function(t,n){if(!t)return this.$L;var e=this.clone(),s=Q(t,n,!0);return s&&(e.$L=s),e},r.clone=function(){return h.w(this.$d,this)},r.toDate=function(){return new Date(this.valueOf())},r.toJSON=function(){return this.isValid()?this.toISOString():null},r.toISOString=function(){return this.$d.toISOString()},r.toString=function(){return this.$d.toUTCString()},i}(),ot=K.prototype;return b.prototype=ot,[["$ms",v],["$s",w],["$m",M],["$H",H],["$W",l],["$M",c],["$y",x],["$D",a]].forEach(function(i){ot[i[1]]=function(r){return this.$g(r,i[0],i[1])}}),b.extend=function(i,r){return i.$i||(i(r,K,b),i.$i=!0),b},b.locale=Q,b.isDayjs=U,b.unix=function(i){return b(1e3*i)},b.en=Y[f],b.Ls=Y,b.p={},b})})(ht);var mt=ht.exports;const et=ft(mt);var pt={exports:{}};(function($,B){(function(d,y){$.exports=y()})(st,function(){return function(d,y,C){d=d||{};var v=y.prototype,w={future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function M(l,u,c,_){return v.fromToBase(l,u,c,_)}C.en.relativeTime=w,v.fromToBase=function(l,u,c,_,x){for(var a,p,S,T=c.$locale().relativeTime||w,F=d.thresholds||[{l:"s",r:44,d:"second"},{l:"m",r:89},{l:"mm",r:44,d:"minute"},{l:"h",r:89},{l:"hh",r:21,d:"hour"},{l:"d",r:35},{l:"dd",r:25,d:"day"},{l:"M",r:45},{l:"MM",r:10,d:"month"},{l:"y",r:17},{l:"yy",d:"year"}],I=F.length,N=0;N<I;N+=1){var f=F[N];f.d&&(a=_?C(l).diff(c,f.d,!0):c.diff(l,f.d,!0));var Y=(d.rounding||Math.round)(Math.abs(a));if(S=a>0,Y<=f.r||!f.r){Y<=1&&N>0&&(f=F[N-1]);var P=T[f.l];x&&(Y=x(""+Y)),p=typeof P=="string"?P.replace("%d",Y):P(Y,u,f.l,S);break}}if(u)return p;var U=S?T.future:T.past;return typeof U=="function"?U(p):U.replace("%s",p)},v.to=function(l,u){return M(l,u,this,!0)},v.from=function(l,u){return M(l,u,this)};var H=function(l){return l.$u?C.utc():C()};v.toNow=function(l){return this.to(H(this),l)},v.fromNow=function(l){return this.from(H(this),l)}}})})(pt);var vt=pt.exports;const _t=ft(vt);var gt={exports:{}};(function($,B){(function(d,y){$.exports=y(mt)})(st,function(d){function y(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var C=y(d),v="января_февраля_марта_апреля_мая_июня_июля_августа_сентября_октября_ноября_декабря".split("_"),w="январь_февраль_март_апрель_май_июнь_июль_август_сентябрь_октябрь_ноябрь_декабрь".split("_"),M="янв._февр._мар._апр._мая_июня_июля_авг._сент._окт._нояб._дек.".split("_"),H="янв._февр._март_апр._май_июнь_июль_авг._сент._окт._нояб._дек.".split("_"),l=/D[oD]?(\[[^[\]]*\]|\s)+MMMM?/;function u(a,p,S){var T,F;return S==="m"?p?"минута":"минуту":a+" "+(T=+a,F={mm:p?"минута_минуты_минут":"минуту_минуты_минут",hh:"час_часа_часов",dd:"день_дня_дней",MM:"месяц_месяца_месяцев",yy:"год_года_лет"}[S].split("_"),T%10==1&&T%100!=11?F[0]:T%10>=2&&T%10<=4&&(T%100<10||T%100>=20)?F[1]:F[2])}var c=function(a,p){return l.test(p)?v[a.month()]:w[a.month()]};c.s=w,c.f=v;var _=function(a,p){return l.test(p)?M[a.month()]:H[a.month()]};_.s=H,_.f=M;var x={name:"ru",weekdays:"воскресенье_понедельник_вторник_среда_четверг_пятница_суббота".split("_"),weekdaysShort:"вск_пнд_втр_срд_чтв_птн_сбт".split("_"),weekdaysMin:"вс_пн_вт_ср_чт_пт_сб".split("_"),months:c,monthsShort:_,weekStart:1,yearStart:4,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD.MM.YYYY",LL:"D MMMM YYYY г.",LLL:"D MMMM YYYY г., H:mm",LLLL:"dddd, D MMMM YYYY г., H:mm"},relativeTime:{future:"через %s",past:"%s назад",s:"несколько секунд",m:u,mm:u,h:"час",hh:u,d:"день",dd:u,M:"месяц",MM:u,y:"год",yy:u},ordinal:function(a){return a},meridiem:function(a){return a<4?"ночи":a<12?"утра":a<17?"дня":"вечера"}};return C.default.locale(x,null,!0),x})})(gt);const yt={class:"truncate"},$t={class:"bg-white/10 rounded-full px-2 py-1 text-sm min-w-[3rem] text-center whitespace-nowrap"},wt={key:0,class:"mt-4 space-y-3 text-sm"},Mt={class:"leading-snug opacity-90"},xt={class:"leading-snug opacity-90"},bt={class:"mt-4 flex gap-2"},ct=dt({__name:"DreamCard",props:{dream:{},active:{type:Boolean}},emits:["toggle"],setup($,{emit:B}){et.extend(_t),et.locale("ru");const d=$,y=B,C=()=>{y("toggle"),window.triggerHaptic&&window.triggerHaptic("light")},v=()=>{window.triggerHaptic&&window.triggerHaptic("medium")},w=()=>{window.triggerHaptic&&window.triggerHaptic("medium")},M=()=>{window.triggerHaptic&&window.triggerHaptic("heavy")},H=E(()=>d.dream.dream_text?d.dream.dream_text.length>50?d.dream.dream_text.substring(0,47)+"...":d.dream.dream_text:"Без названия"),l=E(()=>{if(!d.dream.created_at)return"";try{const u=et(d.dream.created_at),_=et().diff(u,"day"),x=Math.floor(_/7),a=Math.floor(_/30),p=Math.floor(_/365);return _===0?"сегодня":_===1?"вчера":_<7?`${_} д`:_<30?`${x} н`:_<365?`${a} м`:`${p} г`}catch{return d.dream.created_at}});return(u,c)=>(k(),j("article",{class:nt(["rounded-xl bg-gradient-to-br from-[#4A58FF] to-[#5664FF] text-white px-8 md:px-16 transition-all overflow-hidden cursor-pointer",[u.active?"pb-20":"py-6 h-[4.5rem]"]]),onClick:C},[O("div",{class:nt(["flex justify-between items-center",[u.active?"pt-8":""]])},[O("h3",yt,G(H.value),1),O("span",$t,G(l.value),1)],2),u.active?(k(),j("div",wt,[O("div",null,[c[0]||(c[0]=O("h4",{class:"font-semibold mb-1"},"Сон:",-1)),O("p",Mt,G(u.dream.dream_text),1)]),O("div",null,[c[1]||(c[1]=O("h4",{class:"font-semibold mb-1"},"Анализ:",-1)),O("p",xt,G(u.dream.analysis),1)]),O("div",bt,[O("button",{class:"flex-1 bg-white/20 hover:bg-white/30 text-white rounded-xl py-2 text-sm font-medium transition-colors",onClick:it(v,["stop"])}," 👍 Нравится "),O("button",{class:"flex-1 bg-white/20 hover:bg-white/30 text-white rounded-xl py-2 text-sm font-medium transition-colors",onClick:it(w,["stop"])}," 👎 Не нравится "),O("button",{class:"flex-1 bg-red-500/20 hover:bg-red-500/30 text-white rounded-xl py-2 text-sm font-medium transition-colors",onClick:it(M,["stop"])}," 🗑️ Удалить ")])])):rt("",!0)],2))}}),Dt={class:"flex items-center mb-4 gap-4"},St={key:0,class:"text-center text-white/60 py-8"},kt={key:1,class:"text-center text-red-400 py-8"},Ht={key:2},Tt={key:0,class:"text-center text-white/60 py-8"},Yt={key:1,class:"flex flex-col gap-4 pb-[5vh]"},Lt={key:3},Ot={key:0,class:"text-center text-white/60 py-8"},Ct={key:1,class:"flex flex-col gap-4 pb-[5vh]"},At=dt({__name:"AnalysisHistoryList",props:["userStore"],setup($){const B=$,d=tt(null),y=tt(5),C=tt(5),v=tt("history"),w=E(()=>{var p;return(p=B.userStore)!=null&&p.history?B.userStore.history.filter(S=>!S.is_deep_analysis):[]}),M=E(()=>{var p;return(p=B.userStore)!=null&&p.history?B.userStore.history.filter(S=>S.is_deep_analysis):[]}),H=E(()=>w.value.slice(0,y.value)),l=E(()=>M.value.slice(0,C.value)),u=E(()=>w.value.length>y.value),c=E(()=>M.value.length>C.value),_=()=>{window.triggerHaptic&&window.triggerHaptic("light"),y.value+=5},x=()=>{window.triggerHaptic&&window.triggerHaptic("light"),C.value+=5},a=p=>{window.triggerHaptic&&window.triggerHaptic("light"),v.value=p,d.value=null};return(p,S)=>{var T,F,I,N;return k(),j("div",null,[O("div",Dt,[O("h2",{class:nt(["text-2xl font-semibold text-white cursor-pointer transition-opacity",{"opacity-100":v.value==="history","opacity-60":v.value!=="history"}]),onClick:S[0]||(S[0]=f=>a("history"))}," История снов ",2),O("h3",{class:nt(["text-lg font-medium text-white cursor-pointer transition-opacity",{"opacity-100":v.value==="deep","opacity-60":v.value!=="deep"}]),onClick:S[1]||(S[1]=f=>a("deep"))}," Глубокий анализ ",2)]),(T=$.userStore)!=null&&T.isLoadingHistory?(k(),j("div",St," Загрузка истории... ")):(F=$.userStore)!=null&&F.errorHistory?(k(),j("div",kt," Ошибка загрузки: "+G($.userStore.errorHistory),1)):v.value==="history"?(k(),j("div",Ht,[(I=w.value)!=null&&I.length?(k(),j("div",Yt,[(k(!0),j(at,null,ut(H.value,f=>(k(),lt(ct,{key:f.id,dream:f,active:d.value===f.id,onToggle:Y=>d.value=d.value===f.id?null:f.id},null,8,["dream","active","onToggle"]))),128)),u.value?(k(),j("button",{key:0,class:"self-center bg-white/10 rounded-full px-4 py-2 text-sm font-medium text-white hover:bg-white/20 transition-colors my-2",onClick:_}," Загрузить ещё ")):rt("",!0)])):(k(),j("div",Tt," У вас пока нет сохраненных анализов "))])):v.value==="deep"?(k(),j("div",Lt,[(N=M.value)!=null&&N.length?(k(),j("div",Ct,[(k(!0),j(at,null,ut(l.value,f=>(k(),lt(ct,{key:f.id,dream:f,active:d.value===f.id,onToggle:Y=>d.value=d.value===f.id?null:f.id},null,8,["dream","active","onToggle"]))),128)),c.value?(k(),j("button",{key:0,class:"self-center bg-white/10 rounded-full px-4 py-2 text-sm font-medium text-white hover:bg-white/20 transition-colors my-2",onClick:x}," Загрузить ещё ")):rt("",!0)])):(k(),j("div",Ot," Пока нет глубоких анализов "))])):rt("",!0)])}}});export{At as default};
