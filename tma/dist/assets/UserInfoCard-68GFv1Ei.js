import{b as W,c as g,e as a,f as s,n as k,k as q,g as i,l as V,F as x,v as P,r as I,m as B,h as p,q as w,t as y,w as $,p as D,y as E,A as O}from"./main-D9q8tcSZ.js";import{_ as F}from"./Badge.vue_vue_type_script_setup_true_lang-BirWIC9Q.js";import{L as N}from"./PersonalAccount-BEqHWPDV.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./notifications-C2JzekkY.js";const R={key:0,class:"flex items-center space-x-4 p-4"},G={key:1,class:"space-y-4 p-4"},J={key:2,class:"space-y-3"},K={key:3,class:"space-y-2"},Q=W({__name:"SkeletonLoader",props:{type:{default:"line"},width:{},height:{},size:{},lines:{},count:{},animated:{type:Boolean,default:!0},rounded:{type:Boolean,default:!0}},setup(r){const l=r,d={xs:"w-4 h-4",sm:"w-6 h-6",md:"w-8 h-8",lg:"w-12 h-12",xl:"w-16 h-16"},z=g(()=>{const n=["skeleton-container"];return l.animated&&n.push("animate-pulse"),n.join(" ")}),C=g(()=>l.size?d[l.size]:""),M=g(()=>l.height?typeof l.height=="number"?`h-${l.height}`:l.height.startsWith("h-")?l.height:`h-[${l.height}]`:"h-4"),U=g(()=>l.width?typeof l.width=="number"?`w-${l.width}`:l.width.startsWith("w-")?l.width:`w-[${l.width}]`:"w-full"),T=(n,t)=>{const e=["w-full","w-5/6","w-4/5","w-3/4","w-2/3"];return n===t?e[Math.min(n+1,e.length-1)]:e[n%e.length]||"w-full"};return(n,t)=>(s(),a("div",{class:k(["skeleton-loader",z.value])},[n.type==="user-card"?(s(),a("div",R,t[0]||(t[0]=[i("div",{class:"skeleton-circle w-10 h-10"},null,-1),i("div",{class:"flex-1 space-y-2"},[i("div",{class:"skeleton-line h-4 w-3/4"}),i("div",{class:"skeleton-line h-3 w-1/2"})],-1)]))):n.type==="dream-card"?(s(),a("div",G,t[1]||(t[1]=[V('<div class="flex justify-between items-center" data-v-2d56e570><div class="skeleton-line h-4 w-1/4" data-v-2d56e570></div><div class="skeleton-line h-3 w-16" data-v-2d56e570></div></div><div class="space-y-2" data-v-2d56e570><div class="skeleton-line h-3 w-full" data-v-2d56e570></div><div class="skeleton-line h-3 w-5/6" data-v-2d56e570></div><div class="skeleton-line h-3 w-4/5" data-v-2d56e570></div></div><div class="skeleton-line h-6 w-1/3" data-v-2d56e570></div>',3)]))):n.type==="history-list"?(s(),a("div",J,[(s(!0),a(x,null,P(n.count||3,e=>(s(),a("div",{key:e,class:"border rounded-lg p-3"},t[2]||(t[2]=[V('<div class="flex justify-between items-center mb-2" data-v-2d56e570><div class="skeleton-line h-4 w-24" data-v-2d56e570></div><div class="skeleton-line h-3 w-8" data-v-2d56e570></div></div><div class="skeleton-line h-3 w-full" data-v-2d56e570></div><div class="skeleton-line h-3 w-3/4 mt-1" data-v-2d56e570></div>',3)])))),128))])):n.type==="text-block"?(s(),a("div",K,[(s(!0),a(x,null,P(n.lines||3,e=>(s(),a("div",{key:e,class:k(["skeleton-line h-4",T(e,n.lines||3)])},null,2))),128))])):n.type==="custom"?q(n.$slots,"default",{key:4},void 0,!0):(s(),a(x,{key:5},[n.type==="circle"?(s(),a("div",{key:0,class:k(["skeleton-circle",C.value])},null,2)):n.type==="square"?(s(),a("div",{key:1,class:k(["skeleton-square",C.value])},null,2)):(s(),a("div",{key:2,class:k(["skeleton-line",[M.value,U.value]])},null,2))],64))],2))}}),_=H(Q,[["__scopeId","data-v-2d56e570"]]),X={class:"relative"},Y=["src"],Z={class:"ml-4 truncate"},ee={key:0,class:"mb-4 flex gap-2 flex-wrap"},te={key:1,class:"flex flex-col gap-2 ml-auto"},se={key:0,class:"mb-4 flex gap-2 flex-wrap"},ie={key:1,class:"flex flex-col gap-2 ml-auto"},ae={key:2,class:"space-y-2 text-sm"},le={class:"flex justify-between"},ne={class:"flex justify-between"},oe={class:"flex justify-between"},re={class:"flex justify-between"},de={key:0,class:"absolute bottom-4 left-4 right-4 space-y-2"},ue=["disabled"],ce=W({__name:"UserInfoCard",props:["userStore"],setup(r){const l=r,d=I(!1),z=g(()=>{var e,u,c;const t=(e=window.Telegram)==null?void 0:e.WebApp;return(c=(u=t==null?void 0:t.initDataUnsafe)==null?void 0:u.user)!=null&&c.photo_url?t.initDataUnsafe.user.photo_url:"https://via.placeholder.com/40/5461FF/ffffff?text=U"}),C=g(()=>{var e,u;const t=(e=window.Telegram)==null?void 0:e.WebApp;if((u=t==null?void 0:t.initDataUnsafe)!=null&&u.user){const c=t.initDataUnsafe.user;return c.first_name+(c.last_name?` ${c.last_name}`:"")}return"Пользователь"}),M=()=>{d.value=!d.value,window.triggerHaptic&&window.triggerHaptic("light")},U=g(()=>{var e,u,c,m;const t=((u=(e=l.userStore)==null?void 0:e.profile)==null?void 0:u.subscription_type)||"Free";if((m=(c=l.userStore)==null?void 0:c.profile)!=null&&m.subscription_end){const b=new Date(l.userStore.profile.subscription_end).toLocaleDateString("ru-RU",{day:"2-digit",month:"2-digit"});return`${t} до ${b}`}return t}),T=g(()=>{var b;const t=(b=l.userStore)==null?void 0:b.history;if(!t||t.length===0)return"недавно";const e=t.reduce((o,S)=>{const L=new Date(S.created_at),j=new Date(o.created_at);return L<j?S:o}),u=new Date(e.created_at),m=Math.abs(new Date-u),f=Math.ceil(m/(1e3*60*60*24));if(f<7)return`${f} дн${f===1?"ень":f<5?"я":"ей"}`;if(f<30){const o=Math.floor(f/7);return`${o} недел${o===1?"ю":o<5?"и":"ь"}`}else if(f<365){const o=Math.floor(f/30);return`${o} месяц${o===1?"":o<5?"а":"ев"}`}else{const o=Math.floor(f/365);return`${o} год${o===1?"":o<5?"а":"ов"}`}}),n=()=>{var t;window.triggerHaptic&&window.triggerHaptic("medium"),(t=l.userStore)==null||t.openSubscriptionModal()};return(t,e)=>{var u,c,m,f,b,o,S,L,j,A;return s(),a("article",{class:k(["relative rounded-xl bg-gradient-to-br from-[#5461FF] to-[#4857FF] text-white overflow-hidden transition-all",[d.value?"pb-32":"h-[11.55vh] md:h-[10.5rem]"]]),onClick:M},[(u=r.userStore)!=null&&u.isLoadingProfile&&!d.value?(s(),B(N,{key:0,overlay:"",variant:"white",size:"sm",label:"Загрузка профиля..."})):p("",!0),i("div",{class:k(["px-8 md:px-16",[d.value?"pt-8":"flex items-center h-full"]])},[i("div",{class:k(["flex items-center",[d.value?"mb-4":"flex-1"]])},[i("div",X,[i("img",{class:"w-10 h-10 rounded-full object-cover",src:z.value},null,8,Y),(c=r.userStore)!=null&&c.isLoadingProfile?(s(),B(N,{key:0,class:"absolute inset-0",size:"sm",variant:"white"})):p("",!0)]),i("span",Z,y(C.value),1)],2),(m=r.userStore)!=null&&m.isLoadingProfile?(s(),a(x,{key:0},[d.value?(s(),a("div",ee,[w(_,{type:"line",width:"w-20",height:"h-6"}),w(_,{type:"line",width:"w-24",height:"h-6"})])):p("",!0),d.value?p("",!0):(s(),a("div",te,[w(_,{type:"line",width:"w-16",height:"h-5"}),w(_,{type:"line",width:"w-12",height:"h-5"})]))],64)):(s(),a(x,{key:1},[d.value?(s(),a("div",se,[w(F,{class:"whitespace-nowrap"},{default:$(()=>{var h,v;return[D(y(`Токенов: ${((v=(h=r.userStore)==null?void 0:h.profile)==null?void 0:v.tokens)||0}`),1)]}),_:1}),w(F,{class:"whitespace-nowrap"},{default:$(()=>[D(y(U.value),1)]),_:1})])):p("",!0),d.value?p("",!0):(s(),a("div",ie,[w(F,{class:"whitespace-nowrap"},{default:$(()=>{var h,v;return[D(y(`Токенов: ${((v=(h=r.userStore)==null?void 0:h.profile)==null?void 0:v.tokens)||0}`),1)]}),_:1}),w(F,{class:"whitespace-nowrap"},{default:$(()=>{var h,v;return[D(y(((v=(h=r.userStore)==null?void 0:h.profile)==null?void 0:v.subscription_type)||"Free"),1)]}),_:1})]))],64)),d.value?(s(),a("div",ae,[(f=r.userStore)!=null&&f.isLoadingProfile?(s(),a(x,{key:0},P(4,h=>i("div",{key:h,class:"flex justify-between"},[w(_,{type:"line",width:"w-24",height:"h-4"}),w(_,{type:"line",width:"w-8",height:"h-4"})])),64)):(s(),a(x,{key:1},[i("div",le,[e[0]||(e[0]=i("span",{class:"opacity-80"},"Пользователь уже:",-1)),i("span",null,y(T.value),1)]),i("div",ne,[e[1]||(e[1]=i("span",{class:"opacity-80"},"Интерпретировано снов:",-1)),i("span",null,y(((o=(b=r.userStore)==null?void 0:b.profile)==null?void 0:o.total_dreams_count)||0),1)]),i("div",oe,[e[2]||(e[2]=i("span",{class:"opacity-80"},"Глубоких анализов:",-1)),i("span",null,y(((L=(S=r.userStore)==null?void 0:S.profile)==null?void 0:L.deep_analyses_count)||0),1)]),i("div",re,[e[3]||(e[3]=i("span",{class:"opacity-80"},"Приглашено друзей:",-1)),i("span",null,y(((A=(j=r.userStore)==null?void 0:j.profile)==null?void 0:A.invited_friends_count)||0),1)])],64))])):p("",!0)],2),w(O,{name:"fade"},{default:$(()=>{var h,v;return[d.value?(s(),a("div",de,[i("button",{class:"w-full bg-white/20 hover:bg-white/30 text-white rounded-xl py-3 font-semibold transition-colors flex items-center justify-center",onClick:E(n,["stop"]),disabled:(h=r.userStore)==null?void 0:h.isLoadingProfile},[(v=r.userStore)!=null&&v.isLoadingProfile?(s(),B(N,{key:0,size:"xs",variant:"white",class:"mr-2"})):p("",!0),e[4]||(e[4]=D(" Сменить тариф ",-1))],8,ue),e[5]||(e[5]=i("button",{class:"w-full bg-white/10 text-white/60 rounded-xl py-3 font-semibold cursor-not-allowed",disabled:""}," Получить токены ",-1))])):p("",!0)]}),_:1})],2)}}}),ye=H(ce,[["__scopeId","data-v-b4037f04"]]);export{ye as default};
