import{m as h,r as P,h as C,Q as S,y as x,a as l,o as c,b as i,q as e,n as f,F as M,A as k,t as r,l as y}from"./main-DNZdXXg4.js";import{_ as g}from"./_plugin-vue_export-helper-DlAUqK2U.js";const w={class:"modal-container"},D={class:"modal-content"},V={class:"tabs"},$={class:"duration-options"},A=["value","checked","disabled","onChange"],F={class:"months"},I={key:0,class:"price"},E={key:1,class:"price-disabled"},N={class:"features-list"},T={__name:"SubscriptionModal",emits:["close"],setup(U,{emit:_}){var B;const s=h(),{getPlanDetails:u}=s,t=(B=window.Telegram)==null?void 0:B.WebApp,v=_,m=P(!1);C(()=>{m.value=!0,console.log("[SubscriptionModal] Component mounted"),t!=null&&t.BackButton&&(t.BackButton.show(),t.BackButton.onClick(p))});const p=()=>{v("close")},d=()=>{var a;console.log("[SubscriptionModal] Main Button clicked!"),(a=t==null?void 0:t.MainButton)!=null&&a.isActive?s.initiatePayment():console.warn("[SubscriptionModal] Main Button clicked but it was inactive.")};return S(()=>{var o;if(!t||!m.value){(o=t==null?void 0:t.MainButton)!=null&&o.isVisible&&(console.log("[SubscriptionModal] Hiding Main Button (not mounted or no tg)"),t.MainButton.hide(),t.MainButton.offClick(d));return}const a=s.selectedInvoiceAmount;a?(console.log(`[SubscriptionModal] Setting Main Button: Pay ${a} Stars`),t.MainButton.setParams({text:`Оплатить ${a} ⭐`,color:t.themeParams.button_color||"#2481CC",text_color:t.themeParams.button_text_color||"#ffffff",is_active:!0,is_visible:!0}),t.MainButton.offClick(d),t.MainButton.onClick(d)):(console.log("[SubscriptionModal] Setting Main Button: Inactive (no amount)"),t.MainButton.setParams({text:"Выберите план",is_active:!1,is_visible:!0}),t.MainButton.offClick(d))}),x(()=>{var a,o;(a=t==null?void 0:t.MainButton)!=null&&a.isVisible&&(t.MainButton.hide(),t.MainButton.offClick(d),console.log("[SubscriptionModal] Main Button hidden on modal unmount.")),(o=t==null?void 0:t.BackButton)!=null&&o.isVisible&&(t.BackButton.hide(),t.BackButton.offClick(p),console.log("[SubscriptionModal] Back Button hidden on modal unmount.")),m.value=!1}),(a,o)=>(c(),l("div",w,[i("div",D,[o[4]||(o[4]=i("h2",{class:"text-[32px] font-bold mb-6 text-center"},"Выберите план подписки",-1)),i("div",V,[i("button",{class:f({active:e(s).selectedPlan==="basic"}),onClick:o[0]||(o[0]=n=>e(s).selectPlan("basic"))}," Basic ",2),i("button",{class:f({active:e(s).selectedPlan==="premium"}),onClick:o[1]||(o[1]=n=>e(s).selectPlan("premium"))}," Premium ",2)]),i("div",$,[(c(),l(M,null,k([1,3,12],n=>i("label",{key:n,class:"duration-label"},[i("input",{type:"radio",name:"duration",value:n,checked:e(s).selectedDuration===n,disabled:!e(u)(e(s).selectedPlan,n).price,onChange:b=>e(s).selectDuration(n)},null,40,A),i("div",{class:f(["duration-card",{disabled:!e(u)(e(s).selectedPlan,n).price}])},[i("span",F,r(n)+" "+r((n>1&&n<5,"мес")),1),e(u)(e(s).selectedPlan,n).price?(c(),l("span",I,r((e(u)(e(s).selectedPlan,n).price/n).toFixed(0))+"⭐/мес ",1)):(c(),l("span",E,"—"))],2)])),64))]),i("div",N,[o[3]||(o[3]=i("h3",{class:"text-2xl font-bold mb-4"},"Что вы получаете:",-1)),i("ul",null,[(c(!0),l(M,null,k(e(u)(e(s).selectedPlan,e(s).selectedDuration).features,(n,b)=>(c(),l("li",{key:b},[o[2]||(o[2]=i("span",{class:"checkmark"},"✔️",-1)),y(" "+r(n),1)]))),128))])])])]))}},H=g(T,[["__scopeId","data-v-dc5c979a"]]);export{H as default};
